import{a as G,j as e,c as Ee,B as A,n as De,o as Q,p as me,q as le,r as xe,T as In,t as Wn,v as Un,w as On,x as ie,L as U,I as $,y as ae,A as Le,z as Pe,E as tn,F as hr,G as Ze,H as Qe,J as he,K as ee,M as en,N as Z,O as ni,Q as Ge,R as ri,D as qe,d as Ke,e as Ye,f as Je,S as an,U as yr,V as ii,W as ur,X as yi,Y as wi,Z as ki,_ as Ti,$ as Nn,a0 as gn,a1 as hn,a2 as bn,a3 as xn,a4 as _i,a5 as Mn,h as Ce,a6 as Ai,a7 as Fi,a8 as Ri,a9 as Mi,aa as Ir,ab as Qn,ac as er,ad as on,ae as sn,af as Li,ag as wr,ah as Pi,ai as Ci,g as Ii,aj as Xe,ak as Wi,al as Ui,am as Oi,an as $i,ao as Bi,ap as Xi,C as Wr,aq as kr,ar as An,as as $n,at as vn,au as Hi,av as Gi,aw as zi,ax as qi,ay as Ki,az as Yi,aA as Ji,aB as Zi,aC as Qi,aD as et,aE as nt,aF as rt,aG as it,aH as tt,aI as at,aJ as ot,aK as Fn,aL as st,aM as mt,aN as lt,aO as dt,aP as Bn,u as ut}from"./index-DmWoIqkz.js";import{u as ti,i as ct,r as t,R as pn,k as Tr,N as Ur}from"./react-vendor-Dgs0PnIs.js";import{a8 as pt,e as fn,a9 as rn,a1 as nn,s as Xn,aa as ai,j as oi,k as kn,a5 as br,ab as ft,ac as xr,P as Sn,ad as Me,ae as Nt,af as gt,ag as ht,w as cn,n as nr,h as rr,C as jn,g as ir,ah as si,ai as tr,x as bt,E as xt,B as mi,y as Vn,aj as Tn,ak as _r,al as vt,am as li,an as Et,z as Dt,ao as St,q as vr,ap as jt,X as Ar,aq as Vt,ar as Er,H as di,a2 as oe,as as Dr,at as He,au as ui,av as yt,aw as wt,ax as kt,m as Ln,ay as Tt,az as _t,U as ci,aA as At,A as Ft,aB as pi,M as Rt,aC as Mt,l as Lt,aD as Pt}from"./utils-vendor-BGFQbqN_.js";import{g as Sr,s as cr,a as fi,F as Ct,C as It,u as Wt,b as Fr,B as dn,c as Ut,d as Or,e as Ot,i as $t,f as Bt,h as Xt,r as Ht,j as Gt}from"./studio-schedule-DESBi_1U.js";import{S as zt,a5 as Ni,a6 as gi,a7 as hi,a8 as qt,a9 as bi,aa as Kt}from"./ui-vendor-DDOKmtGI.js";import{k as Yt,A as Hn,c as Gn,d as zn,e as qn,f as Kn,h as Yn,i as Jn,j as En,S as jr,P as $r,a as Br,b as Xr}from"./switch-D-s5z0hd.js";import{h as Hr,E as Gr}from"./export-vendor-CIONKkl6.js";import{f as re,s as mn,P as yn,l as Dn,c as Zn}from"./date-vendor-B-iErbnr.js";import"./mui-vendor-ChyyRTJQ.js";const Jt=async()=>{try{const n="producers-list",i=localStorage.getItem(n);if(i)try{const m=JSON.parse(i),s=m.timestamp||0;if(Date.now()-s<300*1e3)return m.data||[]}catch(m){console.error("Error parsing producers cache:",m)}const{data:r,error:a}=await G.query("/workers",{order:{name:"asc"}});if(a)throw a;return localStorage.setItem(n,JSON.stringify({data:r,timestamp:Date.now()})),r}catch(n){throw console.error("Error fetching producers:",n),n}},Zt=Jt,Qt=async n=>{try{const i=re(n,"yyyy-MM-dd"),{data:r,error:a}=await G.query("/producer-work-arrangements",{where:{week_start:i},single:!0});if(a){const{data:m,error:s}=await G.mutate("/producer-work-arrangements",{week_start:i},"POST");if(s)throw s;return m}return r}catch(i){throw console.error("Error with producer work arrangement:",i),i}},ea=async(n,i)=>{try{const{error:r}=await G.mutate(`/producer-work-arrangements/${n}`,{notes:i},"PUT");if(r)throw r;return!0}catch(r){throw console.error("Error updating arrangement notes:",r),r}};function na({children:n,className:i}){return e.jsxDEV("h1",{className:Ee("scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl",i),children:n},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/typography.tsx",lineNumber:12,columnNumber:5},this)}const ra=()=>{const n=ti(),i=ct();return new URLSearchParams(i.search).get("tab"),e.jsxDEV("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV(na,{children:"הגדרות מערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:28,columnNumber:9},void 0),e.jsxDEV("p",{className:"text-gray-500",children:"נהל את הגדרות המערכת שלך"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:29,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:27,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex gap-2",children:e.jsxDEV(A,{variant:"outline",onClick:()=>n("/dashboard"),children:[e.jsxDEV(pt,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:34,columnNumber:11},void 0),"לוח בקרה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:33,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:32,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/AdminHeader.tsx",lineNumber:26,columnNumber:5},void 0)},ia=({timezoneOffset:n,setTimezoneOffset:i,serverTime:r})=>{const{toast:a}=De(),[m,s]=t.useState(!1),[o,h]=t.useState(new Date);t.useEffect(()=>{const v=setInterval(()=>{h(new Date)},5e3);return()=>clearInterval(v)},[]);const d=async()=>{try{s(!0);const{data:v,error:N}=await ae.from("system-settings").select("id").eq("key","timezone_offset").single();if(N&&N.code!=="PGRST116")throw N;let x;if(v){const{error:E}=await ae.from("system-settings").update({value:n.toString()}).eq("key","timezone_offset");x=E}else{const{error:E}=await ae.from("system-settings").insert({key:"timezone_offset",value:n.toString()});x=E}if(x)throw x;a({title:"הגדרות אזור זמן נשמרו בהצלחה",variant:"default"})}catch(v){console.error("Error saving timezone offset:",v),a({title:"שגיאה בשמירת הגדרות אזור זמן",description:v.message,variant:"destructive"})}finally{s(!1)}},j=v=>{if(!v)return"";const N=new Date(v.getTime());return N.setHours(N.getHours()+n),N.toLocaleTimeString("he-IL")},b=v=>{if(!v)return"";const N=new Date(v.getTime()),E=(N.getUTCHours()+3)%24;return N.setHours(E),N.toLocaleTimeString("he-IL")};return e.jsxDEV(Q,{className:"mb-8",children:[e.jsxDEV(me,{className:"pb-2 text-right",children:[e.jsxDEV(le,{className:"text-xl flex items-center gap-2 justify-end",children:[e.jsxDEV(fn,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:111,columnNumber:11},void 0),"הגדרות זמן מערכת"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:110,columnNumber:9},void 0),e.jsxDEV(xe,{className:"text-right flex items-center justify-end gap-2",children:["כוונון אזור זמן לשליחת הודעות דואר אלקטרוני",e.jsxDEV(In,{children:e.jsxDEV(Wn,{children:[e.jsxDEV(Un,{asChild:!0,children:e.jsxDEV(rn,{className:"h-4 w-4 cursor-help"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:119,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:118,columnNumber:15},void 0),e.jsxDEV(On,{align:"end",className:"max-w-sm",children:e.jsxDEV("p",{className:"text-sm text-right",children:"הגדרה זו משפיעה על זמן שליחת המיילים האוטומטיים. שינוי ערך ההיסט משנה את הזמן בו נשלחים המיילים ביחס לזמן התוכנית בלוח."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:122,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:121,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:117,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:116,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:114,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:109,columnNumber:7},void 0),e.jsxDEV(ie,{children:[e.jsxDEV("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxDEV("div",{className:"space-y-2 flex-1 text-right",children:[e.jsxDEV(U,{htmlFor:"server-time-utc",className:"block text-right",children:"זמן שרת (UTC):"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:133,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-lg font-medium text-right",id:"server-time-utc",children:r?r.toISOString():"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:134,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:132,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-2 flex-1 text-right",children:[e.jsxDEV(U,{htmlFor:"server-time",className:"block text-right",children:"זמן ישראל (UTC+3):"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:140,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-lg font-medium text-right",id:"server-time",children:r?b(r):"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:141,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:139,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-2 flex-1 text-right",children:[e.jsxDEV(U,{htmlFor:"server-time-offset",className:"block text-right",children:"זמן עם היסט:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:147,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-lg font-medium text-green-600 text-right",id:"server-time-offset",children:r?j(r):"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:148,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:146,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-2 flex-1 text-right",children:[e.jsxDEV(U,{htmlFor:"timezone-offset",className:"block text-right",children:"היסט שעות (מספר שלם):"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:154,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex gap-2 justify-end",children:[e.jsxDEV(A,{onClick:d,disabled:m,children:m?"שומר...":"שמור היסט"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:156,columnNumber:15},void 0),e.jsxDEV($,{id:"timezone-offset",type:"number",value:n,onChange:v=>i(parseInt(v.target.value)||0),className:"w-24 text-right"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:159,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:155,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:153,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:131,columnNumber:9},void 0),e.jsxDEV("div",{className:"mt-4 p-3 bg-yellow-50 rounded-md text-right",children:e.jsxDEV("p",{className:"text-sm text-amber-800",children:[e.jsxDEV("strong",{children:"שים לב:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:172,columnNumber:13},void 0)," מיילים אוטומטיים נשלחים בהתבסס על זמני השידור בלוח עם היסט הזמן. אם המיילים יוצאים מוקדם/מאוחר מדי, התאם את ערך ההיסט בהתאם."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:171,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:170,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:130,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TimezoneSettings.tsx",lineNumber:108,columnNumber:5},void 0)},ta=()=>{const[n,i]=t.useState(null),[r,a]=t.useState(!0),[m,s]=t.useState(!1),[o,h]=t.useState(null),{toast:d}=De();t.useEffect(()=>{(async()=>{try{const{data:N,error:x}=await ae.from("system_settings").select("value").eq("key","app_domain").single();x?(x.code!=="PGRST116"&&console.error("Error fetching domain setting:",x),i("")):i(N?N.value:"")}catch(N){console.error("Error:",N),i("")}finally{a(!1)}})()},[]);const j=v=>{h(null);const N=v.trim();if(!N)return!1;const x=N.replace(/^(https?:\/\/)/,"").replace(/\/$/,"");return/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}(:\d+)?$/.test(x)?!0:(h("אנא הזן דומיין תקין (לדוגמה: myapp.example.com או myapp.example.com:8080)"),!1)},b=async()=>{if(n){if(!j(n)){o||h("נא להזין דומיין תקין");return}s(!0);try{let v=n.trim();v=v.replace(/^(https?:\/\/)/,""),v=v.replace(/\/$/,"");const{error:N}=await ae.from("system_settings").upsert({key:"app_domain",value:v},{onConflict:"key"});if(N)throw N;d({title:"הדומיין נשמר בהצלחה",description:`הדומיין עודכן ל- ${v}`}),i(v)}catch(v){console.error("Error saving domain:",v),d({title:"שגיאה בשמירת הדומיין",description:v.message||"אירעה שגיאה בשמירת הדומיין",variant:"destructive"})}finally{s(!1)}}};return r||n===null?e.jsxDEV(Q,{className:"w-full",dir:"rtl",children:e.jsxDEV(ie,{className:"py-6",children:e.jsxDEV("div",{className:"flex items-center justify-center",children:e.jsxDEV(nn,{className:"h-6 w-6 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:130,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:129,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:128,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:127,columnNumber:7},void 0):e.jsxDEV(Q,{className:"w-full",dir:"rtl",children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"הגדרות דומיין"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:140,columnNumber:9},void 0),e.jsxDEV(xe,{children:"הגדר את הדומיין הקבוע של האפליקציה. דומיין זה ישמש ליצירת קישורים בכל רחבי האפליקציה, כולל קישורי אימות אימייל ולינקים בליינאפים."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:141,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:139,columnNumber:7},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-4",children:e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"domain",children:"דומיין האפליקציה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:148,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:e.jsxDEV($,{id:"domain",placeholder:"l.103.fm:8080",value:n,onChange:v=>{i(v.target.value),o&&h(null)},className:"flex-1 ml-2",disabled:m,dir:"ltr"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:150,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:149,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"הזן את הדומיין ללא פרוטוקול (http:// או https://). ניתן להוסיף פורט (לדוגמה: l.103.fm:8080)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:166,columnNumber:11},void 0),o&&e.jsxDEV(Le,{variant:"destructive",className:"mt-2",children:[e.jsxDEV(Xn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:172,columnNumber:17},void 0),e.jsxDEV(Pe,{children:o},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:173,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:171,columnNumber:15},void 0),e.jsxDEV(Le,{className:"mt-4",children:e.jsxDEV(Pe,{children:[e.jsxDEV("p",{className:"font-medium",children:"הגדרת דומיין מותאם אישית:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:181,columnNumber:17},void 0),e.jsxDEV("ol",{className:"list-decimal list-inside space-y-1 mt-2",children:[e.jsxDEV("li",{children:"הפנה את הדומיין שלך ל-IP של השרת הנוכחי או לשם המארח שלנו"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:183,columnNumber:19},void 0),e.jsxDEV("li",{children:"אם אתה משתמש ב-Cloudflare, ודא שאתה מגדיר DNS only (Proxy status: DNS only, ענן אפור)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:184,columnNumber:19},void 0),e.jsxDEV("li",{children:'אם אתה מקבל שגיאת "DNS points to prohibited IP", בדוק שאתה לא מפנה לכתובת IP פרטית'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:185,columnNumber:19},void 0),e.jsxDEV("li",{children:"הפנה את הדומיין לא ישירות לכתובת IP אלא לשם המארח של השרת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:186,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:182,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:180,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:179,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:147,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:146,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:145,columnNumber:7},void 0),e.jsxDEV(tn,{className:"flex justify-start",children:e.jsxDEV(A,{onClick:b,disabled:m||!n||!!o,children:m?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(nn,{className:"ml-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:200,columnNumber:15},void 0),"שומר..."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:199,columnNumber:13},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(ai,{className:"ml-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:205,columnNumber:15},void 0),"שמור דומיין"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:204,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:194,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:193,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DomainSettings.tsx",lineNumber:138,columnNumber:5},void 0)},aa=({workers:n,loading:i,error:r,onEdit:a,onDelete:m})=>{const[s,o]=t.useState({}),[h,d]=t.useState(!1),j=t.useMemo(()=>hr,[]),b=v=>j[v.toLowerCase()]||j[v]||v;return t.useEffect(()=>{(async()=>{if(n&&n.length>0){const N={},x="all-worker-divisions",E=sessionStorage.getItem(x);let S=!0;if(E)try{const g=JSON.parse(E),u=g.timestamp||0;Date.now()-u<3e5&&(o(g.divisions||{}),d(!0),S=!1)}catch(g){console.error("Error parsing worker divisions cache:",g)}if(S){for(const g of n)try{const u=await ni(g.id);N[g.id]=u}catch(u){console.error(`Error loading divisions for worker ${g.id}:`,u),N[g.id]=[]}sessionStorage.setItem(x,JSON.stringify({divisions:N,timestamp:Date.now()})),o(N),d(!0)}}})()},[n]),i?e.jsxDEV("div",{className:"text-center py-4",children:"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:96,columnNumber:12},void 0):r?e.jsxDEV("div",{className:"text-center py-4 text-red-500",children:["שגיאה בטעינת הנתונים: ",r.message]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:99,columnNumber:12},void 0):!n||n.length===0?e.jsxDEV("div",{className:"text-center py-4",children:"לא נמצאו עובדים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:104,columnNumber:12},void 0):Array.isArray(n)?e.jsxDEV("div",{className:"w-full overflow-auto",children:e.jsxDEV(Ze,{dir:"rtl",children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{className:"text-right",children:"שם"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:117,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"מחלקה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:118,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"תפקיד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:119,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"אימייל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:120,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"טלפון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:121,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"פעולות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:122,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:116,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:115,columnNumber:9},void 0),e.jsxDEV(en,{children:n.map(v=>{const x=(s[v.id]||[]).map(E=>b(E.name)).join(", ");return e.jsxDEV(he,{children:[e.jsxDEV(Z,{className:"font-medium text-right",children:v.name},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:132,columnNumber:17},void 0),e.jsxDEV(Z,{className:"text-right",children:x||v.department||"-"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:135,columnNumber:17},void 0),e.jsxDEV(Z,{className:"text-right",children:v.position},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:136,columnNumber:17},void 0),e.jsxDEV(Z,{className:"text-right",children:v.email},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:137,columnNumber:17},void 0),e.jsxDEV(Z,{className:"text-right",children:v.phone},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:138,columnNumber:17},void 0),e.jsxDEV(Z,{children:e.jsxDEV("div",{className:"flex gap-2 justify-start",children:[e.jsxDEV(A,{variant:"outline",size:"sm",onClick:()=>a(v),children:[e.jsxDEV(oi,{className:"h-4 w-4 mr-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:142,columnNumber:23},void 0),"עריכה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:141,columnNumber:21},void 0),e.jsxDEV(A,{variant:"outline",size:"sm",onClick:()=>m(v.id),className:"text-red-500 hover:text-red-700",children:[e.jsxDEV(kn,{className:"h-4 w-4 mr-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:146,columnNumber:23},void 0),"מחיקה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:145,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:140,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:139,columnNumber:17},void 0)]},v.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:131,columnNumber:15},void 0)})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:125,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:114,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:113,columnNumber:5},void 0):(console.error("Workers is not an array:",n),e.jsxDEV("div",{className:"text-center py-4 text-red-500",children:"שגיאה: נתוני העובדים אינם תקינים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerTable.tsx",lineNumber:109,columnNumber:12},void 0))},oa=pn.memo(aa),sa=({formData:n,onChange:i,onDivisionsChange:r,selectedDivisions:a=[],onCreateUserAccount:m,onResetPassword:s,isCreatingUser:o=!1,isResettingPassword:h=!1})=>{const[d,j]=t.useState([]),[b,v]=t.useState(!0),[N,x]=t.useState(n.email||""),E=V=>hr[V.toLowerCase()]||hr[V]||V,S=t.useMemo(()=>{const V={};return d.forEach(T=>{V[T.id]=E(T.name)}),V},[d]);t.useEffect(()=>{(async()=>{try{v(!0);const T=localStorage.getItem("divisions-cache");let l=[];if(T)try{const c=JSON.parse(T),k=c.timestamp||0;Date.now()-k<6e5&&(l=c.data||[])}catch(c){console.error("Error parsing divisions cache:",c)}l.length===0&&(l=await ri(),localStorage.setItem("divisions-cache",JSON.stringify({data:l,timestamp:Date.now()}))),j(l)}catch(T){console.error("Error loading divisions:",T)}finally{v(!1)}})()},[]);const g=(V,T)=>{r&&r(T?[...a,V]:a.filter(l=>l!==V))},u=async()=>{m&&N&&await m(N)},R=async()=>{s&&await s()};return e.jsxDEV("div",{className:"grid gap-4 py-4",children:[e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{htmlFor:"name",className:"text-right",children:"שם"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:131,columnNumber:9},void 0),e.jsxDEV($,{id:"name",name:"name",value:n.name||"",onChange:i,className:"col-span-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:132,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:130,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-start gap-4",children:[e.jsxDEV(U,{className:"text-right pt-2",children:"מחלקות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:142,columnNumber:9},void 0),e.jsxDEV("div",{className:"col-span-3 space-y-2",children:b?e.jsxDEV("p",{className:"text-sm text-gray-500",children:"טוען מחלקות..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:145,columnNumber:13},void 0):d.length===0?e.jsxDEV("p",{className:"text-sm text-gray-500",children:"אין מחלקות זמינות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:147,columnNumber:13},void 0):e.jsxDEV("div",{className:"grid grid-cols-1 gap-2",children:d.map(V=>e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(Ge,{id:`division-${V.id}`,checked:a.includes(V.id),onCheckedChange:T=>g(V.id,T===!0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:152,columnNumber:19},void 0),e.jsxDEV(U,{htmlFor:`division-${V.id}`,className:"mr-2 text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:S[V.id]||E(V.name)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:159,columnNumber:19},void 0)]},V.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:151,columnNumber:17},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:149,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:143,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:141,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{htmlFor:"position",className:"text-right",children:"תפקיד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:173,columnNumber:9},void 0),e.jsxDEV($,{id:"position",name:"position",value:n.position||"",onChange:i,className:"col-span-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:174,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:172,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{htmlFor:"email",className:"text-right",children:"אימייל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:184,columnNumber:9},void 0),e.jsxDEV($,{id:"email",name:"email",value:n.email||"",onChange:i,className:"col-span-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:185,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:183,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{htmlFor:"phone",className:"text-right",children:"טלפון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:195,columnNumber:9},void 0),e.jsxDEV($,{id:"phone",name:"phone",value:n.phone||"",onChange:i,className:"col-span-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:196,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:194,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{htmlFor:"photo_url",className:"text-right",children:"תמונה (URL)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:206,columnNumber:9},void 0),e.jsxDEV($,{id:"photo_url",name:"photo_url",value:n.photo_url||"",onChange:i,className:"col-span-3",placeholder:"https://example.com/photo.jpg"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:207,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:205,columnNumber:7},void 0),e.jsxDEV(Q,{className:"mt-6",children:[e.jsxDEV(me,{children:e.jsxDEV(le,{className:"text-lg",children:"חשבון משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:220,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:219,columnNumber:9},void 0),e.jsxDEV(ie,{children:n.user_id?e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(Le,{children:[e.jsxDEV(ft,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:262,columnNumber:17},void 0),e.jsxDEV(Pe,{children:"לעובד זה יש חשבון משתמש פעיל במערכת."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:263,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:261,columnNumber:15},void 0),e.jsxDEV(A,{onClick:R,disabled:h,variant:"outline",className:"w-full",children:h?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(xr,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:276,columnNumber:21},void 0),"מאפס סיסמה..."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:275,columnNumber:19},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(xr,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:281,columnNumber:21},void 0),"איפוס סיסמה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:280,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:268,columnNumber:15},void 0),e.jsxDEV(Le,{children:[e.jsxDEV(rn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:288,columnNumber:17},void 0),e.jsxDEV(Pe,{children:"הסיסמה הזמנית תוצג רק פעם אחת בעת יצירת החשבון או איפוס הסיסמה."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:289,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:287,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:260,columnNumber:13},void 0):e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{htmlFor:"user_email",className:"text-right",children:"אימייל למשתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:226,columnNumber:17},void 0),e.jsxDEV($,{id:"user_email",type:"email",value:N,onChange:V=>x(V.target.value),className:"col-span-3",placeholder:"הזן כתובת אימייל עבור המשתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:227,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:225,columnNumber:15},void 0),e.jsxDEV(A,{onClick:u,disabled:o||!N,className:"w-full",children:o?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(br,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:244,columnNumber:21},void 0),"יוצר חשבון..."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:243,columnNumber:19},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(br,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:249,columnNumber:21},void 0),"יצירת חשבון משתמש"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:248,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:237,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500 text-center",children:"יצירת חשבון תשלח לכתובת האימייל הזו סיסמה זמנית."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:255,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:224,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:222,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:218,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerForm.tsx",lineNumber:129,columnNumber:5},void 0)},ma=pn.memo(sa),la=({open:n,onOpenChange:i,editingWorker:r,formData:a,onFormChange:m,onSubmit:s,onCreateUserAccount:o,onResetPassword:h,isCreatingUser:d=!1,isResettingPassword:j=!1,dialogTitle:b,submitLabel:v})=>{const[N,x]=t.useState([]),[E,S]=t.useState(!1),g=r?.id,u=t.useCallback(async()=>{if(g)try{S(!0);const T=`worker-divisions-${g}`,l=sessionStorage.getItem(T);if(l)try{const f=JSON.parse(l),F=f.timestamp||0;if(Date.now()-F<300*1e3){x(f.divisions||[]),S(!1);return}}catch(f){console.error("Error parsing worker divisions cache:",f)}const k=(await ni(g)).map(f=>f.id);sessionStorage.setItem(T,JSON.stringify({divisions:k,timestamp:Date.now()})),x(k)}catch(T){console.error("Error loading worker divisions:",T)}finally{S(!1)}else x([])},[g]);t.useEffect(()=>{n&&u()},[n,u]);const R=()=>{document.body.style.pointerEvents==="none"&&(document.body.style.pointerEvents=""),i(!1)},V=async()=>{await s(N)};return e.jsxDEV(qe,{open:n,onOpenChange:T=>{T||(document.body.style.pointerEvents=""),i(T)},children:e.jsxDEV(Ke,{dir:"rtl",onEscapeKeyDown:R,onInteractOutside:T=>{T.preventDefault(),R()},className:"max-w-md w-full",children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{children:b},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:124,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:123,columnNumber:9},void 0),E?e.jsxDEV("div",{className:"py-4 text-center",children:"טוען נתונים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:128,columnNumber:11},void 0):e.jsxDEV(ma,{formData:a,onChange:m,onDivisionsChange:x,selectedDivisions:N,onCreateUserAccount:o,onResetPassword:h,isCreatingUser:d,isResettingPassword:j},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:130,columnNumber:19},void 0),e.jsxDEV(an,{children:e.jsxDEV(A,{variant:"default",onClick:V,children:v},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:143,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:142,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:114,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerDialog.tsx",lineNumber:105,columnNumber:5},void 0)},da=pn.memo(la),ua=()=>{const[n,i]=t.useState([]),[r,a]=t.useState(!0),[m,s]=t.useState(null),[o,h]=t.useState(!1),[d,j]=t.useState(null),[b,v]=t.useState({name:"",department:"",position:"",email:"",phone:"",photo_url:""}),{toast:N}=De(),x=async()=>{a(!0);try{const{data:f,error:F}=await G.query("/workers");if(F)throw F;console.log("API response for workers:",f),f&&Array.isArray(f.data)?i(f.data):f&&Array.isArray(f)?i(f):(console.log("No valid data returned from workers query"),i([]))}catch(f){console.error("Error loading workers:",f),s(f instanceof Error?f:new Error("Failed to load workers")),N({title:"שגיאה",description:"שגיאה בטעינת רשימת העובדים",variant:"destructive"})}finally{a(!1)}};t.useEffect(()=>{x()},[]);const E=f=>{f?(j(f),v({name:f.name,department:f.department||"",position:f.position||"",email:f.email||"",phone:f.phone||"",photo_url:f.photo_url||""})):(j(null),v({name:"",department:"",position:"",email:"",phone:"",photo_url:""})),h(!0)},S=f=>{const{name:F,value:P}=f.target;v(O=>({...O,[F]:P}))},g=async()=>{try{if(!b.name.trim()){N({title:"שגיאה",description:"יש להזין שם עובד",variant:"destructive"});return}if(d){const{data:f,error:F}=await G.mutate(`/workers/${d.id}`,b,"PUT");if(F)throw F;N({title:"עודכן בהצלחה",description:"פרטי העובד עודכנו בהצלחה"})}else{const{data:f,error:F}=await G.mutate("/workers",b,"POST");if(F)throw F;N({title:"נוסף בהצלחה",description:"העובד נוסף בהצלחה"})}h(!1),x()}catch(f){console.error("Error saving worker:",f),N({title:"שגיאה",description:"שגיאה בשמירת העובד",variant:"destructive"})}},u=async f=>{if(confirm("האם אתה בטוח שברצונך למחוק את העובד?"))try{const{error:F}=await G.mutate(`/workers/${f}`,{},"DELETE");if(F)throw F;N({title:"נמחק בהצלחה",description:"העובד נמחק בהצלחה"}),x(),d?.id===f&&(j(null),h(!1))}catch(F){console.error("Error deleting worker:",F),N({title:"שגיאה",description:"שגיאה במחיקת העובד",variant:"destructive"})}},[R,V]=t.useState(!1),[T,l]=t.useState(!1),c=async f=>{if(d)try{V(!0),console.log(`Creating user account for worker ${d.name} with email ${f}`),N({title:"יוצר חשבון משתמש...",description:`עבור ${d.name}`});const{data:F,error:P}=await G.mutate(`/workers/${d.id}/create-user`,{email:f},"POST");if(P)throw P;if(F.success)N({title:"משתמש נוצר בהצלחה",description:`סיסמה זמנית: ${F.password}`}),await x(),v(O=>({...O,user_id:F.user_id||"temp-user-id",email:f}));else{console.error("Failed to create user account:",F);let O=F.message||"שגיאה ביצירת משתמש";throw N({title:"שגיאה",description:O,variant:"destructive"}),new Error(O)}}catch(F){console.error("Error creating user account:",F),N({title:"שגיאה",description:"שגיאה ביצירת חשבון משתמש",variant:"destructive"})}finally{V(!1)}},k=async()=>{if(d)try{l(!0),console.log(`Resetting password for worker ${d.name}`),N({title:"מאפס סיסמה...",description:`עבור ${d.name}`});const{data:f,error:F}=await G.mutate(`/workers/${d.id}/reset-password`,{},"POST");if(F)throw F;if(f.success)N({title:"סיסמה אופסה",description:`סיסמה חדשה: ${f.password}`}),await x();else{console.error("Failed to reset password:",f);let P=f.message||"שגיאה באיפוס סיסמה";throw N({title:"שגיאה",description:P,variant:"destructive"}),new Error(P)}}catch(f){console.error("Error resetting password:",f),N({title:"שגיאה",description:"שגיאה באיפוס סיסמה",variant:"destructive"})}finally{l(!1)}};return e.jsxDEV("div",{className:"space-y-4",dir:"rtl",children:[e.jsxDEV(Q,{children:[e.jsxDEV(me,{className:"flex flex-row items-center justify-between",children:[e.jsxDEV(le,{children:"ניהול עובדים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:267,columnNumber:11},void 0),e.jsxDEV(A,{onClick:()=>E(),children:[e.jsxDEV(Sn,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:269,columnNumber:13},void 0),"הוספת עובד"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:268,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:266,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV(oa,{workers:n,loading:r,error:m,onEdit:E,onDelete:u},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:274,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:273,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:265,columnNumber:7},void 0),e.jsxDEV(da,{open:o,onOpenChange:h,editingWorker:d,formData:b,onFormChange:S,onSubmit:g,onCreateUserAccount:c,onResetPassword:k,isCreatingUser:R,isResettingPassword:T,dialogTitle:d?"עריכת עובד":"הוספת עובד חדש",submitLabel:d?"עדכון":"הוספה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:284,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/workers/WorkerManagement.tsx",lineNumber:264,columnNumber:5},void 0)},pr=!1,ca=()=>{const[n,i]=t.useState(!1);De();const r=yr(),a=t.useRef(null),m=t.useRef(null),[s,o]=t.useState(0),[h,d]=t.useState([]),[j,b]=t.useState(null),[v,N]=t.useState(null),x=t.useMemo(()=>new Date,[]),{slots:E,refreshSlots:S}=ii(x,!0),[g,u]=t.useState(null),[R,V]=t.useState(!1);t.useEffect(()=>{d(E)},[E]),t.useEffect(()=>{const f=async()=>{try{const P=await ur({isMasterSchedule:!0});P.length>0&&d(P)}catch(P){console.error("Error directly fetching master slots:",P)}};f();const F=setInterval(()=>{f()},5e3);return()=>clearInterval(F)},[]);const T=t.useCallback(async()=>{try{V(!0),await S();const f=await ur({isMasterSchedule:!0});d(f),o(F=>F+1),V(!1)}catch(f){console.error("Error refreshing master slots:",f),V(!1)}},[S]),l=async(f,F)=>{try{V(!0),console.log("Attempting to save master schedule slot:",f);let P;F?(console.log("Updating existing master slot"),P=await ki(F,f,!0)):(console.log("Creating new master slot"),P=await Ti(f,!0)),console.log("Master schedule slot saved successfully"),await r.invalidateQueries({queryKey:["scheduleSlots","masterSchedule",!0]}),console.log("Master schedule query cache invalidated");const O=await ur({isMasterSchedule:!0});return d(O),o(_=>_+1),i(!1),u(null),V(!1),P}catch(P){throw console.error("Error saving master schedule slot:",P),V(!1),P}},c=()=>{u(null),i(!1)},k=async()=>{V(!0),await r.invalidateQueries({queryKey:["scheduleSlots","masterSchedule",!0]}),console.log("Master schedule query cache invalidated"),await T(),V(!1)};return t.useEffect(()=>{},[h,s]),e.jsxDEV("div",{className:"space-y-4",ref:a,children:[e.jsxDEV("div",{className:"p-4 rounded-lg bg-transparent",children:[e.jsxDEV("h2",{className:"text-lg font-bold mb-2 text-right",children:"לוח שידורים ראשי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:269,columnNumber:9},void 0),e.jsxDEV("p",{className:"text-right",children:".זהו לוח השידורים הקבוע של התחנה. שינויים שנעשים כאן ישפיעו על כל השבועות העתידיים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:270,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:268,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(A,{onClick:T,variant:"outline",disabled:R,children:[e.jsxDEV(Me,{className:`h-4 w-4 mr-2 ${R?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:276,columnNumber:13},void 0)," רענן לוח"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:275,columnNumber:11},void 0),pr]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:274,columnNumber:9},void 0),e.jsxDEV(A,{onClick:()=>i(!0),className:"flex items-center gap-2",disabled:R,children:[e.jsxDEV(Sn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:290,columnNumber:11},void 0),"הוסף משבצת שידור"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:289,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:273,columnNumber:7},void 0),pr,pr,e.jsxDEV("div",{ref:m,className:"border rounded-lg",style:{minHeight:"1262px"},children:e.jsxDEV("div",{className:"relative",children:[R&&e.jsxDEV("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:e.jsxDEV("div",{className:"flex flex-col items-center",children:[e.jsxDEV(Me,{className:"h-8 w-8 animate-spin text-gray-700 mb-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:346,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-gray-700 font-medium",children:"טוען נתונים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:347,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:345,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:344,columnNumber:13},void 0),e.jsxDEV(yi,{selectedDate:x,isAdmin:!0,isMasterSchedule:!0,hideDateControls:!0,showAddButton:!1,hideHeaderDates:!0,containerHeight:"100%"},`schedule-view-${s}`,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:351,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:342,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:337,columnNumber:7},void 0),e.jsxDEV(wi,{isOpen:n,onClose:c,onSave:f=>l(f,g?.id),editingSlot:g,isMasterSchedule:!0,refetchSlots:k},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:364,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/MasterSchedule.tsx",lineNumber:267,columnNumber:5},void 0)},zr=(n,i,r)=>{if(n&&"reportValidity"in n){const a=Sr(r,i);n.setCustomValidity(a&&a.message||""),n.reportValidity()}},Vr=(n,i)=>{for(const r in i.fields){const a=i.fields[r];a&&a.ref&&"reportValidity"in a.ref?zr(a.ref,r,n):a&&a.refs&&a.refs.forEach(m=>zr(m,r,n))}},qr=(n,i)=>{i.shouldUseNativeValidation&&Vr(n,i);const r={};for(const a in n){const m=Sr(i.fields,a),s=Object.assign(n[a]||{},{ref:m&&m.ref});if(pa(i.names||Object.keys(n),a)){const o=Object.assign({},Sr(r,a));cr(o,"root",s),cr(r,a,o)}else cr(r,a,s)}return r},pa=(n,i)=>{const r=Kr(i);return n.some(a=>Kr(a).match(`^${r}\\.\\d+`))};function Kr(n){return n.replace(/\]|\[/g,"")}function Yr(n,i){try{var r=n()}catch(a){return i(a)}return r&&r.then?r.then(void 0,i):r}function fa(n,i){for(var r={};n.length;){var a=n[0],m=a.code,s=a.message,o=a.path.join(".");if(!r[o])if("unionErrors"in a){var h=a.unionErrors[0].errors[0];r[o]={message:h.message,type:h.code}}else r[o]={message:s,type:m};if("unionErrors"in a&&a.unionErrors.forEach(function(b){return b.errors.forEach(function(v){return n.push(v)})}),i){var d=r[o].types,j=d&&d[a.code];r[o]=fi(o,i,r,m,j?[].concat(j,a.message):a.message)}n.shift()}return r}function Na(n,i){for(var r={};n.length;){var a=n[0],m=a.code,s=a.message,o=a.path.join(".");if(!r[o])if(a.code==="invalid_union"&&a.errors.length>0){var h=a.errors[0][0];r[o]={message:h.message,type:h.code}}else r[o]={message:s,type:m};if(a.code==="invalid_union"&&a.errors.forEach(function(b){return b.forEach(function(v){return n.push(v)})}),i){var d=r[o].types,j=d&&d[a.code];r[o]=fi(o,i,r,m,j?[].concat(j,a.message):a.message)}n.shift()}return r}function Rr(n,i,r){if(r===void 0&&(r={}),(function(a){return"_def"in a&&typeof a._def=="object"&&"typeName"in a._def})(n))return function(a,m,s){try{return Promise.resolve(Yr(function(){return Promise.resolve(n[r.mode==="sync"?"parse":"parseAsync"](a,i)).then(function(o){return s.shouldUseNativeValidation&&Vr({},s),{errors:{},values:r.raw?Object.assign({},a):o}})},function(o){if((function(h){return Array.isArray(h?.issues)})(o))return{values:{},errors:qr(fa(o.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw o}))}catch(o){return Promise.reject(o)}};if((function(a){return"_zod"in a&&typeof a._zod=="object"})(n))return function(a,m,s){try{return Promise.resolve(Yr(function(){return Promise.resolve((r.mode==="sync"?Nt:gt)(n,a,i)).then(function(o){return s.shouldUseNativeValidation&&Vr({},s),{errors:{},values:r.raw?Object.assign({},a):o}})},function(o){if((function(h){return h instanceof ht})(o))return{values:{},errors:qr(Na(o.issues,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw o}))}catch(o){return Promise.reject(o)}};throw new Error("Invalid input: not a Zod schema")}const Mr=Ct,xi=t.createContext({}),Ae=({...n})=>e.jsxDEV(xi.Provider,{value:{name:n.name},children:e.jsxDEV(It,{...n},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:37,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:36,columnNumber:5},void 0),ar=()=>{const n=t.useContext(xi),i=t.useContext(vi),{getFieldState:r,formState:a}=Wt(),m=r(n.name,a);if(!n)throw new Error("useFormField should be used within <FormField>");const{id:s}=i;return{id:s,name:n.name,formItemId:`${s}-form-item`,formDescriptionId:`${s}-form-item-description`,formMessageId:`${s}-form-item-message`,...m}},vi=t.createContext({}),Te=t.forwardRef(({className:n,...i},r)=>{const a=t.useId();return e.jsxDEV(vi.Provider,{value:{id:a},children:e.jsxDEV("div",{ref:r,className:Ee("space-y-2",n),...i},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:81,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:80,columnNumber:5},void 0)});Te.displayName="FormItem";const Fe=t.forwardRef(({className:n,...i},r)=>{const{error:a,formItemId:m}=ar();return e.jsxDEV(U,{ref:r,className:Ee(a&&"text-destructive",n),htmlFor:m,...i},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:94,columnNumber:5},void 0)});Fe.displayName="FormLabel";const Re=t.forwardRef(({...n},i)=>{const{error:r,formItemId:a,formDescriptionId:m,formMessageId:s}=ar();return e.jsxDEV(zt,{ref:i,id:a,"aria-describedby":r?`${m} ${s}`:`${m}`,"aria-invalid":!!r,...n},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:111,columnNumber:5},void 0)});Re.displayName="FormControl";const wn=t.forwardRef(({className:n,...i},r)=>{const{formDescriptionId:a}=ar();return e.jsxDEV("p",{ref:r,id:a,className:Ee("text-sm text-muted-foreground",n),...i},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:133,columnNumber:5},void 0)});wn.displayName="FormDescription";const Ie=t.forwardRef(({className:n,children:i,...r},a)=>{const{error:m,formMessageId:s}=ar(),o=m?String(m?.message):i;return o?e.jsxDEV("p",{ref:a,id:s,className:Ee("text-sm font-medium text-destructive",n),...r,children:o},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/form.tsx",lineNumber:155,columnNumber:5},void 0):null});Ie.displayName="FormMessage";const Jr=({value:n,onChange:i,additionalText:r="",placeholder:a="בחר עובד...",className:m,department:s})=>{const[o,h]=t.useState(r||""),[d,j]=t.useState([]),[b,v]=t.useState(!1),[N,x]=t.useState(null),[E,S]=t.useState(""),[g,u]=t.useState(0),[R,V]=t.useState(!1),{toast:T}=De(),l=Array.isArray(d)?d.find(y=>y.id===n):null,c=l?l.name:"";t.useEffect(()=>{const y=async()=>{v(!0),x(null);try{let L;s?s==="מפיקים"||s==="producers"?L=(await G.query("/workers",{where:{or:[{"department ILIKE":"%מפיקים%"},{"department ILIKE":"%מפיק%"},{"department ILIKE":"%הפקה%"},{"department ILIKE":"%producers%"},{"department ILIKE":"%Production staff%"}]}})).data||[]:s==="digital"?L=(await G.query("/workers",{where:{or:[{"department ILIKE":"%digital%"},{"department ILIKE":"%Digital%"},{"department ILIKE":"%דיגיטל%"}]}})).data||[]:L=(await G.query("/workers",{where:{department:{ilike:`%${s}%`}}})).data||[]:L=(await G.query("/workers")).data||[],j(Array.isArray(L)?L:[]),u(0)}catch(L){console.error("Error fetching workers:",L),x("שגיאה בטעינת רשימת העובדים"),g<3?(u(w=>w+1),setTimeout(()=>{y()},2e3)):T({title:"שגיאה",description:"שגיאה בטעינת רשימת העובדים לאחר מספר ניסיונות",variant:"destructive"}),j([])}finally{v(!1)}};y()},[T,s,g]);const k=y=>{i(n===y?null:y,o),V(!1)},f=y=>{h(y.target.value),i(n,y.target.value)},F=y=>{S(y.target.value)},P=()=>{u(0),j([]),v(!0),(async()=>{try{const L=await Yt();j(L||[]),x(null)}catch(L){console.error("Error in retry fetching workers:",L),x("שגיאה בטעינת רשימת העובדים"),T({title:"שגיאה",description:"שגיאה בטעינת רשימת העובדים",variant:"destructive"}),j([])}finally{v(!1)}})()},O=y=>{i(y,o)},_=E?d.filter(y=>y.name.toLowerCase().includes(E.toLowerCase())||y.department&&y.department.toLowerCase().includes(E.toLowerCase())):d;return b?e.jsxDEV("div",{className:Ee("flex flex-col gap-2",m),dir:"rtl",children:[e.jsxDEV("div",{className:"flex items-center justify-center p-2 border rounded bg-gray-50",children:[e.jsxDEV(nn,{className:"h-4 w-4 animate-spin mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:209,columnNumber:11},void 0),e.jsxDEV("span",{children:"טוען עובדים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:210,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:208,columnNumber:9},void 0),e.jsxDEV($,{type:"text",value:o,onChange:f,placeholder:"הערות נוספות...",className:"mt-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:212,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:207,columnNumber:7},void 0):N?e.jsxDEV("div",{className:Ee("flex flex-col gap-2",m),dir:"rtl",children:[e.jsxDEV("div",{className:"flex items-center justify-between p-2 border rounded bg-red-50 text-red-700",children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(cn,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:229,columnNumber:13},void 0),e.jsxDEV("span",{children:N},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:230,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:228,columnNumber:11},void 0),e.jsxDEV(A,{variant:"outline",size:"sm",onClick:P,children:"נסה שנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:232,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:227,columnNumber:9},void 0),e.jsxDEV($,{type:"text",value:o,onChange:f,placeholder:"הערות נוספות...",className:"mt-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:236,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:226,columnNumber:7},void 0):e.jsxDEV("div",{className:Ee("flex flex-col gap-2",m),dir:"rtl",children:[e.jsxDEV(Nn,{value:n||"",onValueChange:O,children:[e.jsxDEV(gn,{className:"w-full",children:e.jsxDEV(hn,{placeholder:a,children:c||a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:252,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:251,columnNumber:9},void 0),e.jsxDEV(bn,{position:"popper",children:[Array.isArray(d)&&d.map(y=>e.jsxDEV(xn,{value:y.id,children:[y.name,y.department&&e.jsxDEV("span",{className:"text-gray-500 text-sm",children:[" (",y.department,")"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:261,columnNumber:17},void 0)]},y.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:258,columnNumber:13},void 0)),e.jsxDEV(A,{variant:"ghost",onClick:()=>V(!0),className:"w-full justify-start text-sm mt-2",children:"חיפוש מתקדם..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:267,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:256,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:250,columnNumber:7},void 0),e.jsxDEV(qe,{open:R,onOpenChange:V,children:e.jsxDEV(Ke,{className:"sm:max-w-md",children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{children:"חיפוש עובדים מתקדם"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:281,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:280,columnNumber:11},void 0),e.jsxDEV("div",{className:"p-2",children:[e.jsxDEV($,{placeholder:"חיפוש עובדים...",value:E,onChange:F,className:"mb-2",autoFocus:!0},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:285,columnNumber:13},void 0),N&&e.jsxDEV("div",{className:"p-2 text-sm text-red-500 border border-red-200 rounded mb-2 flex items-center justify-between",children:[e.jsxDEV("span",{children:N},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:295,columnNumber:17},void 0),e.jsxDEV(A,{variant:"outline",size:"sm",onClick:P,className:"ml-2 text-xs",children:"ניסיון מחדש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:296,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:294,columnNumber:15},void 0),e.jsxDEV("div",{className:"max-h-64 overflow-y-auto",children:b?e.jsxDEV("div",{className:"p-4 text-center",children:[e.jsxDEV(nn,{className:"h-5 w-5 animate-spin mx-auto mb-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:310,columnNumber:19},void 0),e.jsxDEV("div",{className:"text-muted-foreground",children:"טוען עובדים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:311,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:309,columnNumber:17},void 0):_.length===0?e.jsxDEV("div",{className:"p-2 text-center text-muted-foreground",children:E?"לא נמצאו עובדים":"אין עובדים זמינים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:314,columnNumber:17},void 0):e.jsxDEV("div",{className:"space-y-1",children:Array.isArray(_)&&_.map(y=>e.jsxDEV("button",{type:"button",className:Ee("flex w-full items-center rounded-md px-2 py-1.5 text-sm","hover:bg-accent hover:text-accent-foreground","cursor-pointer",n===y.id&&"bg-accent text-accent-foreground"),onClick:()=>k(y.id),children:[e.jsxDEV(nr,{className:Ee("mr-2 h-4 w-4",n===y.id?"opacity-100":"opacity-0")},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:331,columnNumber:23},void 0),e.jsxDEV("span",{children:y.name},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:337,columnNumber:23},void 0),y.department&&e.jsxDEV("span",{className:"text-gray-500 text-sm mr-2",children:["(",y.department,")"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:339,columnNumber:25},void 0)]},y.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:320,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:318,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:307,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:284,columnNumber:11},void 0),e.jsxDEV(an,{children:e.jsxDEV(A,{variant:"outline",onClick:()=>V(!1),children:"סגור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:349,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:348,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:279,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:278,columnNumber:7},void 0),e.jsxDEV($,{type:"text",value:o,onChange:f,placeholder:"הערות נוספות...",className:"mt-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:354,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/schedule/workers/WorkerSelector.tsx",lineNumber:248,columnNumber:5},void 0)},pe={DIGITAL_SHIFTS:"digital_shifts",RADIO_NORTH:"radio_north",TRANSCRIPTION_SHIFTS:"transcription_shifts",LIVE_SOCIAL_SHIFTS:"live_social_shifts"},Zr={[pe.DIGITAL_SHIFTS]:"משמרות דיגיטל",[pe.RADIO_NORTH]:"רדיו צפון",[pe.TRANSCRIPTION_SHIFTS]:"משמרות תמלולים",[pe.LIVE_SOCIAL_SHIFTS]:"משמרות לייבים"},ge={MORNING:"morning",AFTERNOON:"afternoon",EVENING:"evening",CUSTOM:"custom"},fr={[ge.MORNING]:"בוקר",[ge.AFTERNOON]:"צהריים",[ge.EVENING]:"ערב",[ge.CUSTOM]:"מותאם אישית"},Nr=["ראשון","שני","שלישי","רביעי","חמישי","שישי"],$e={[ge.MORNING]:{start:"07:00",end:"12:00"},[ge.AFTERNOON]:{start:"12:00",end:"21:00"},[ge.EVENING]:{start:"17:00",end:"21:00"},[ge.CUSTOM]:{start:"12:00",end:"15:00"}},ga=()=>{const[n,i]=t.useState(null),[r,a]=t.useState([]),[m,s]=t.useState([]),[o,h]=t.useState([]),[d,j]=t.useState(!0),[b,v]=t.useState(()=>mn(new Date,{weekStartsOn:0})),[N,x]=t.useState(pe.DIGITAL_SHIFTS),[E,S]=t.useState(!1),[g,u]=t.useState(!1),[R,V]=t.useState(!1),[T,l]=t.useState(null),[c,k]=t.useState(null),[f,F]=t.useState({}),[P,O]=t.useState(""),[_,y]=t.useState({section_name:pe.DIGITAL_SHIFTS,day_of_week:0,shift_type:ge.MORNING,start_time:$e[ge.MORNING].start,end_time:$e[ge.MORNING].end,person_name:"",additional_text:"",is_custom_time:!1,is_hidden:!1}),[L,w]=t.useState(!1),{toast:q}=De(),z=p=>{v(C=>{const H=p==="prev"?yn(C,1):Dn(C,1);return mn(H,{weekStartsOn:0})})};t.useEffect(()=>()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto",document.querySelectorAll('div[id^="cbcb"]').forEach(C=>C.remove())},[]),t.useEffect(()=>{!E&&!g&&!R&&(()=>{document.body.style.pointerEvents==="none"&&(document.body.style.pointerEvents="",document.body.style.pointerEvents="auto")})()},[E,g,R]),t.useEffect(()=>{ne(),I()},[b]);const I=async()=>{try{const{data:p,error:C}=await G.query("/workers");if(C)throw C;const H=p.filter(J=>J.department&&J.department.includes("digital"));h(H||[])}catch(p){console.error("Error fetching digital workers:",p)}},B=async p=>{try{const{data:C,error:H}=await G.query("/digital-shifts",{where:{arrangement_id:p}});if(H){console.error("Error fetching existing shifts:",H);return}const J=new Set;C&&C.length>0&&C.forEach(ue=>{J.add(ue.section_name)});const Ne=[pe.DIGITAL_SHIFTS,pe.RADIO_NORTH,pe.TRANSCRIPTION_SHIFTS,pe.LIVE_SOCIAL_SHIFTS].filter(ue=>!J.has(ue));if(Ne.length===0){console.log("All sections already have shifts for this arrangement");return}console.log("Creating default shifts for sections:",Ne);const Y=[];let de=0;for(let ue=0;ue<6;ue++)Ne.includes(pe.DIGITAL_SHIFTS)&&(Y.push({arrangement_id:p,section_name:pe.DIGITAL_SHIFTS,day_of_week:ue,shift_type:ge.MORNING,start_time:$e[ge.MORNING].start,end_time:$e[ge.MORNING].end,person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++}),Y.push({arrangement_id:p,section_name:pe.DIGITAL_SHIFTS,day_of_week:ue,shift_type:ge.AFTERNOON,start_time:$e[ge.AFTERNOON].start,end_time:$e[ge.AFTERNOON].end,person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++})),Ne.includes(pe.RADIO_NORTH)&&Y.push({arrangement_id:p,section_name:pe.RADIO_NORTH,day_of_week:ue,shift_type:ge.MORNING,start_time:"09:00",end_time:"12:00",person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++}),Ne.includes(pe.TRANSCRIPTION_SHIFTS)&&(Y.push({arrangement_id:p,section_name:pe.TRANSCRIPTION_SHIFTS,day_of_week:ue,shift_type:ge.MORNING,start_time:"07:00",end_time:"14:00",person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++}),Y.push({arrangement_id:p,section_name:pe.TRANSCRIPTION_SHIFTS,day_of_week:ue,shift_type:ge.AFTERNOON,start_time:"14:00",end_time:"20:00",person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++})),Ne.includes(pe.LIVE_SOCIAL_SHIFTS)&&(Y.push({arrangement_id:p,section_name:pe.LIVE_SOCIAL_SHIFTS,day_of_week:ue,shift_type:ge.MORNING,start_time:"07:00",end_time:"14:00",person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++}),Y.push({arrangement_id:p,section_name:pe.LIVE_SOCIAL_SHIFTS,day_of_week:ue,shift_type:ge.AFTERNOON,start_time:"14:00",end_time:"20:00",person_name:null,additional_text:null,is_custom_time:!1,is_hidden:!1,position:de++}));for(const ue of Y){const{error:be}=await G.mutate("/digital-shifts",ue,"POST");be&&console.error("Error creating default shift:",be)}console.log("Default shifts created successfully")}catch(C){console.error("Error creating default shifts:",C)}},ne=async()=>{j(!0);const p=re(b,"yyyy-MM-dd");try{const{data:C,error:H}=await G.query("/digital-work-arrangements",{where:{week_start:p},single:!0});if(H)throw H;let J;if(C)J=C;else{const{data:ke,error:_e}=await G.mutate("/digital-work-arrangements",{week_start:p,notes:null,footer_text:null,footer_image_url:null},"POST");if(_e)throw _e;J=ke,await B(J.id)}i(J),O(J.footer_text||"");const{data:te,error:Ne}=await G.query("/digital-shifts",{where:{arrangement_id:J.id},order:{position:"asc"}});if(Ne)throw Ne;let Y=te||[];const de=new Set(Y.map(ke=>ke.section_name)),be=[pe.DIGITAL_SHIFTS,pe.RADIO_NORTH,pe.TRANSCRIPTION_SHIFTS,pe.LIVE_SOCIAL_SHIFTS].filter(ke=>!de.has(ke));if(be.length>0){console.log("Creating default shifts for missing sections:",be),await B(J.id);const{data:ke,error:_e}=await G.query("/digital-shifts",{where:{arrangement_id:J.id},order:{position:"asc"}});_e||(Y=ke||[])}a(Y);const{data:Be,error:Oe}=await G.query("/digital-shift-custom-rows",{where:{arrangement_id:J.id},order:{position:"asc"}});if(Oe)throw Oe;const Pn=Be?.map(ke=>{let _e={};try{if(ke.contents)if(typeof ke.contents=="string")try{_e=JSON.parse(ke.contents)}catch{_e={}}else typeof ke.contents=="object"&&Object.entries(ke.contents).forEach(([Cn,dr])=>{dr!=null?_e[Number(Cn)]=String(dr):_e[Number(Cn)]=""})}catch(Cn){console.error("Error parsing contents",Cn)}return{id:ke.id,section_name:ke.section_name,contents:_e,position:ke.position}})||[];s(Pn)}catch(C){console.error("Error fetching digital work arrangement:",C),q({title:"שגיאה",description:"לא ניתן לטעון את סידור העבודה",variant:"destructive"})}finally{j(!1)}},fe=async()=>{if(n)try{if(T){const{error:p}=await G.mutate(`/digital-shifts/${T.id}`,{section_name:_.section_name,day_of_week:_.day_of_week,shift_type:_.shift_type,start_time:_.start_time,end_time:_.end_time,person_name:_.person_name||null,additional_text:_.additional_text||null,is_custom_time:_.is_custom_time,is_hidden:_.is_hidden},"PUT");if(p)throw p;q({title:"בוצע",description:"המשמרת עודכנה בהצלחה"})}else{const p=r.filter(H=>H.section_name===_.section_name&&H.day_of_week===_.day_of_week&&H.shift_type===_.shift_type).length,{error:C}=await G.mutate("/digital-shifts",{arrangement_id:n.id,section_name:_.section_name,day_of_week:_.day_of_week,shift_type:_.shift_type,start_time:_.start_time,end_time:_.end_time,person_name:_.person_name||null,additional_text:_.additional_text||null,is_custom_time:_.is_custom_time,is_hidden:_.is_hidden,position:p},"POST");if(C)throw C;q({title:"בוצע",description:"המשמרת נוצרה בהצלחה"})}ne(),sr()}catch(p){console.error("Error saving shift:",p),q({title:"שגיאה",description:"לא ניתן לשמור את המשמרת",variant:"destructive"})}},Se=async()=>{if(n)try{if(c){const{error:p}=await G.mutate("/digital-shift-custom-rows",{id:c.id,section_name:N,contents:f},"PUT");if(p)throw p;q({title:"בוצע",description:"השורה עודכנה בהצלחה"})}else{const p=m.filter(H=>H.section_name===N).length,{error:C}=await G.mutate("/digital-shift-custom-rows",{arrangement_id:n.id,section_name:N,contents:f,position:p},"POST");if(C)throw C;q({title:"בוצע",description:"השורה נוצרה בהצלחה"})}ne(),mr()}catch(p){console.error("Error saving custom row:",p),q({title:"שגיאה",description:"לא ניתן לשמור את השורה",variant:"destructive"})}},ze=async p=>{try{const{error:C}=await G.mutate(`/digital-shifts/${p}`,{},"DELETE");if(C)throw C;a(r.filter(H=>H.id!==p)),q({title:"בוצע",description:"המשמרת נמחקה בהצלחה"})}catch(C){console.error("Error deleting shift:",C),q({title:"שגיאה",description:"לא ניתן למחוק את המשמרת",variant:"destructive"})}},Ue=async p=>{try{const{error:C}=await G.mutate(`/digital-shift-custom-rows/${p}`,{},"DELETE");if(C)throw C;s(m.filter(H=>H.id!==p)),q({title:"בוצע",description:"השורה נמחקה בהצלחה"})}catch(C){console.error("Error deleting custom row:",C),q({title:"שגיאה",description:"לא ניתן למחוק את השורה",variant:"destructive"})}},X=async()=>{if(n)try{const{error:p}=await G.mutate(`/digital-work-arrangements/${n.id}`,{footer_text:P},"PUT");if(p)throw p;q({title:"בוצע",description:"הטקסט עודכן בהצלחה"}),lr()}catch(p){console.error("Error updating footer text:",p),q({title:"שגיאה",description:"לא ניתן לשמור את הטקסט",variant:"destructive"})}},M=p=>{p?(l(p),y({section_name:p.section_name,day_of_week:p.day_of_week,shift_type:p.shift_type,start_time:p.start_time,end_time:p.end_time,person_name:p.person_name||"",additional_text:p.additional_text||"",is_custom_time:p.is_custom_time,is_hidden:p.is_hidden})):(l(null),y({section_name:N,day_of_week:0,shift_type:ge.MORNING,start_time:$e[ge.MORNING].start,end_time:$e[ge.MORNING].end,person_name:"",additional_text:"",is_custom_time:!1,is_hidden:!1})),S(!0)},ye=p=>{if(p)k(p),F(p.contents);else{k(null);const C={};for(let H=0;H<6;H++)C[H]="";F(C)}u(!0)},K=async(p,C,H)=>{if(n)try{if(p.person_name!==C||p.additional_text!==H){const{error:J}=await G.mutate(`/digital-shifts/${p.id}`,{person_name:C,additional_text:H||p.additional_text},"PUT");if(J)throw J;a(r.map(te=>te.id===p.id?{...te,person_name:C,additional_text:H||te.additional_text}:te))}}catch(J){console.error("Error updating shift worker:",J),q({title:"שגיאה",description:"לא ניתן לעדכן את העובד במשמרת",variant:"destructive"})}},[ce,je]=t.useState({}),[We,we]=t.useState(null),ve=(p,C,H)=>{const J=`${p}-${C}`;je(te=>({...te,[J]:{rowId:p,dayIndex:C,content:H}})),s(m.map(te=>te.id===p?{...te,contents:{...te.contents,[C]:H}}:te))},se=async(p,C)=>{const H=`${p}-${C}`;we(null);const J=ce[H];if(J)try{const te=m.find(de=>de.id===p);if(!te)return;const Ne={...te.contents,[C]:J.content},{error:Y}=await G.mutate(`/digital-shift-custom-rows/${p}`,{contents:Ne},"PUT");if(Y)throw Y;je(de=>{const ue={...de};return delete ue[H],ue})}catch(te){console.error("Error updating custom cell content:",te),q({title:"שגיאה",description:"לא ניתן לעדכן את תוכן התא",variant:"destructive"})}},D=(p,C,H)=>r.filter(J=>J.section_name===p&&J.day_of_week===C&&J.shift_type===H),W=p=>m.filter(C=>C.section_name===p),Ve=(p,C,H)=>{const J=D(p,C,H);return J.length===0?e.jsxDEV(Z,{className:"p-2 border text-center align-top",children:e.jsxDEV(A,{variant:"ghost",size:"sm",onClick:()=>{y({..._,section_name:p,day_of_week:C,shift_type:H,start_time:$e[H].start,end_time:$e[H].end}),l(null),S(!0)},className:"w-full h-full min-h-[60px] flex items-center justify-center",children:e.jsxDEV(Sn,{className:"h-4 w-4 opacity-50"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:785,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:773,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:772,columnNumber:14},void 0):e.jsxDEV(Z,{className:"p-2 border align-top",children:J.map(te=>e.jsxDEV("div",{className:`mb-2 p-2 rounded ${te.is_hidden?"opacity-50":""}`,children:[e.jsxDEV("div",{className:"flex justify-between items-center mb-1",children:[e.jsxDEV("div",{className:`text-xs ${te.is_custom_time?"font-bold digital-shift-irregular-hours":""}`,children:[te.start_time.substring(0,5)," - ",te.end_time.substring(0,5)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:792,columnNumber:15},void 0),e.jsxDEV(Fi,{children:[e.jsxDEV(Ri,{asChild:!0,children:e.jsxDEV(A,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:e.jsxDEV(xt,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:798,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:797,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:796,columnNumber:17},void 0),e.jsxDEV(Mi,{align:"end",className:"bg-background border border-border",children:[e.jsxDEV(Ir,{onClick:()=>M(te),children:[e.jsxDEV(mi,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:803,columnNumber:21},void 0),"ערוך"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:802,columnNumber:19},void 0),e.jsxDEV(Ir,{onClick:()=>ze(te.id),children:[e.jsxDEV(kn,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:807,columnNumber:21},void 0),"מחק"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:806,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:801,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:795,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:791,columnNumber:13},void 0),e.jsxDEV("div",{className:"mt-2",children:e.jsxDEV(Jr,{value:te.person_name,onChange:(Ne,Y)=>K(te,Ne,Y),additionalText:te.additional_text||"",placeholder:"בחר עובד...",className:"w-full",department:"digital"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:815,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:814,columnNumber:13},void 0)]},te.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:790,columnNumber:34},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:789,columnNumber:12},void 0)},ln=p=>{const C=W(p);return C.length===0?e.jsxDEV(he,{children:e.jsxDEV(Z,{colSpan:6,className:"text-center py-4",children:e.jsxDEV(A,{variant:"outline",onClick:()=>{x(p),ye()},children:[e.jsxDEV(Sn,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:836,columnNumber:15},void 0),"הוסף שורה מותאמת אישית"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:832,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:831,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:830,columnNumber:14},void 0):C.map(H=>e.jsxDEV(he,{className:"custom-row-editor",children:e.jsxDEV(Ai,{rowContents:H.contents,section:p,onContentChange:(J,te)=>ve(H.id,J,te),onBlur:J=>se(H.id,J),onFocus:J=>we(`${H.id}-${J}`),editable:!0,showActions:!0,onEdit:()=>ye(H),onDelete:()=>Ue(H.id)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:843,columnNumber:9},void 0)},H.id,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:842,columnNumber:28},void 0))},Cr=()=>{const p=re(b,"dd",{locale:Ce}),C=new Date(b);C.setDate(C.getDate()+5);const H=re(C,"dd",{locale:Ce}),J=re(b,"MMMM yyyy",{locale:Ce});return`${H}-${p} ב${J}`},sr=()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto",S(!1),setTimeout(()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto"},100)},mr=()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto",u(!1),setTimeout(()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto"},100)},lr=()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto",V(!1),setTimeout(()=>{document.body.style.pointerEvents="",document.body.style.pointerEvents="auto"},100)},Di=async()=>{const p=document.getElementById("digital-work-arrangement-preview");if(p){p.classList.add("digital-export-pdf");try{const C=await Hr(p,{scrollY:-window.scrollY,useCORS:!0,scale:2,backgroundColor:"#ffffff"}),H=C.toDataURL("image/jpeg",1),J=new Gr({orientation:"portrait",unit:"mm",format:"a4"}),te=J.internal.pageSize.getWidth(),Ne=J.internal.pageSize.getHeight(),Y={width:C.width,height:C.height},de=Math.min(te/Y.width,Ne/Y.height),ue=Y.width*de,be=Y.height*de;J.addImage(H,"JPEG",0,0,ue,be),J.save(`digital_${re(b,"dd-MM-yy")}.pdf`)}finally{p.classList.remove("digital-export-pdf")}}},Si=async()=>{const p=document.createElement("div");p.style.position="absolute",p.style.left="-9999px",p.style.top="0",p.style.width="210mm",p.style.height="297mm",p.style.backgroundColor="white",p.style.padding="5mm 2mm",p.style.fontFamily="Heebo, Arial, sans-serif",p.style.direction="rtl",p.style.textAlign="right";const C=document.createElement("style");C.textContent=`
      .digital-work-arrangement-view td {
        padding: .3rem .1rem 1rem !important;
        }
      .digital-shift {
        margin: 0 !important;
        padding: 0 !important;
      }
      .digital-shift-time {
        text-decoration: underline !important;
        margin: 0 auto !important;
        padding: 0 0 5px 0 !important;
        border-bottom: 1px solid #333 !important;
        width: fit-content !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        text-align: center !important;
        display: block !important;
      }
      .digital-shift-irregular-hours {
        background-color:rgb(233, 200, 69) !important;
        color: #000 !important;
        width: fit-content !important;
        margin: 0 auto !important;
        padding: 0 0 5px 0 !important;
        text-align: center !important;
        display: block !important;
      }
      .digital-shift-person {
        position: relative;
        top: -10px;
        padding: 0 !important;
        font-size: 20px !important;
        font-weight: bold !important;
        text-align: center !important;
      }
      .digital-shift-note {
        margin: 0 !important;
        padding: 0 !important;
        font-size: 0.875rem !important;
        text-align: center !important;
      }
      .mb-2, .mt-1, .mt-0\\.5, .flex, .items-center, .justify-center, .text-center, .font-medium {
        margin: 0 !important;
      }
    `,p.appendChild(C);const H=ji();p.innerHTML+=H,document.body.appendChild(p);try{const te=(await Hr(p,{useCORS:!0,scale:2,backgroundColor:"#ffffff",width:793.70078739,height:1122.519685023})).toDataURL("image/jpeg",1),Ne=new Gr({orientation:"portrait",unit:"mm",format:"a4"}),Y=Ne.internal.pageSize.getWidth(),de=Ne.internal.pageSize.getHeight();Ne.addImage(te,"JPEG",0,0,Y,de),Ne.save(`digital_print_friendly_${re(b,"dd-MM-yy")}.pdf`)}finally{document.body.removeChild(p)}},ji=()=>{const p=[];for(let Y=0;Y<6;Y++){const de=Zn(b,Y);p.push({day:re(de,"EEEE",{locale:Ce}),date:re(de,"dd/MM"),fullDate:de})}const C=(()=>{const Y=new Date(b);Y.setDate(Y.getDate()+5);const de=re(Y,"dd",{locale:Ce}),ue=re(b,"dd",{locale:Ce}),be=re(b,"MMMM yyyy",{locale:Ce});return`${de}-${ue} ב${be}`})(),H=Y=>{if(!Y)return"";if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(Y)){const ue=o.find(be=>be.id===Y);return ue&&ue.name?ue.name.split(" ")[0]:Y}return Y.split(" ")[0]},J=(Y,de,ue)=>r.filter(be=>be.section_name===Y&&be.day_of_week===de&&be.shift_type===ue&&!be.is_hidden&&be.person_name&&be.person_name.trim()!==""&&be.person_name!=="null"),te=(Y,de,ue)=>{const be=J(Y,de,ue);if(be.length===0)return`<td class="p-2 border text-center digital-cell digital-cell-empty digital-cell-${Y}"></td>`;const Be=be.map(Oe=>{const Pn=H(Oe.person_name),ke=Oe.start_time&&Oe.end_time?`${Oe.end_time.slice(0,5)}-${Oe.start_time.slice(0,5)}`:"משמרת";return`
          <div class="digital-shift digital-shift-${Y}">
            <div class="digital-shift-time ${Oe.is_custom_time?"digital-shift-custom-time digital-shift-irregular-hours":""}">
              ${ke}
            </div>
            <div class="digital-shift-person text-center">
              ${Pn}
            </div>
            ${Oe.additional_text?`
              <div class="digital-shift-note text-sm text-gray-600">
                ${Oe.additional_text}
              </div>
            `:""}
          </div>
        `}).join("");return`<td class="p-2 border digital-cell digital-cell-${Y}">${Be}</td>`},Ne=(Y,de)=>{if(!r.some(Be=>Be.section_name===Y&&Be.person_name&&Be.person_name.trim()!==""&&Be.person_name!=="null"))return"";const be=Object.entries(fr).map(([Be,Oe])=>r.some(_e=>_e.section_name===Y&&_e.shift_type===Be&&_e.person_name&&_e.person_name.trim()!==""&&_e.person_name!=="null")?`<tr class="bg-white hover:bg-gray-50 transition-colors digital-shift-row digital-shift-type-row">${[0,1,2,3,4,5].map(_e=>te(Y,_e,Be)).join("")}</tr>`:"").join("");return`
        <tr class="digital-section-title-row">
          <td colspan="6" class="p-2 font-bold text-lg bg-gray-100 digital-section-title">
            ${de}
          </td>
        </tr>
        ${be}
      `};return`
      <div class="space-y-6 digital-work-arrangement-view" dir="rtl" style="font-family: 'Heebo', Arial, sans-serif; margin: 5mm 0mm !important; max-width: calc(100% - 4mm);">
        <div class="flex flex-col md:flex-row justify-between items-center bg-white p-4 rounded-lg shadow-sm mb-6 digital-work-header">
          <h2 class="text-2xl font-bold mb-2 md:mb-0 flex items-center digital-work-title">
            סידור עבודה דיגיטל
          </h2>
          <div class="text-lg font-medium bg-blue-50 py-1.5 rounded-full text-blue-700 flex items-center digital-work-date px-[33px]" style="padding: 0px 10px 15px;">
            ${C}
          </div>
        </div>

        <div class="border-none shadow-md overflow-hidden digital-work-card">
          <div class="p-6">
            <div class="digital-work-arrangement-table">
              <table class="w-full border-collapse">
                <thead>
                  <tr class="digital-header-row">
                    ${p.map((Y,de)=>`
                      <th class="w-1/6 text-center bg-black text-white p-2 font-bold digital-header-cell">
                        <div class="date-header">
                          <div class="date-day">${Y.day}</div>
                          <div class="date-number text-sm opacity-80" style="margin-bottom: 10px;">${Y.date}</div>
                        </div>
                      </th>
                    `).join("")}
                  </tr>
                </thead>
                <tbody>
                  ${Ne(pe.DIGITAL_SHIFTS,"משמרות דיגיטל")}
                  ${Ne(pe.RADIO_NORTH,"רדיו צפון")}
                  ${Ne(pe.TRANSCRIPTION_SHIFTS,"משמרות תמלולים")}
                  ${Ne(pe.LIVE_SOCIAL_SHIFTS,"משמרות לייבים")}
                </tbody>
              </table>
            </div>
            
            ${n?.footer_text?`
              <div class="digital-footer-text whitespace-pre-wrap mt-8 p-4 rounded-lg">
                ${n.footer_text}
              </div>
            `:""}
          </div>
        </div>
      </div>
    `},Vi=()=>{w(!L)};return e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:[e.jsxDEV("div",{className:"flex justify-between items-center",children:[e.jsxDEV("h2",{className:"text-2xl font-bold",children:"עורך סידור עבודה דיגיטל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1198,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(A,{variant:"outline",size:"sm",onClick:()=>z("prev"),children:[e.jsxDEV(rr,{className:"h-4 w-4 ml-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1202,columnNumber:15},void 0),"שבוע קודם"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1201,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-sm font-medium mx-2 bg-blue-50 py-1.5 rounded-full text-blue-700 flex items-center px-[23px]",children:[e.jsxDEV(jn,{className:"h-4 w-4 mr-2 px-px mx-[8px]"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1206,columnNumber:15},void 0),Cr()]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1205,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",size:"sm",onClick:()=>z("next"),children:["שבוע הבא",e.jsxDEV(ir,{className:"h-4 w-4 mr-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1211,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1209,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1200,columnNumber:11},void 0),e.jsxDEV(A,{variant:L?"default":"outline",size:"sm",onClick:Vi,children:[e.jsxDEV(si,{className:"h-4 w-4 ml-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1215,columnNumber:13},void 0),L?"חזרה לעריכה":"תצוגה מקדימה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1214,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1199,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1197,columnNumber:7},void 0),d?e.jsxDEV("div",{className:"flex justify-center my-8",children:e.jsxDEV("p",{children:"טוען נתונים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1223,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1222,columnNumber:9},void 0):L?e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"flex justify-end space-x-2 space-x-reverse",children:[e.jsxDEV(A,{variant:"outline",size:"sm",onClick:Di,children:[e.jsxDEV(tr,{className:"h-4 w-4 ml-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1229,columnNumber:15},void 0),"ייצוא PDF"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1228,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",size:"sm",onClick:Si,children:[e.jsxDEV(bt,{className:"h-4 w-4 ml-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1233,columnNumber:15},void 0),"ייצוא PDF נוח להדפסה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1232,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1227,columnNumber:11},void 0),e.jsxDEV(Q,{children:e.jsxDEV(ie,{className:"p-6",children:e.jsxDEV("div",{id:"digital-work-arrangement-preview",children:e.jsxDEV(_i,{selectedDate:b,weekDate:re(b,"yyyy-MM-dd")},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1240,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1239,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1238,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1237,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1226,columnNumber:9},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"flex flex-wrap space-x-2 space-x-reverse mb-4",children:Object.entries(Zr).map(([p,C])=>e.jsxDEV(A,{variant:N===p?"default":"outline",onClick:()=>x(p),className:"mb-2",children:C},p,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1249,columnNumber:15},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1247,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex flex-wrap space-x-2 space-x-reverse mb-4",children:e.jsxDEV(A,{onClick:()=>V(!0),children:n?.footer_text?"ערוך טקסט תחתון":"הוסף טקסט תחתון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1261,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1260,columnNumber:11},void 0),e.jsxDEV(Q,{children:e.jsxDEV(ie,{className:"pt-6 overflow-x-auto",children:e.jsxDEV(Ze,{children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:Nr.map((p,C)=>e.jsxDEV(ee,{className:"text-center",children:p},p,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1272,columnNumber:23},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1270,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1269,columnNumber:17},void 0),e.jsxDEV(en,{children:[Object.entries(fr).map(([p,C])=>e.jsxDEV(he,{children:[0,1,2,3,4,5].map(H=>e.jsxDEV(pn.Fragment,{children:Ve(N,H,p)},`${p}-${H}`,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1282,columnNumber:25},void 0))},p,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1280,columnNumber:21},void 0)),ln(N)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1278,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1268,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1267,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1266,columnNumber:11},void 0),e.jsxDEV(qe,{open:E,onOpenChange:p=>{p||(document.body.style.pointerEvents="",document.body.style.pointerEvents="auto"),S(p)},children:e.jsxDEV(Ke,{className:"sm:max-w-[425px] bg-background",onEscapeKeyDown:sr,onPointerDownOutside:sr,dir:"rtl",children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{children:T?"עריכת משמרת":"הוספת משמרת חדשה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1305,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1304,columnNumber:11},void 0),e.jsxDEV("div",{className:"grid gap-4 py-4",children:[e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{className:"text-right",htmlFor:"shift-section",children:"סקשן"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1311,columnNumber:15},void 0),e.jsxDEV(Nn,{value:_.section_name,onValueChange:p=>y({..._,section_name:p}),children:[e.jsxDEV(gn,{className:"col-span-3 bg-background",children:e.jsxDEV(hn,{placeholder:"בחר סקשן"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1317,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1316,columnNumber:17},void 0),e.jsxDEV(bn,{className:"bg-background",children:Object.entries(Zr).map(([p,C])=>e.jsxDEV(xn,{value:p,children:C},p,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1320,columnNumber:73},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1319,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1312,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1310,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{className:"text-right",htmlFor:"shift-day",children:"יום"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1326,columnNumber:15},void 0),e.jsxDEV(Nn,{value:_.day_of_week.toString(),onValueChange:p=>y({..._,day_of_week:parseInt(p)}),children:[e.jsxDEV(gn,{className:"col-span-3 bg-background",children:e.jsxDEV(hn,{placeholder:"בחר יום"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1332,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1331,columnNumber:17},void 0),e.jsxDEV(bn,{className:"bg-background",children:Nr.map((p,C)=>e.jsxDEV(xn,{value:C.toString(),children:p},C,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1335,columnNumber:53},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1334,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1327,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1325,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{className:"text-right",htmlFor:"shift-type",children:"סוג משמרת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1341,columnNumber:15},void 0),e.jsxDEV(Nn,{value:_.shift_type,onValueChange:p=>{y({..._,shift_type:p,start_time:$e[p].start,end_time:$e[p].end})},children:[e.jsxDEV(gn,{className:"col-span-3 bg-background",children:e.jsxDEV(hn,{placeholder:"בחר סוג משמרת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1351,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1350,columnNumber:17},void 0),e.jsxDEV(bn,{className:"bg-background",children:Object.entries(fr).map(([p,C])=>e.jsxDEV(xn,{value:p,children:C},p,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1354,columnNumber:77},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1353,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1342,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1340,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{className:"text-right",htmlFor:"start-time",children:"שעת התחלה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1360,columnNumber:15},void 0),e.jsxDEV($,{id:"start-time",type:"time",value:_.start_time,onChange:p=>y({..._,start_time:p.target.value}),className:"col-span-3 bg-background"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1361,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1359,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{className:"text-right",htmlFor:"end-time",children:"שעת סיום"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1368,columnNumber:15},void 0),e.jsxDEV($,{id:"end-time",type:"time",value:_.end_time,onChange:p=>y({..._,end_time:p.target.value}),className:"col-span-3 bg-background"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1369,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1367,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxDEV(U,{className:"text-right",htmlFor:"person-name",children:"עובד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1376,columnNumber:15},void 0),e.jsxDEV("div",{className:"col-span-3",children:e.jsxDEV(Jr,{value:_.person_name||null,onChange:(p,C)=>y({..._,person_name:p||"",additional_text:C||""}),additionalText:_.additional_text,placeholder:"בחר עובד...",className:"w-full",department:"digital"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1378,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1377,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1375,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(Ge,{id:"is-custom-time",checked:_.is_custom_time,onCheckedChange:p=>y({..._,is_custom_time:p===!0})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1394,columnNumber:15},void 0),e.jsxDEV(U,{htmlFor:"is-custom-time",children:"הדגש שעות מותאמות אישית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1398,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1393,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(Ge,{id:"is-hidden",checked:_.is_hidden,onCheckedChange:p=>y({..._,is_hidden:p===!0})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1402,columnNumber:15},void 0),e.jsxDEV(U,{htmlFor:"is-hidden",children:"הסתר משמרת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1406,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1401,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1309,columnNumber:11},void 0),e.jsxDEV(an,{children:e.jsxDEV(A,{type:"button",onClick:fe,children:"שמור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1410,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1409,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1303,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1295,columnNumber:11},void 0),e.jsxDEV(qe,{open:g,onOpenChange:p=>{p||(document.body.style.pointerEvents="",document.body.style.pointerEvents="auto"),u(p)},children:e.jsxDEV(Ke,{className:"max-w-4xl bg-background",onEscapeKeyDown:mr,onPointerDownOutside:mr,dir:"rtl",children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{children:c?"עריכת שורה מותאמת אישית":"הוספת שורה מותאמת אישית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1425,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1424,columnNumber:11},void 0),e.jsxDEV("div",{className:"grid grid-cols-6 gap-4 py-4",children:[0,1,2,3,4,5].map(p=>e.jsxDEV("div",{className:"flex flex-col",children:[e.jsxDEV(U,{className:"mb-2 text-center",children:Nr[p]},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1431,columnNumber:17},void 0),e.jsxDEV(Mn,{value:f[p]||"",onChange:C=>F({...f,[p]:C.target.value}),className:"min-h-[100px] bg-background",placeholder:"הזן טקסט..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1432,columnNumber:17},void 0)]},p,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1430,columnNumber:44},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1429,columnNumber:11},void 0),e.jsxDEV(an,{children:e.jsxDEV(A,{type:"button",onClick:Se,children:"שמור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1439,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1438,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1423,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1415,columnNumber:7},void 0),e.jsxDEV(qe,{open:R,onOpenChange:p=>{p||(document.body.style.pointerEvents="",document.body.style.pointerEvents="auto"),V(p)},children:e.jsxDEV(Ke,{className:"bg-background",onEscapeKeyDown:lr,onPointerDownOutside:lr,dir:"rtl",children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{children:"טקסט תחתון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1454,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1453,columnNumber:11},void 0),e.jsxDEV("div",{className:"py-4",children:e.jsxDEV(Mn,{placeholder:"הזן טקסט תחתון...",className:"min-h-[200px] bg-background",value:P,onChange:p=>O(p.target.value)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1457,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1456,columnNumber:11},void 0),e.jsxDEV(an,{children:e.jsxDEV(A,{type:"button",onClick:X,children:"שמור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1460,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1459,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1452,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1444,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1246,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangementEditor.tsx",lineNumber:1196,columnNumber:5},void 0)},ha=()=>{const[n,i]=t.useState("schedule");return t.useEffect(()=>()=>{document.body.style.pointerEvents==="none"&&(document.body.style.pointerEvents="")},[]),e.jsxDEV("div",{className:"container mx-auto py-10",children:[e.jsxDEV("h1",{className:"text-3xl font-bold mb-6 text-right",children:"ניהול סידורי עבודה דיגיטל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:19,columnNumber:7},void 0),e.jsxDEV(Qn,{value:n,onValueChange:i,children:[e.jsxDEV(er,{className:"mb-6",children:e.jsxDEV(on,{value:"schedule",children:"עריכת סידור עבודה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:23,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:22,columnNumber:9},void 0),e.jsxDEV(sn,{value:"schedule",children:e.jsxDEV(ga,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:27,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:26,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:21,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/DigitalWorkArrangement.tsx",lineNumber:18,columnNumber:5},void 0)},ba=({isOpen:n,onClose:i,onDeleteCurrentWeek:r,onDeleteAllFuture:a,isRecurring:m})=>m?e.jsxDEV(Hn,{open:n,onOpenChange:i,children:e.jsxDEV(Gn,{children:[e.jsxDEV(zn,{children:[e.jsxDEV(qn,{children:"מחיקת שיבוץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:49,columnNumber:11},void 0),e.jsxDEV(Kn,{children:"האם למחוק את השיבוץ משבוע זה בלבד, או מכל השבועות העתידיים?"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:50,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:48,columnNumber:9},void 0),e.jsxDEV(Yn,{children:[e.jsxDEV(Jn,{onClick:i,children:"ביטול"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:55,columnNumber:11},void 0),e.jsxDEV(A,{variant:"outline",onClick:async()=>{await r(),i()},children:"שבוע זה בלבד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:58,columnNumber:11},void 0),e.jsxDEV(En,{onClick:async()=>{await a(),i()},children:"כל השבועות העתידיים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:67,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:54,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:47,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/DeleteAssignmentDialog.tsx",lineNumber:46,columnNumber:5},void 0):(pn.useEffect(()=>{n&&(async()=>(await r(),i()))()},[n,r,i]),null),xa=({slot:n,slotAssignments:i,onAssign:r,onDeleteAssignment:a})=>{const[m,s]=t.useState(!1),[o,h]=t.useState(null),d=Li(n.show_name,n.host_name),j={};i.forEach(x=>{const E=x.role||"ללא תפקיד";j[E]||(j[E]=[]),j[E].push(x)});const b=(x,E)=>{E.stopPropagation(),h(x),s(!0)},v=async()=>{o&&(await a(o.id,"current"),s(!1),h(null))},N=async()=>{o&&(await a(o.id,"future"),s(!1),h(null))};return e.jsxDEV("div",{className:"mb-3 border rounded p-2 bg-gray-50",children:[e.jsxDEV("div",{className:"cursor-pointer",onClick:()=>r(n),children:[e.jsxDEV("div",{className:"font-medium text-sm",children:d},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:65,columnNumber:9},void 0),i.length>0&&e.jsxDEV("div",{className:"mt-2 text-sm border-t pt-2",children:Object.entries(j).map(([x,E])=>e.jsxDEV("div",{className:"mb-1",children:[e.jsxDEV("span",{className:"font-medium",children:[x,": "]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:74,columnNumber:17},void 0),e.jsxDEV("div",{className:"space-y-1",children:E.map(S=>e.jsxDEV("div",{className:"flex justify-between items-center bg-white p-1 rounded",children:[e.jsxDEV("span",{children:S.worker?.name||"עובד לא ידוע"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:78,columnNumber:23},void 0),e.jsxDEV(A,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:g=>b(S,g),children:"✕"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:79,columnNumber:23},void 0)]},`assignment-${S.id}`,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:77,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:75,columnNumber:17},void 0)]},`role-${x}-${n.id}`,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:73,columnNumber:15},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:70,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:61,columnNumber:7},void 0),o&&e.jsxDEV(ba,{isOpen:m,onClose:()=>{s(!1),h(null)},onDeleteCurrentWeek:v,onDeleteAllFuture:N,isRecurring:o.is_recurring||!1},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:98,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/components/SlotAssignments.tsx",lineNumber:60,columnNumber:5},void 0)},va=({currentWeek:n,roles:i,slotsByDayAndTime:r,onSuccess:a,assignments:m,currentSlot:s,producerForms:o,visibleWorkerCount:h,selectedDays:d,isPermanent:j,onClose:b,producers:v})=>{const[N,x]=t.useState(!1),{toast:E}=De(),{saveScrollPosition:S,setIsScrollLocked:g}=wr(),u=async()=>{if(!s){E({title:"שגיאה",description:"לא נמצאה תוכנית",variant:"destructive"});return}g(!0),x(!0),S();const T=o.slice(0,h).filter(l=>l.workerId&&l.role);if(T.length===0){E({title:"שגיאה",description:"יש לבחור לפחות מפיק אחד",variant:"destructive"}),g(!1),x(!1);return}try{let l=0;const c=[],k=n.toISOString();for(const f of T){const F=i.find(_=>_.id===f.role),P=F?F.name:"",O=v.find(_=>_.id===f.workerId)||{id:f.workerId,name:"עובד לא ידוע",position:null,email:null};if(j)try{const _=d.length>0?d:[s.day_of_week];for(const y of _){const L=s.start_time,w=`${y}-${L}`,q=r[w]||[];if(q.length!==0)for(const z of q){if(!z||!z.id)continue;const I=new Date(n),B=I.getDay(),fe=y-B;I.setDate(I.getDate()+fe);const Se=I.toISOString().split("T")[0];if(await Pi(z.id,f.workerId,P,Se,z.day_of_week,z.start_time,z.show_name)){const Ue={id:`temp-${Date.now()}-${Math.random()}`,slot_id:z.id,worker_id:f.workerId,role:P,week_start:Se,is_recurring:!0,notes:f.additionalText||null,created_at:new Date().toISOString(),worker:O,slot:z};c.push(Ue),l++}}}}catch(_){console.error("Error creating permanent assignment:",_)}else if(d.length>0){if(d.includes(s.day_of_week)){const L=await R(s.id,f.workerId,P,k,f.additionalText,O,s);L&&(c.push(L),l++)}const _=s.start_time,y=d.filter(L=>L!==s.day_of_week);for(const L of y){const w=`${L}-${_}`,q=r[w]||[];for(const z of q){if(!z||!z.id)continue;const I=await R(z.id,f.workerId,P,k,f.additionalText,O,z);I&&(c.push(I),l++)}}}else{const _=await R(s.id,f.workerId,P,k,f.additionalText,O,s);_&&(c.push(_),l++)}}c.length>0?(E({title:"נוסף בהצלחה",description:`נוספו ${c.length} שיבוצים לסידור העבודה`}),b(),a(c)):E({title:"מידע",description:"לא נוספו שיבוצים חדשים. ייתכן שהם כבר קיימים במערכת."})}catch(l){console.error("Error assigning producers:",l),E({title:"שגיאה",description:l.message||"אירעה שגיאה בהוספת העובדים לסידור",variant:"destructive"})}finally{g(!1),x(!1)}},R=async(V,T,l,c,k,f,F)=>{try{const P={slot_id:V,worker_id:T,role:l,week_start:c,is_recurring:!1,notes:k||void 0,day_of_week:F?.day_of_week,start_time:F?.start_time,show_name:F?.show_name,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},O=await Ci(P);if(O&&f&&F){const _=O;return _.worker=f,_.slot=F,_}return O}catch(P){return console.error("Error creating producer assignment:",P),null}};return{handleSubmit:u,isSubmitting:N}},Ea=({currentWeek:n,roles:i,slotsByDayAndTime:r,onSuccess:a,assignments:m,producers:s})=>{const[o,h]=t.useState(!1),[d,j]=t.useState(null),[b,v]=t.useState([{workerId:"",role:"",additionalText:""}]),[N,x]=t.useState(1),[E,S]=t.useState([]),[g,u]=t.useState(!1),{setIsScrollLocked:R}=wr();t.useEffect(()=>{o||V()},[o]);const V=()=>{const y=i.find(w=>w.name==="עריכה"),L=i.find(w=>w.name==="הפקה");v([{workerId:"",role:y?.id||"",additionalText:""},{workerId:"",role:L?.id||"",additionalText:""}]),x(2),S([]),u(!1),j(null)},T=(y,L,w)=>{v(q=>{const z=[...q];return z[y]={...z[y],[L]:w},z})},l=()=>{x(y=>y+1),v(y=>[...y,{workerId:"",role:"",additionalText:""}])},c=y=>{N>1&&(x(L=>L-1),v(L=>{const w=[...L];return w.splice(y,1),w}))},k=y=>{S(L=>y===-1?[]:L.includes(y)?L.filter(w=>w!==y):[...L,y])},f=async y=>{try{const L=mn(yn(n,1),{weekStartsOn:0}),w=re(L,"yyyy-MM-dd");console.log("getLastWeekAssignments: Looking for slot:",{slotId:y.id,dayOfWeek:y.day_of_week,startTime:y.start_time,showName:y.show_name,lastWeekFormatted:w,currentWeek:n,lastWeek:L});const{data:q,error:z}=await G.query("/producer-assignments",{where:{week_start:w,is_deleted:!1}});let I=q||[];if(I.length===0){console.log("getLastWeekAssignments: No assignments found for exact week, trying broader range");const X=re(yn(L,1),"yyyy-MM-dd"),M=re(Dn(L,1),"yyyy-MM-dd"),{data:ye,error:K}=await G.query("/producer-assignments",{where:{week_start:{gte:X,lte:M},is_deleted:!1}});!K&&ye&&(I=ye,console.log("getLastWeekAssignments: Found assignments in broader range:",I.length))}if(z)return console.error("Error fetching last week assignments:",z),[];console.log("getLastWeekAssignments: Found assignments:",I?.length||0),console.log("getLastWeekAssignments: All assignments:",I),(I||[]).forEach((X,M)=>{console.log(`getLastWeekAssignments: Assignment ${M}:`,{id:X.id,is_recurring:X.is_recurring,slot_id:X.slot_id,worker_id:X.worker_id,role:X.role,week_start:X.week_start,allKeys:Object.keys(X)})});let{data:B,error:ne}=await G.query("/schedule/slots",{isMasterSchedule:!0});if(!ne&&B){const X="a615c306-0650-4f7b-b856-d7ffbc7ba71e";if(!B.some(ye=>ye.id===X)){console.log("getLastWeekAssignments: Slot not found in master schedule, trying specific week");const{data:ye,error:K}=await G.query("/schedule/slots",{selectedDate:w,isMasterSchedule:!1});!K&&ye&&(B=ye,console.log("getLastWeekAssignments: Found week-specific slots:",ye.length))}}if(ne)return console.error("Error fetching slots:",ne),[];console.log("getLastWeekAssignments: Found slots:",B?.length||0);const fe={};(B||[]).forEach(X=>{fe[X.id]=X}),console.log("getLastWeekAssignments: Slots map created with",Object.keys(fe).length,"slots"),console.log("getLastWeekAssignments: Looking for slot ID:","a615c306-0650-4f7b-b856-d7ffbc7ba71e"),console.log("getLastWeekAssignments: Slot exists in map:",!!fe["a615c306-0650-4f7b-b856-d7ffbc7ba71e"]);const Se=Object.keys(fe).slice(0,5);console.log("getLastWeekAssignments: Sample slot IDs:",Se);const ze=Object.values(fe).filter(X=>X.day_of_week===X.day_of_week&&X.start_time===X.start_time&&X.show_name===X.show_name);console.log("getLastWeekAssignments: Slots matching target characteristics:",ze.length);const Ue=(I||[]).filter(X=>{if(console.log("getLastWeekAssignments: Checking assignment:",{assignmentId:X.id,isRecurring:X.is_recurring,slotId:X.slot_id,workerId:X.worker_id,role:X.role}),X.is_recurring){const M=X.day_of_week===y.day_of_week&&X.start_time===y.start_time&&X.show_name===y.show_name;return console.log("getLastWeekAssignments: Checking recurring assignment:",{assignmentDay:X.day_of_week,assignmentTime:X.start_time,assignmentShow:X.show_name,targetDay:y.day_of_week,targetTime:y.start_time,targetShow:y.show_name,matches:M}),M}else if(X.slot_id&&fe[X.slot_id]){const M=fe[X.slot_id],ye=M.day_of_week===y.day_of_week&&M.start_time===y.start_time&&M.show_name===y.show_name;return console.log("getLastWeekAssignments: Checking non-recurring assignment by slot_id:",{assignmentSlotId:X.slot_id,slotDetails:M,targetDay:y.day_of_week,targetTime:y.start_time,targetShow:y.show_name,slotMatches:ye}),ye}else if(X.day_of_week!==void 0&&X.start_time!==void 0&&X.show_name!==void 0){const M=X.day_of_week===y.day_of_week&&X.start_time===y.start_time&&X.show_name===y.show_name;return console.log("getLastWeekAssignments: Checking non-recurring assignment by characteristics:",{assignmentDay:X.day_of_week,assignmentTime:X.start_time,assignmentShow:X.show_name,targetDay:y.day_of_week,targetTime:y.start_time,targetShow:y.show_name,matches:M}),M}else console.log("getLastWeekAssignments: Assignment has no slot_id or slot not found:",{assignmentId:X.id,slotId:X.slot_id,slotExists:X.slot_id?!!fe[X.slot_id]:!1});return!1});return console.log("getLastWeekAssignments: Matching assignments found:",Ue.length),Ue}catch(L){return console.error("Error fetching last week assignments:",L),[]}},F=async(y,L)=>{if(R(!0),h(!0),j(y),L&&L.length>0){const w=L.map(z=>{const I=i.find(ne=>ne.name===z.role),B=I?I.id:"";return{workerId:z.worker_id,role:B,additionalText:z.notes||""}});v(w),x(w.length);const q=L.some(z=>z.is_recurring);u(q)}else{const w=await f(y);if(w.length>0){const q=w.map(z=>{const I=i.find(ne=>ne.name===z.role),B=I?I.id:"";return{workerId:z.worker_id,role:B,additionalText:z.notes||""}});v(q),x(q.length),u(!1)}else{const q=i.find(I=>I.name==="עריכה"),z=i.find(I=>I.name==="הפקה");v([{workerId:"",role:q?.id||"",additionalText:""},{workerId:"",role:z?.id||"",additionalText:""}]),x(2),u(!1)}}},P=()=>{h(!1),R(!1)},{handleSubmit:O,isSubmitting:_}=va({currentWeek:n,roles:i,slotsByDayAndTime:r,onSuccess:a,assignments:m,currentSlot:d,producerForms:b,visibleWorkerCount:N,selectedDays:E,isPermanent:g,onClose:()=>h(!1),producers:s});return{isDialogOpen:o,setIsDialogOpen:h,currentSlot:d,producerForms:b,updateProducerForm:T,visibleWorkerCount:N,addWorkerForm:l,removeWorkerForm:c,selectedDays:E,toggleDay:k,isPermanent:g,setIsPermanent:u,handleAssignProducer:F,handleSubmit:O,handleCloseDialog:P,isSubmitting:_}},Da=({currentWeek:n,onAssignmentChange:i,refreshTrigger:r=0,initialProducers:a})=>{const{slots:m,loading:s}=ii(n,!1),[o,h]=t.useState([]),[d,j]=t.useState([]),[b,v]=t.useState([]),[N,x]=t.useState(!0),{saveScrollPosition:E,restoreScrollPosition:S,setIsScrollLocked:g}=wr(),[u,R]=t.useState(void 0);t.useEffect(()=>{const K=localStorage.getItem("producer-division-id");K&&R(K)},[]);const{toast:V}=De(),T={},l={};m&&Array.isArray(m)&&m.forEach(K=>{const ce=K.day_of_week,je=K.start_time,We=`${ce}-${je}`,we=`${ce}-${je}-${K.show_name}-${K.host_name}`;l[we]||(l[we]=!0,T[We]||(T[We]=[]),T[We].push(K))}),t.useEffect(()=>{E(),c()},[n,r,u]);const c=async()=>{x(!0);try{const K=mn(n,{weekStartsOn:0}),ce=re(K,"yyyy-MM-dd"),je=await Ii(K);h(je);const we=(await G.query("/producer-roles",{order:{display_order:"asc"}})).data||[];if(v(we),a&&a.length>0)j(a);else{const se=(await G.query("/workers",{where:{or:[{"department ILIKE":"%מפיקים%"},{"department ILIKE":"%מפיק%"},{"department ILIKE":"%הפקה%"},{"department ILIKE":"%producers%"},{"department ILIKE":"%Production staff%"}]}})).data||[];j(se),se.length||V({title:"שים לב",description:"לא נמצאו מפיקים במערכת. ייתכן שיש בעיה בהגדרות המחלקה",variant:"default"})}}catch(K){console.error("Error loading data:",K),V({title:"שגיאה",description:"שגיאה בטעינת נתוני הסידור",variant:"destructive"})}finally{x(!1),setTimeout(()=>{S()},50)}};t.useCallback((K,ce)=>ce.day_of_week===5&&(ce.start_time==="06:00:00"&&ce.show_name==="למבוגרים בלבד"||ce.start_time==="07:00:00"&&ce.show_name==="התוכנית החברתית")?K.role==="עריכה"||K.role==="הפקה":!1,[]);const k=t.useCallback(K=>{const ce=m?.find(se=>se.id===K);if(!ce)return console.log(`getAssignmentsForSlot: Slot ${K} not found in scheduleSlots`),[];const je=o.filter(se=>se.slot_id===K),We=o.filter(se=>se.is_recurring?se.day_of_week===ce.day_of_week&&se.start_time===ce.start_time&&se.show_name===ce.show_name:!1),we=o.filter(se=>se.is_recurring?!1:se.day_of_week===ce.day_of_week&&se.start_time===ce.start_time&&se.show_name===ce.show_name&&!je.some(W=>W.id===se.id)),ve=[...je];return We.forEach(se=>{ve.some(D=>D.id===se.id)||ve.push(se)}),we.forEach(se=>{ve.some(D=>D.id===se.id)||ve.push(se)}),ve},[o,m]),f=async(K,ce="current")=>{E(),g(!0);try{if(!o.find(se=>se.id===K))throw new Error("Assignment not found");const We=mn(n,{weekStartsOn:0}),we=re(We,"yyyy-MM-dd"),ve=await Ui(K,ce,we);if(ve&&ve.success)V({title:"נמחק בהצלחה",description:ve.message||(ce==="future"?"השיבוץ נמחק מכל השבועות העתידיים":"השיבוץ נמחק משבוע זה בלבד")}),ce==="current"?h(se=>se.filter(D=>D.id!==K)):c(),i&&i();else throw new Error("Failed to delete assignment")}catch(je){console.error("Error deleting assignment:",je),V({title:"שגיאה",description:"אירעה שגיאה במחיקת השיבוץ",variant:"destructive"})}finally{g(!1)}},F=t.useCallback(K=>{if(K.length===0)return;K.some(je=>je.is_recurring)?c():h(je=>[...je.filter(we=>!K.some(ve=>ve.slot_id===we.slot_id&&ve.worker_id===we.worker_id&&ve.role===we.role)),...K]),i&&i()},[i,c]),{isDialogOpen:P,setIsDialogOpen:O,currentSlot:_,producerForms:y,updateProducerForm:L,visibleWorkerCount:w,addWorkerForm:q,removeWorkerForm:z,selectedDays:I,toggleDay:B,isPermanent:ne,setIsPermanent:fe,handleAssignProducer:Se,handleSubmit:ze,handleCloseDialog:Ue,isSubmitting:X}=Ea({currentWeek:n,roles:b,slotsByDayAndTime:T,onSuccess:F,assignments:o,producers:d}),M=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],ye=m&&Array.isArray(m)?[...new Set(m.map(K=>K.start_time))].sort():[];return N||s?e.jsxDEV("div",{className:"text-center py-4",children:"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:357,columnNumber:12},void 0):e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"סידור שבועי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:362,columnNumber:7},void 0),!d||d.length===0?e.jsxDEV(Le,{children:[e.jsxDEV(Xn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:366,columnNumber:11},void 0),e.jsxDEV(Xe,{children:"שים לב"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:367,columnNumber:11},void 0),e.jsxDEV(Pe,{children:"לא נמצאו מפיקים במערכת. ייתכן שיש בעיה בהגדרות המחלקה."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:368,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:365,columnNumber:9},void 0):null,e.jsxDEV(Q,{className:"mb-4",children:[e.jsxDEV("div",{className:"p-2 font-bold border-b bg-slate-100",children:["שבוע ",re(n,"dd/MM/yyyy",{locale:Ce})," - ",re(Zn(n,6),"dd/MM/yyyy",{locale:Ce})]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:375,columnNumber:9},void 0),e.jsxDEV("div",{className:"overflow-x-auto",children:e.jsxDEV(Ze,{dir:"rtl",children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{className:"min-w-[150px]",children:"משבצת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:382,columnNumber:17},void 0),[0,1,2,3,4,5,6].map(K=>e.jsxDEV(ee,{className:"text-center min-w-[150px]",children:[M[K],e.jsxDEV("div",{className:"text-xs font-normal",children:re(Zn(n,K),"dd/MM",{locale:Ce})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:387,columnNumber:21},void 0)]},`day-header-${K}`,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:385,columnNumber:19},void 0))]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:381,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:380,columnNumber:13},void 0),e.jsxDEV(en,{children:ye.map((K,ce)=>e.jsxDEV(he,{children:[e.jsxDEV(Z,{className:"font-medium",children:K},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:397,columnNumber:19},void 0),[0,1,2,3,4,5,6].map(je=>{const We=`${je}-${K}`,we=T[We]||[];return e.jsxDEV(Z,{className:"p-2 align-top cursor-pointer hover:bg-gray-50",children:we.length>0?e.jsxDEV("div",{children:we.map((ve,se)=>{const D=k(ve.id);return e.jsxDEV(xa,{slot:ve,slotAssignments:D,onAssign:async W=>{await Se(W,D)},onDeleteAssignment:f},`slot-${ve.id}-${K}-${se}`,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:414,columnNumber:33},void 0)})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:409,columnNumber:27},void 0):e.jsxDEV("div",{className:"text-center text-gray-400 text-xs",children:"אין תוכניות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:427,columnNumber:27},void 0)},`cell-${je}-${K}-${ce}`,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:404,columnNumber:23},void 0)})]},`time-row-${K}-${ce}`,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:396,columnNumber:17},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:394,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:379,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:378,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:374,columnNumber:7},void 0),e.jsxDEV(Wi,{isOpen:P,onOpenChange:K=>{E(),O(K)},currentSlot:_,producerForms:y,updateProducerForm:L,visibleWorkerCount:w,addWorkerForm:q,removeWorkerForm:z,selectedDays:I,toggleDay:B,isPermanent:ne,setIsPermanent:fe,handleSubmit:ze,handleCloseDialog:Ue,producers:d,roles:b,currentWeek:n,isSubmitting:X},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:441,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/WeeklyAssignments.tsx",lineNumber:361,columnNumber:5},void 0)},Sa=()=>{const{toast:n}=De(),[i,r]=t.useState(new Date().getFullYear()),[a,m]=t.useState(new Date().getMonth()+1),[s,o]=t.useState([]),[h,d]=t.useState([]),[j,b]=t.useState(!0);t.useEffect(()=>{v()},[i,a]);const v=async()=>{b(!0);try{const[V,T]=await Promise.all([Oi(i,a),Zt()]);o(V),d(T)}catch(V){console.error("Error loading monthly summary data:",V),n({title:"שגיאה",description:"שגיאה בטעינת נתוני הסיכום החודשי",variant:"destructive"})}finally{b(!1)}},N=()=>{const V={};return Array.isArray(h)&&h.forEach(T=>{V[T.id]={producer:T,roles:{}}}),Array.isArray(s)&&s.forEach(T=>{V[T.worker_id]&&(V[T.worker_id].roles[T.role]||(V[T.worker_id].roles[T.role]=0),V[T.worker_id].roles[T.role]++)}),Object.values(V)},x=()=>{const V=new Set;return Array.isArray(s)&&s.forEach(T=>{V.add(T.role)}),Array.from(V)},E=()=>{try{const V=N();let l="שם עובד,תפקיד,"+x().join(",")+`,סה"כ
`;V.forEach(({producer:F,roles:P})=>{if(Object.keys(P).length===0)return;const O=Object.values(P).reduce((y,L)=>y+L,0),_=x().map(y=>P[y]||0);l+=`${F.name},${F.position||""},${_.join(",")},${O}
`});const c=new Blob([l],{type:"text/csv;charset=utf-8;"}),k=document.createElement("a"),f=URL.createObjectURL(c);k.setAttribute("href",f),k.setAttribute("download",`סיכום-חודשי-הפקה-${a}-${i}.csv`),k.style.visibility="hidden",document.body.appendChild(k),k.click(),document.body.removeChild(k),n({title:"הקובץ הורד בהצלחה",description:`סיכום חודשי לחודש ${a}/${i} הורד בהצלחה`})}catch(V){console.error("Error exporting CSV:",V),n({title:"שגיאה",description:"שגיאה בייצוא הקובץ",variant:"destructive"})}},S=Array.from({length:5},(V,T)=>new Date().getFullYear()-2+T),g=[{value:1,label:"ינואר"},{value:2,label:"פברואר"},{value:3,label:"מרץ"},{value:4,label:"אפריל"},{value:5,label:"מאי"},{value:6,label:"יוני"},{value:7,label:"יולי"},{value:8,label:"אוגוסט"},{value:9,label:"ספטמבר"},{value:10,label:"אוקטובר"},{value:11,label:"נובמבר"},{value:12,label:"דצמבר"}],u=N(),R=x();return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"flex justify-between items-center",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"סיכום חודשי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:156,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex space-x-4 space-x-reverse",children:[e.jsxDEV("div",{className:"w-32",children:e.jsxDEV(Nn,{value:a.toString(),onValueChange:V=>m(parseInt(V)),children:[e.jsxDEV(gn,{children:e.jsxDEV(hn,{placeholder:"חודש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:165,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:164,columnNumber:15},void 0),e.jsxDEV(bn,{children:g.map(V=>e.jsxDEV(xn,{value:V.value.toString(),children:V.label},V.value,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:169,columnNumber:19},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:167,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:160,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:159,columnNumber:11},void 0),e.jsxDEV("div",{className:"w-24",children:e.jsxDEV(Nn,{value:i.toString(),onValueChange:V=>r(parseInt(V)),children:[e.jsxDEV(gn,{children:e.jsxDEV(hn,{placeholder:"שנה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:183,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:182,columnNumber:15},void 0),e.jsxDEV(bn,{children:S.map(V=>e.jsxDEV(xn,{value:V.toString(),children:V},V,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:187,columnNumber:19},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:185,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:178,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:177,columnNumber:11},void 0),e.jsxDEV(A,{onClick:E,children:[e.jsxDEV(tr,{className:"ml-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:196,columnNumber:13},void 0),"ייצוא CSV"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:195,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:158,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:155,columnNumber:7},void 0),j?e.jsxDEV("div",{className:"text-center py-4",children:"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:203,columnNumber:9},void 0):e.jsxDEV(Q,{children:e.jsxDEV(Ze,{children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{children:"שם עובד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:209,columnNumber:17},void 0),e.jsxDEV(ee,{children:"תפקיד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:210,columnNumber:17},void 0),R.map(V=>e.jsxDEV(ee,{children:V},V,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:212,columnNumber:19},void 0)),e.jsxDEV(ee,{children:'סה"כ'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:214,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:208,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:207,columnNumber:13},void 0),e.jsxDEV(en,{children:u.length===0?e.jsxDEV(he,{children:e.jsxDEV(Z,{colSpan:3+R.length,className:"text-center",children:"אין נתונים לחודש זה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:220,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:219,columnNumber:17},void 0):u.filter(V=>Object.keys(V.roles).length>0).sort((V,T)=>V.producer.name.localeCompare(T.producer.name)).map(({producer:V,roles:T})=>{const l=Object.values(T).reduce((c,k)=>c+k,0);return e.jsxDEV(he,{children:[e.jsxDEV(Z,{className:"font-medium",children:V.name},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:231,columnNumber:25},void 0),e.jsxDEV(Z,{children:V.position||"-"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:232,columnNumber:25},void 0),R.map(c=>e.jsxDEV(Z,{children:T[c]||0},c,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:235,columnNumber:27},void 0)),e.jsxDEV(Z,{className:"font-bold",children:l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:238,columnNumber:25},void 0)]},V.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:230,columnNumber:23},void 0)})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:217,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:206,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:205,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/MonthlySummary.tsx",lineNumber:154,columnNumber:5},void 0)},ja=()=>{const[n,i]=t.useState(mn(new Date,{weekStartsOn:0})),[r,a]=t.useState("weekly"),[m,s]=t.useState(""),[o,h]=t.useState(null),[d,j]=t.useState(!1),[b,v]=t.useState(0),[N,x]=t.useState([]),{toast:E}=De();t.useEffect(()=>{(async()=>{try{const c=localStorage.getItem("producer-division-id");if(c){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(c))return;localStorage.removeItem("producer-division-id")}const f=(await ri()).find(F=>F.name.toLowerCase()==="producers"||F.name.toLowerCase()==="מפיקים"||F.name.toLowerCase()==="עורכים ומפיקים"||F.name.toLowerCase()==="הפקה"||F.name.toLowerCase()==="מפיק"||F.name.toLowerCase()==="production staff");f&&localStorage.setItem("producer-division-id",f.id)}catch(c){console.error("Error ensuring producer division ID:",c)}})()},[]),t.useEffect(()=>{S()},[n]);const S=async()=>{j(!0);try{const l=await Qt(n);l&&(s(l.notes||""),h(l.id))}catch(l){console.error("Error loading work arrangement:",l),E({title:"שגיאה",description:"לא ניתן לטעון את סידור העבודה",variant:"destructive"})}finally{j(!1)}},g=async()=>{if(o)try{await ea(o,m),E({title:"נשמר בהצלחה",description:"הערות סידור העבודה נשמרו בהצלחה"})}catch(l){console.error("Error saving notes:",l),E({title:"שגיאה",description:"לא ניתן לשמור את ההערות",variant:"destructive"})}},u=l=>{const c=l==="prev"?yn(n,1):Dn(n,1);i(c)},R=()=>{localStorage.removeItem("producer-division-id"),localStorage.removeItem("divisions-cache"),localStorage.removeItem("producers-list"),localStorage.removeItem("producer-roles");const l=localStorage.getItem("producer-division-id");l&&localStorage.removeItem(`producers-by-division-${l}`),sessionStorage.removeItem("all-worker-divisions"),v(c=>c+1),E({title:"רענון נתונים",description:"הנתונים מתעדכנים מהשרת..."})},V=()=>{},T=`${re(n,"dd/MM/yyyy",{locale:Ce})} - ${re(Zn(n,6),"dd/MM/yyyy",{locale:Ce})}`;return t.useEffect(()=>{(async()=>{try{const c=await G.query("/workers",{where:{or:[{"department ILIKE":"%מפיקים%"},{"department ILIKE":"%מפיק%"},{"department ILIKE":"%הפקה%"},{"department ILIKE":"%producers%"},{"department ILIKE":"%Production staff%"}]}});x(c.data||[])}catch(c){console.error("Error loading producers:",c),E({title:"שגיאה",description:"לא ניתן לטעון את רשימת המפיקים",variant:"destructive"})}})()},[E]),e.jsxDEV("div",{className:"space-y-4",dir:"rtl",children:e.jsxDEV(Q,{children:[e.jsxDEV(me,{className:"flex flex-row items-center justify-between",children:[e.jsxDEV(le,{children:"סידור עבודה - הפקה ועריכה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:178,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(A,{variant:"outline",size:"icon",onClick:()=>u("prev"),children:e.jsxDEV(rr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:185,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:180,columnNumber:13},void 0),e.jsxDEV("div",{className:"px-2 py-1 border rounded flex items-center min-w-[200px] justify-center",children:[e.jsxDEV(jn,{className:"ml-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:188,columnNumber:15},void 0),e.jsxDEV("span",{children:T},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:189,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:187,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",size:"icon",onClick:()=>u("next"),children:e.jsxDEV(ir,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:196,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:191,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",size:"icon",onClick:R,title:"רענן נתונים",children:e.jsxDEV(Me,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:204,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:198,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:179,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:177,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV(Qn,{defaultValue:"weekly",value:r,onValueChange:a,className:"space-y-4",children:[e.jsxDEV(er,{className:"grid w-full grid-cols-2",children:[e.jsxDEV(on,{value:"weekly",children:"סידור שבועי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:216,columnNumber:15},void 0),e.jsxDEV(on,{value:"monthly",children:"סיכום חודשי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:217,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:215,columnNumber:13},void 0),e.jsxDEV(sn,{value:"weekly",children:e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"הערות לסידור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:223,columnNumber:19},void 0),e.jsxDEV(Mn,{placeholder:"הערות כלליות לסידור העבודה",value:m,onChange:l=>s(l.target.value),rows:3,className:"text-right"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:224,columnNumber:19},void 0),e.jsxDEV(A,{onClick:g,disabled:d,children:"שמור הערות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:231,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:222,columnNumber:17},void 0),e.jsxDEV(Da,{currentWeek:n,onAssignmentChange:V,refreshTrigger:b,initialProducers:N},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:235,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:221,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:220,columnNumber:13},void 0),e.jsxDEV(sn,{value:"monthly",children:e.jsxDEV(Sa,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:245,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:244,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:209,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:208,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:176,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/producers/ProducerWorkArrangement.tsx",lineNumber:175,columnNumber:5},void 0)},Va=_r({week_start:Et(),type:li(["producers","engineers","digital"]),pdf_file:vt().refine(n=>n?.length>0,"PDF File is required.").refine(n=>n?.[0]?.size<=2e6,"Max file size is 2MB.").refine(n=>n?.[0]?.type==="application/pdf","Only PDF files are accepted.")});function gr({mode:n="producers"}){const[i,r]=t.useState(null),[a,m]=t.useState(null),[s,o]=t.useState(n==="engineers"?"engineers":n==="digital"?"digital":"producers"),[h,d]=t.useState(mn(new Date,{weekStartsOn:0})),[j,b]=t.useState(null),[v,N]=t.useState(!1),[x,E]=t.useState(null),{toast:S}=De(),[g,u]=t.useState({current:"",next:"",previous:""}),R=Fr({resolver:Rr(Va),defaultValues:{week_start:h,type:s,pdf_file:null}});t.useEffect(()=>{const _=n==="engineers"?"engineers":n==="digital"?"digital":"producers";o(_),R.setValue("type",_)},[n]),t.useEffect(()=>{R.setValue("type",s)},[s]),t.useEffect(()=>{V(h)},[h]);const V=_=>{const y=mn(_,{weekStartsOn:0}),L=Dn(y,1),w=yn(y,1);u({current:`/schedule/${re(y,"yyyy-MM-dd")}`,next:`/schedule/${re(L,"yyyy-MM-dd")}`,previous:`/schedule/${re(w,"yyyy-MM-dd")}`})},T=_=>{const y=_==="prev"?yn(h,1):Dn(h,1);d(y),R.setValue("week_start",y)};function l(_){const y=_.pdf_file[0];c(y)}const c=async _=>{try{const y=re(h,"yyyy-MM-dd");console.log("Attempting to upload file using new storage system");const L=await Bi.uploadFile(_,"work-arrangements");console.log("File uploaded successfully:",L),r(L.path),m(L.filename);const{error:w}=await G.mutate("/work-arrangements",{filename:L.originalName,url:L.path,type:s,week_start:y});w?(console.error("Error saving file info to database:",w),S({title:"Warning",description:`File uploaded, but failed to save information to database: ${w.message}`,variant:"destructive"})):S({title:"Success",description:"File uploaded and saved successfully."})}catch(y){console.error("Error during file upload:",y),S({title:"Error",description:y.message||"An unexpected error occurred during file upload.",variant:"destructive"})}},k=t.useCallback(_=>{_.preventDefault(),N(!0)},[]),f=t.useCallback(_=>{_.preventDefault(),N(!1)},[]),F=t.useCallback(_=>{_.preventDefault(),N(!1);const L=Array.from(_.dataTransfer.files).find(w=>w.type==="application/pdf");L?(E(L),R.setValue("pdf_file",[L]),S({title:"File selected",description:`Selected: ${L.name}`})):S({title:"Invalid file",description:"Please select a PDF file",variant:"destructive"})},[R,S]),P=t.useCallback(_=>{const y=_.target.files;if(y&&y.length>0){const L=y[0];L.type==="application/pdf"?(E(L),R.setValue("pdf_file",[L]),S({title:"File selected",description:`Selected: ${L.name}`})):S({title:"Invalid file",description:"Please select a PDF file",variant:"destructive"})}},[R,S]),O=()=>e.jsxDEV(Q,{children:e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"העלאת קובץ PDF"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:227,columnNumber:9},this),e.jsxDEV(ie,{children:e.jsxDEV(Mr,{...R,children:e.jsxDEV("form",{onSubmit:R.handleSubmit(l),className:"space-y-8",children:[e.jsxDEV(Ae,{control:R.control,name:"week_start",render:({field:_})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"בחר שבוע"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:233,columnNumber:19},this),e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(A,{type:"button",variant:"outline",size:"icon",onClick:()=>T("prev"),children:e.jsxDEV(rr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:236,columnNumber:23},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:235,columnNumber:21},this),e.jsxDEV(A,{variant:"outline",className:"w-[240px] justify-start text-left font-normal bg-white border",children:[e.jsxDEV(jn,{className:"ml-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:239,columnNumber:23},this),re(h,"dd/MM/yyyy")+" - "+re(Dn(h,1),"dd/MM/yyyy")]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:238,columnNumber:21},this),e.jsxDEV(A,{type:"button",variant:"outline",size:"icon",onClick:()=>T("next"),children:e.jsxDEV(ir,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:243,columnNumber:23},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:242,columnNumber:21},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:234,columnNumber:19},this),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:246,columnNumber:19},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:232,columnNumber:17},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:231,columnNumber:15},this),e.jsxDEV(Ae,{control:R.control,name:"type",render:({field:_})=>e.jsxDEV(Te,{className:"hidden",children:e.jsxDEV(Re,{children:e.jsxDEV($,{type:"hidden",value:"engineers",readOnly:!0},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:254,columnNumber:21},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:253,columnNumber:19},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:252,columnNumber:17},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:251,columnNumber:15},this),e.jsxDEV(Ae,{control:R.control,name:"pdf_file",render:({field:_})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"קובץ PDF"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:261,columnNumber:19},this),e.jsxDEV(Re,{children:e.jsxDEV("div",{className:Ee("border-2 border-dashed rounded-lg p-8 text-center transition-colors",v?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400",x?"border-green-500 bg-green-50":""),onDragOver:k,onDragLeave:f,onDrop:F,children:e.jsxDEV("div",{className:"flex flex-col items-center space-y-4",children:x?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Vn,{className:"h-12 w-12 text-green-500"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:278,columnNumber:29},this),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm font-medium text-green-600",children:x.name},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:280,columnNumber:31},this),e.jsxDEV("p",{className:"text-xs text-gray-500",children:[(x.size/1024/1024).toFixed(2)," MB"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:281,columnNumber:31},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:279,columnNumber:29},this),e.jsxDEV(A,{type:"button",variant:"outline",size:"sm",onClick:()=>{E(null),R.setValue("pdf_file",null)},children:"החלף קובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:285,columnNumber:29},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:277,columnNumber:27},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Tn,{className:"h-12 w-12 text-gray-400"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:299,columnNumber:29},this),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm font-medium text-gray-600",children:"גרור קובץ PDF לכאן או לחץ לבחירה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:301,columnNumber:31},this),e.jsxDEV("p",{className:"text-xs text-gray-500",children:"רק קבצי PDF עד 2MB"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:304,columnNumber:31},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:300,columnNumber:29},this),e.jsxDEV($,{type:"file",accept:"application/pdf",onChange:P,className:"hidden",id:"file-upload"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:308,columnNumber:29},this),e.jsxDEV(A,{type:"button",variant:"outline",onClick:()=>document.getElementById("file-upload")?.click(),children:"בחר קובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:315,columnNumber:29},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:298,columnNumber:27},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:275,columnNumber:23},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:263,columnNumber:21},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:262,columnNumber:19},this),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:327,columnNumber:19},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:260,columnNumber:17},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:259,columnNumber:15},this),e.jsxDEV(A,{type:"submit",disabled:!x,className:"w-full",children:"העלאה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:331,columnNumber:15},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:230,columnNumber:13},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:229,columnNumber:11},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:228,columnNumber:9},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:226,columnNumber:7},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:225,columnNumber:5},this);return e.jsxDEV("div",{className:"container mx-auto py-10",children:[e.jsxDEV("div",{className:"mb-8",children:e.jsxDEV("h1",{className:"text-3xl font-bold text-center",children:"סידורי עבודה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:348,columnNumber:9},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:347,columnNumber:7},this),e.jsxDEV("div",{className:"py-6",children:[n==="engineers"&&O(),n==="producers"&&e.jsxDEV("div",{className:"py-4",children:e.jsxDEV($i,{children:e.jsxDEV(ja,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:355,columnNumber:15},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:354,columnNumber:13},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:353,columnNumber:11},this),n==="digital"&&e.jsxDEV("div",{className:"py-4",children:e.jsxDEV(ha,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:361,columnNumber:13},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:360,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:350,columnNumber:7},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/WorkArrangements.tsx",lineNumber:346,columnNumber:5},this)}const Lr=t.forwardRef(({className:n,orientation:i="horizontal",decorative:r=!0,...a},m)=>e.jsxDEV(Ni,{ref:m,decorative:r,orientation:i,className:Ee("shrink-0 bg-border",i==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",n),...a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/separator.tsx",lineNumber:14,columnNumber:5},void 0));Lr.displayName=Ni.displayName;const Pr=t.forwardRef(({className:n,...i},r)=>e.jsxDEV(gi,{className:Ee("grid gap-2",n),...i,ref:r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/radio-group.tsx",lineNumber:12,columnNumber:5},void 0));Pr.displayName=gi.displayName;const un=t.forwardRef(({className:n,...i},r)=>e.jsxDEV(hi,{ref:r,className:Ee("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...i,children:e.jsxDEV(qt,{className:"flex items-center justify-center",children:e.jsxDEV(Dt,{className:"h-2.5 w-2.5 fill-current text-current"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/radio-group.tsx",lineNumber:35,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/radio-group.tsx",lineNumber:34,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/radio-group.tsx",lineNumber:26,columnNumber:5},void 0));un.displayName=hi.displayName;const ya=()=>{const{toast:n}=De(),[i]=Tr(),r=i.get("sub")||"recipients",[a,m]=t.useState(!0),[s,o]=t.useState(!1),[h,d]=t.useState(!1),[j,b]=t.useState(!1),[v,N]=t.useState(""),[x,E]=t.useState(""),[S,g]=t.useState(!1),[u,R]=t.useState({id:"",smtp_host:"",smtp_port:587,smtp_user:"",smtp_password:"",sender_email:"",sender_name:"",subject_template:"",body_template:"",email_method:"smtp",gmail_client_id:"",gmail_client_secret:"",gmail_refresh_token:"",gmail_redirect_uri:"",gmail_access_token:"",gmail_token_expiry:"",is_eu_region:!1,mailgun_api_key:"",mailgun_domain:""}),[V,T]=t.useState([]),[l,c]=t.useState(""),[k,f]=t.useState(null),[F,P]=t.useState("yaniv@103.fm"),[O,_]=t.useState(null),[y,L]=t.useState("");t.useEffect(()=>{B(),ne(),fe();const D=i.get("code");D&&(console.log("Found OAuth code in URL:",D),E(D),w(D),window.history.replaceState({},document.title,window.location.pathname))},[i]);const w=async D=>{console.log("Processing Gmail auth code:",D),n({title:"קוד אימות Gmail התקבל",description:"מעבד את הקוד...",variant:"default"});try{if(b(!0),_(null),!u.gmail_redirect_uri||!u.gmail_client_id||!u.gmail_client_secret)throw new Error("חסרות הגדרות חשובות (URI הפניה, מזהה לקוח או סוד לקוח)");const{data:W,error:Ve}=await G.mutate("/email/gmail-auth",{code:D,redirectUri:u.gmail_redirect_uri,clientId:u.gmail_client_id,clientSecret:u.gmail_client_secret},"POST");if(Ve)throw console.error("Error from gmail-auth function:",Ve),Ve;if(console.log("Response from gmail-auth function:",W),W&&W.error)throw new Error(W.error+(W.message?": "+W.message:""));if(W&&W.refreshToken){console.log("Got refresh token from Google");const ln={...u,gmail_refresh_token:W.refreshToken,gmail_access_token:W.accessToken,gmail_token_expiry:W.expiryDate};await I(ln),n({title:"אימות Gmail הושלם בהצלחה",description:"התחברות לחשבון Gmail בוצעה בהצלחה",variant:"default"})}else throw new Error("לא התקבל טוקן רענון מגוגל")}catch(W){console.error("Error processing Gmail auth code:",W),_({stage:"GMAIL_AUTH_CODE",message:W.message||"אירעה שגיאה לא ידועה",details:W}),n({title:"שגיאה בתהליך אימות Gmail",description:W.message||"אירעה שגיאה לא ידועה",variant:"destructive"})}finally{b(!1)}},q=async()=>{if(!v.trim()){n({title:"טוקן ריק",description:"אנא הכנס טוקן תקף",variant:"destructive"});return}try{b(!0),_(null);const{data:D,error:W}=await G.mutate("/email/gmail-auth",{refreshToken:v,clientId:u.gmail_client_id,clientSecret:u.gmail_client_secret},"POST");if(W)throw W;if(D&&D.accessToken){console.log("Successfully validated manual refresh token");const Ve={...u,gmail_refresh_token:v,gmail_access_token:D.accessToken,gmail_token_expiry:D.expiryDate};await I(Ve),N(""),n({title:"טוקן Gmail נשמר בהצלחה",description:"טוקן הגישה נוצר בהצלחה",variant:"default"})}else throw new Error("לא ניתן לאמת את הטוקן שהוזן")}catch(D){console.error("Error processing manual token:",D),_({stage:"MANUAL_TOKEN_VALIDATION",message:D.message||"אירעה שגיאה בעיבוד הטוקן",details:D}),n({title:"שגיאה בעיבוד הטוקן",description:D.message||"אירעה שגיאה בעיבוד הטוקן",variant:"destructive"})}finally{b(!1)}},z=async()=>{if(!x.trim()){n({title:"קוד אימות ריק",description:"אנא הכנס קוד אימות תקף",variant:"destructive"});return}try{await w(x)}catch(D){console.error("Error processing manual code:",D),n({title:"שגיאה בעיבוד קוד האימות",description:D.message||"אירעה שגיאה בעיבוד קוד האימות",variant:"destructive"})}},I=async D=>{try{const{error:W}=await G.mutate("/email/email-settings/tokens",{gmail_refresh_token:D.gmail_refresh_token,gmail_access_token:D.gmail_access_token,gmail_token_expiry:D.gmail_token_expiry},"POST");if(W)throw W;R(D)}catch(W){throw console.error("Error saving Gmail tokens:",W),W}},B=async()=>{try{const{data:D,error:W}=await G.query("/email/email-settings");if(W)throw W;D&&Array.isArray(D.data)&&D.data.length>0&&R(D.data[0])}catch(D){console.error("Error loading email settings:",D),n({title:"שגיאה בטעינת הגדרות דואר אלקטרוני",description:D.message,variant:"destructive"})}finally{m(!1)}},ne=async()=>{try{const{data:D,error:W}=await G.query("/email/email-recipients");if(W)throw W;D&&Array.isArray(D.data)?T(D.data):T([])}catch(D){console.error("Error loading email recipients:",D),n({title:"שגיאה בטעינת רשימת הנמענים",description:D.message,variant:"destructive"})}},fe=async()=>{try{const{data:D,error:W}=await G.query("/shows/latest");if(W)throw W;D&&f(D)}catch(D){console.error("Error loading latest show:",D)}},Se=async()=>{try{o(!0);const{data:D,error:W}=await G.mutate("/email/email-settings",u,"POST");if(W)throw W;n({title:"הגדרות דואר אלקטרוני נשמרו בהצלחה",variant:"default"})}catch(D){console.error("Error saving email settings:",D),n({title:"שגיאה בשמירת הגדרות דואר אלקטרוני",description:D.message,variant:"destructive"})}finally{o(!1)}},ze=async()=>{if(!l||!l.includes("@")||!l.includes(".")){n({title:"כתובת דואר אלקטרוני לא תקינה",description:"אנא הכנס כתובת דואר אלקטרוני תקינה",variant:"destructive"});return}try{const{data:D,error:W}=await G.mutate("/email/email-recipients",{email:l},"POST");if(W)throw W;T([...V,D]),c(""),n({title:"נמען נוסף בהצלחה",variant:"default"})}catch(D){console.error("Error adding email recipient:",D),n({title:"שגיאה בהוספת נמען",description:D.message,variant:"destructive"})}},Ue=async D=>{try{const{data:W,error:Ve}=await G.mutate(`/email/email-recipients/${D}`,{},"DELETE");if(Ve)throw Ve;T(V.filter(ln=>ln.id!==D)),n({title:"נמען הוסר בהצלחה",variant:"default"})}catch(W){console.error("Error removing email recipient:",W),n({title:"שגיאה בהסרת נמען",description:W.message,variant:"destructive"})}},X=async()=>{if(!k){n({title:"לא נמצאה תוכנית לשליחת",description:"אנא צור תוכנית חדשה",variant:"destructive"});return}try{d(!0),_(null),L(""),console.log(`Sending test email for show: ${k.id} to: ${F}`);const{data:D,error:W}=await G.mutate("/email/send-test-email",{showId:k.id,testEmail:F},"POST");if(console.log("Test email response:",D),W)throw console.error("Edge function error:",W),_({stage:"EDGE_FUNCTION_CALL",message:W.message||"Unknown error calling edge function",details:W}),new Error(`Error calling edge function: ${W.message}`);const Ve=JSON.stringify(D,null,2);L(Ve),n({title:"דואר אלקטרוני לדוגמה נשלח בהצלחה",description:`נשלח לכתובת ${F}`,variant:"default"})}catch(D){console.error("Error sending test email:",D),n({title:"שגיאה בשליחת דואר אלקטרוני לדוגמה",description:D.message,variant:"destructive"})}finally{d(!1)}},M=D=>D?.message?.includes("SmtpClientAuthentication is disabled for the Tenant")||D?.response?.includes("SmtpClientAuthentication is disabled"),ye=()=>{if(!u.gmail_client_id||!u.gmail_redirect_uri){n({title:"נדרשת הגדרה של Client ID ו-Redirect URI",description:"יש להגדיר את שדות Client ID ו-Redirect URI לפני חיבור ל-Gmail",variant:"destructive"});return}Se().then(()=>{const W=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${u.gmail_client_id}&redirect_uri=${encodeURIComponent(u.gmail_redirect_uri)}&response_type=code&scope=${encodeURIComponent("https://www.googleapis.com/auth/gmail.send")}&access_type=offline&prompt=consent`;n({title:"פתיחת חלון אימות Gmail",description:"עוקב אחר ההוראות בחלון שנפתח",variant:"default"}),window.open(W,"_blank")})},K=async()=>{if(!u.gmail_refresh_token){n({title:"אין טוקן רענון",description:"יש לבצע אימות ראשוני מול Gmail לפני רענון טוקן",variant:"destructive"});return}try{b(!0),_(null);const{data:D,error:W}=await G.mutate("/email/gmail-auth",{refreshToken:u.gmail_refresh_token,clientId:u.gmail_client_id,clientSecret:u.gmail_client_secret},"POST");if(W)throw W;if(D&&D.accessToken){const Ve={...u,gmail_access_token:D.accessToken,gmail_token_expiry:D.expiryDate};await I(Ve),n({title:"טוקן Gmail רוענן בהצלחה",variant:"default"})}else throw new Error("לא התקבל טוקן גישה חדש")}catch(D){console.error("Error refreshing Gmail token:",D),_({stage:"TOKEN_REFRESH",message:D.message||"אירעה שגיאה לא ידועה",details:D}),n({title:"שגיאה ברענון טוקן Gmail",description:D.message||"אירעה שגיאה לא ידועה",variant:"destructive"})}finally{b(!1)}},ce=D=>{if(!k)return D||"";let W=D||"";const Ve=k.date?new Date(k.date).toLocaleDateString("he-IL"):"";return W=W.replace(/{{show_name}}/g,k.name||""),W=W.replace(/{{show_date}}/g,Ve),W=W.replace(/{{show_time}}/g,k.time||""),W},je=()=>{if(!k)return"";const D=k.date?new Date(k.date).toLocaleDateString("he-IL"):"",W="https://example.com/print";let Ve="<ul style='direction: rtl; text-align: right; padding-right: 20px; margin-right: 0;'>";Ve+="<li style='direction: rtl; text-align: right;'>דוגמה לשם מרואיין, תפקיד</li>",Ve+="<li style='direction: rtl; text-align: right;'>דוגמה לשם מרואיין נוסף</li>",Ve+="</ul>";const ln=`<div style="text-align: center; margin-top: 30px;">
      <a href="${W}" style="display: inline-block; background-color: #5e0e1c; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold;">לצפייה בליינאפ</a>
    </div>`;return(u.body_template||"").replace(/{{show_name}}/g,k.name||"שם התוכנית").replace(/{{show_date}}/g,D).replace(/{{show_time}}/g,k.time||"00:00").replace(/{{interviewees_list}}/g,Ve).replace(/{{lineup_link}}/g,ln)},We=()=>{if(!u.gmail_refresh_token)return{status:"not_authenticated",message:"לא מחובר למערכת Gmail",color:"text-red-500"};if(u.gmail_token_expiry){const D=new Date(u.gmail_token_expiry);return D>new Date?{status:"authenticated",message:`מחובר למערכת Gmail (תוקף עד ${D.toLocaleString("he-IL")})`,color:"text-green-500"}:{status:"expired",message:"טוקן Gmail פג תוקף, יש לרענן",color:"text-amber-500"}}return{status:"unknown",message:"סטטוס חיבור Gmail לא ידוע",color:"text-gray-500"}},we=()=>`${window.location.origin}/google-auth-redirect`;if(a)return e.jsxDEV("div",{className:"flex justify-center items-center p-8",children:"טוען..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:645,columnNumber:12},void 0);const ve=We(),se=je();return e.jsxDEV("div",{className:"space-y-6",children:[r==="recipients"&&e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"רשימת נמענים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:656,columnNumber:15},void 0),e.jsxDEV(xe,{children:"כתובות דואר אלקטרוני אלו יקבלו באופן אוטומטי את ליינאפ התוכנית דקה לאחר תחילתה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:657,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:655,columnNumber:13},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"flex items-center space-x-4 space-between",children:[e.jsxDEV($,{dir:"ltr",className:"flex-grow ml-4",placeholder:"כתובת דואר אלקטרוני חדשה",value:l,onChange:D=>c(D.target.value)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:664,columnNumber:19},void 0),e.jsxDEV(A,{onClick:ze,className:"flex items-center gap-2",children:[e.jsxDEV(Sn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:675,columnNumber:21},void 0),"הוסף נמען"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:671,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:663,columnNumber:17},void 0),e.jsxDEV(Lr,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:680,columnNumber:17},void 0),e.jsxDEV("div",{className:"space-y-4",children:V.length===0?e.jsxDEV("p",{className:"text-center text-muted-foreground",children:"אין נמענים ברשימה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:684,columnNumber:21},void 0):V.map(D=>e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("span",{dir:"ltr",children:D.email},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:688,columnNumber:25},void 0),e.jsxDEV(A,{variant:"ghost",size:"sm",onClick:()=>Ue(D.id),children:e.jsxDEV(St,{className:"h-4 w-4 text-red-500"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:694,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:689,columnNumber:25},void 0)]},D.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:687,columnNumber:23},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:682,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:662,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:661,columnNumber:13},void 0),e.jsxDEV(tn,{className:"flex flex-col gap-4 w-full",children:[e.jsxDEV("div",{className:"flex w-full gap-4 items-center",children:[e.jsxDEV($,{dir:"ltr",value:F,onChange:D=>P(D.target.value),placeholder:"כתובת למשלוח דואר אלקטרוני לדוגמה",className:"flex-grow"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:704,columnNumber:17},void 0),e.jsxDEV(A,{onClick:X,variant:"outline",className:"flex items-center gap-2 whitespace-nowrap",disabled:h,children:[e.jsxDEV(vr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:717,columnNumber:19},void 0),h?"שולח...":"שלח דואר אלקטרוני לדוגמה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:711,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:703,columnNumber:15},void 0),O&&e.jsxDEV(Le,{variant:"destructive",className:"mt-4",children:[e.jsxDEV(cn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:724,columnNumber:19},void 0),e.jsxDEV(Xe,{children:"שגיאה בשליחת דואר אלקטרוני"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:725,columnNumber:19},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("div",{className:"text-sm mt-2",children:[e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"שלב:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:728,columnNumber:26},void 0)," ",O.stage||"לא ידוע"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:728,columnNumber:23},void 0),e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"הודעה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:729,columnNumber:26},void 0)," ",O.message||"לא ידוע"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:729,columnNumber:23},void 0),O.code&&e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"קוד שגיאה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:730,columnNumber:48},void 0)," ",O.code]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:730,columnNumber:45},void 0),O.responseCode&&e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"קוד תגובה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:731,columnNumber:56},void 0)," ",O.responseCode]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:731,columnNumber:53},void 0),O.response&&e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"תגובה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:732,columnNumber:52},void 0)," ",O.response]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:732,columnNumber:49},void 0),O.command&&e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"פקודה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:733,columnNumber:51},void 0)," ",O.command]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:733,columnNumber:48},void 0),M(O)&&e.jsxDEV(Le,{variant:"destructive",className:"mt-4 bg-amber-50",children:[e.jsxDEV(Xe,{className:"text-amber-800",children:"אימות SMTP של Outlook מושבת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:737,columnNumber:27},void 0),e.jsxDEV(Pe,{className:"text-amber-700",children:[e.jsxDEV("p",{className:"mb-2",children:"חשבון ה-Outlook שלך אינו מאפשר אימות SMTP. יש לבצע אחת מהפעולות הבאות:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:739,columnNumber:29},void 0),e.jsxDEV("ol",{className:"list-decimal list-inside space-y-1 mb-2",children:[e.jsxDEV("li",{children:"העל אימות SMTP בחשבון Outlook שלך"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:741,columnNumber:31},void 0),e.jsxDEV("li",{children:"השתמש בשירות דואר אחר כמו Gmail"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:742,columnNumber:31},void 0),e.jsxDEV("li",{children:"השתמש בחשבון Outlook אחר שבו מופעלת האפשרות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:743,columnNumber:31},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:740,columnNumber:29},void 0),e.jsxDEV("a",{href:"https://aka.ms/smtp_auth_disabled",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:underline",children:["למידע נוסף ",e.jsxDEV(jt,{className:"h-3 w-3 ml-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:751,columnNumber:42},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:745,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:738,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:736,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:727,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:726,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:723,columnNumber:17},void 0),y&&!O&&e.jsxDEV(Le,{className:"mt-4",children:[e.jsxDEV(Xe,{children:"תגובה מהשרת (גולמית)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:763,columnNumber:19},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("div",{className:"text-xs mt-2 overflow-auto max-h-40 p-2 bg-gray-100 rounded",children:e.jsxDEV("pre",{dir:"ltr",children:y},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:766,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:765,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:764,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:762,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:702,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:654,columnNumber:11},void 0),r==="settings"&&e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"הגדרות שליחת דואר אלקטרוני"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:777,columnNumber:15},void 0),e.jsxDEV(xe,{children:"בחר את שיטת שליחת הדואר האלקטרוני המועדפת עליך והזן את הפרטים הנדרשים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:778,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:776,columnNumber:13},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-8",children:[e.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"sender_email",children:"כתובת דואר אלקטרוני השולח"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:787,columnNumber:21},void 0),e.jsxDEV($,{id:"sender_email",dir:"ltr",value:u.sender_email,onChange:D=>R({...u,sender_email:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:788,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:786,columnNumber:19},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"sender_name",children:"שם השולח"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:796,columnNumber:21},void 0),e.jsxDEV($,{id:"sender_name",value:u.sender_name,onChange:D=>R({...u,sender_name:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:797,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:795,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:785,columnNumber:17},void 0),e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"שיטת שליחה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:807,columnNumber:19},void 0),e.jsxDEV(Pr,{value:u.email_method,onValueChange:D=>R({...u,email_method:D}),className:"space-y-4",children:[e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(un,{value:"smtp",id:"email-method-smtp"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:814,columnNumber:23},void 0),e.jsxDEV(U,{htmlFor:"email-method-smtp",className:"mr-2 cursor-pointer",children:"שרת SMTP (שיטה סטנדרטית)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:815,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:813,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(un,{value:"gmail_api",id:"email-method-gmail"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:818,columnNumber:23},void 0),e.jsxDEV(U,{htmlFor:"email-method-gmail",className:"mr-2 cursor-pointer",children:"ממשק API של Gmail"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:819,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:817,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(un,{value:"mailgun",id:"email-method-mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:822,columnNumber:23},void 0),e.jsxDEV(U,{htmlFor:"email-method-mailgun",className:"mr-2 cursor-pointer",children:"Mailgun API (מומלץ)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:823,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:821,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(un,{value:"internal_server",id:"email-method-internal"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:826,columnNumber:23},void 0),e.jsxDEV(U,{htmlFor:"email-method-internal",className:"mr-2 cursor-pointer",children:"שרת פנימי (שימוש במשאבי השרת)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:827,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:825,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:808,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:806,columnNumber:17},void 0),u.email_method==="smtp"&&e.jsxDEV("div",{className:"space-y-4 border p-4 rounded-md",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"הגדרות SMTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:835,columnNumber:21},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"smtp_host",children:"כתובת שרת SMTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:838,columnNumber:25},void 0),e.jsxDEV($,{id:"smtp_host",dir:"ltr",placeholder:"smtp.example.com",value:u.smtp_host,onChange:D=>R({...u,smtp_host:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:839,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:837,columnNumber:23},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"smtp_port",children:"פורט SMTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:848,columnNumber:25},void 0),e.jsxDEV($,{id:"smtp_port",dir:"ltr",type:"number",placeholder:"587",value:u.smtp_port?u.smtp_port.toString():"587",onChange:D=>R({...u,smtp_port:parseInt(D.target.value)||587})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:849,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:847,columnNumber:23},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"smtp_user",children:"שם משתמש SMTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:859,columnNumber:25},void 0),e.jsxDEV($,{id:"smtp_user",dir:"ltr",placeholder:"your-email@example.com",value:u.smtp_user,onChange:D=>R({...u,smtp_user:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:860,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:858,columnNumber:23},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"smtp_password",children:"סיסמה SMTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:869,columnNumber:25},void 0),e.jsxDEV($,{id:"smtp_password",dir:"ltr",type:"password",placeholder:"******",value:u.smtp_password,onChange:D=>R({...u,smtp_password:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:870,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:868,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:836,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:834,columnNumber:19},void 0),u.email_method==="gmail_api"&&e.jsxDEV("div",{className:"space-y-4 border p-4 rounded-md",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"הגדרות Gmail API"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:886,columnNumber:21},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"gmail_client_id",children:"Client ID"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:889,columnNumber:25},void 0),e.jsxDEV($,{id:"gmail_client_id",dir:"ltr",placeholder:"your-client-id.apps.googleusercontent.com",value:u.gmail_client_id,onChange:D=>R({...u,gmail_client_id:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:890,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:888,columnNumber:23},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"gmail_client_secret",children:"Client Secret"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:899,columnNumber:25},void 0),e.jsxDEV($,{id:"gmail_client_secret",dir:"ltr",type:"password",placeholder:"GOCSPX-...",value:u.gmail_client_secret,onChange:D=>R({...u,gmail_client_secret:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:900,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:898,columnNumber:23},void 0),e.jsxDEV("div",{className:"space-y-2 col-span-2",children:[e.jsxDEV(U,{htmlFor:"gmail_redirect_uri",children:"Redirect URI"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:910,columnNumber:25},void 0),e.jsxDEV($,{id:"gmail_redirect_uri",dir:"ltr",placeholder:we(),value:u.gmail_redirect_uri,onChange:D=>R({...u,gmail_redirect_uri:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:911,columnNumber:25},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground mt-1",children:"ודא שכתובת זו מוגדרת גם ב-Google Cloud Console בהגדרות OAuth"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:918,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:909,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:887,columnNumber:21},void 0),e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxDEV("h4",{className:"font-medium",children:"סטטוס אימות:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:926,columnNumber:25},void 0),e.jsxDEV("span",{className:ve.color,children:ve.message},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:927,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:925,columnNumber:23},void 0),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(A,{type:"button",onClick:ye,disabled:!u.gmail_client_id||!u.gmail_redirect_uri||j,className:"mt-2",children:"התחבר עם Gmail"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:931,columnNumber:25},void 0),u.gmail_refresh_token&&e.jsxDEV(A,{type:"button",variant:"outline",onClick:K,disabled:j,className:"mt-2 flex items-center gap-2",children:[e.jsxDEV(Me,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:948,columnNumber:29},void 0),"רענן טוקן"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:941,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:930,columnNumber:23},void 0),e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV("h4",{className:"font-medium mb-2",children:"הזנה ידנית של קוד אימות:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:955,columnNumber:25},void 0),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV($,{dir:"ltr",value:x,onChange:D=>E(D.target.value),placeholder:"הזן קוד אימות שקיבלת מ-Google"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:957,columnNumber:27},void 0),e.jsxDEV(A,{type:"button",onClick:z,disabled:!x.trim()||j,children:"שלח"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:963,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:956,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:954,columnNumber:23},void 0),e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV("h4",{className:"font-medium mb-2",children:"הזנה ידנית של טוקן רענון:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:974,columnNumber:25},void 0),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV($,{dir:"ltr",value:v,onChange:D=>N(D.target.value),placeholder:"הזן טוקן רענון ידנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:976,columnNumber:27},void 0),e.jsxDEV(A,{type:"button",onClick:q,disabled:!v.trim()||j,children:"שלח"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:982,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:975,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:973,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:924,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:885,columnNumber:19},void 0),u.email_method==="mailgun"&&e.jsxDEV("div",{className:"space-y-4 border p-4 rounded-md",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"הגדרות Mailgun API"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:998,columnNumber:21},void 0),e.jsxDEV(Le,{className:"mb-4",children:[e.jsxDEV(rn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1e3,columnNumber:23},void 0),e.jsxDEV(Xe,{children:"הגדרת Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1001,columnNumber:23},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("p",{className:"text-sm mt-1",children:"הזן את פרטי ה-API של Mailgun להלן. ניתן לקבל את המפתח והדומיין מלוח הבקרה של Mailgun."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1003,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1002,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:999,columnNumber:21},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"mailgun_api_key",children:"API Key"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1011,columnNumber:25},void 0),e.jsxDEV($,{id:"mailgun_api_key",dir:"ltr",placeholder:"key-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",value:u.mailgun_api_key||"",onChange:D=>R({...u,mailgun_api_key:D.target.value}),type:"password"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1012,columnNumber:25},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"המפתח האישי שלך מ-Mailgun (מתחיל ב-key-...)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1020,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1010,columnNumber:23},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"mailgun_domain",children:"Domain"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1025,columnNumber:25},void 0),e.jsxDEV($,{id:"mailgun_domain",dir:"ltr",placeholder:"myradio.co.il",value:u.mailgun_domain||"",onChange:D=>R({...u,mailgun_domain:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1026,columnNumber:25},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"הדומיין המאומת שלך ב-Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1033,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1024,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1009,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse rtl:space-x-reverse",children:[e.jsxDEV(jr,{id:"is_eu_region",checked:u.is_eu_region||!1,onCheckedChange:D=>R({...u,is_eu_region:D})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1040,columnNumber:23},void 0),e.jsxDEV(U,{htmlFor:"is_eu_region",children:"השתמש באזור האירופי של Mailgun (api.eu.mailgun.net)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1045,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1039,columnNumber:21},void 0),e.jsxDEV("div",{className:"p-4 bg-blue-50 rounded-md border border-blue-200",children:[e.jsxDEV("h4",{className:"font-medium mb-2 text-blue-800",children:"יצירת חשבון Mailgun והגדרתו:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1049,columnNumber:23},void 0),e.jsxDEV("ol",{className:"list-decimal list-inside space-y-2 text-sm text-blue-700",children:[e.jsxDEV("li",{children:["היכנס ל",e.jsxDEV("a",{href:"https://signup.mailgun.com/new/signup",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"הרשמה ל-Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1051,columnNumber:36},void 0)," וצור חשבון"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1051,columnNumber:25},void 0),e.jsxDEV("li",{children:"אמת את הדומיין שלך (כגון myradio.co.il) ב-Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1052,columnNumber:25},void 0),e.jsxDEV("li",{children:'במסך הבקרה של Mailgun, מצא את מפתח ה-API תחת "API Security"'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1053,columnNumber:25},void 0),e.jsxDEV("li",{children:"העתק את מפתח ה-API והדומיין המאומת והזן אותם בשדות למעלה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1054,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1050,columnNumber:23},void 0),e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV("h5",{className:"font-medium text-blue-800",children:"קישורים שימושיים:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1057,columnNumber:25},void 0),e.jsxDEV("ul",{className:"list-disc list-inside mt-1 text-sm text-blue-700",children:[e.jsxDEV("li",{children:e.jsxDEV("a",{href:"https://app.mailgun.com/app/dashboard",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"לוח בקרה של Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1059,columnNumber:31},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1059,columnNumber:27},void 0),e.jsxDEV("li",{children:e.jsxDEV("a",{href:"https://app.mailgun.com/app/account/security/api_keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"מפתחות API של Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1060,columnNumber:31},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1060,columnNumber:27},void 0),e.jsxDEV("li",{children:e.jsxDEV("a",{href:"https://app.mailgun.com/app/sending/domains",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"דומיינים מאומתים ב-Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1061,columnNumber:31},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1061,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1058,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1056,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1048,columnNumber:21},void 0),e.jsxDEV(Le,{variant:"warning",className:"mt-4",children:[e.jsxDEV(cn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1067,columnNumber:23},void 0),e.jsxDEV(Xe,{children:"כתובת ה-from בדומיין Mailgun"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1068,columnNumber:23},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("p",{className:"text-sm",children:"ודא שכתובת השולח (כתובת ה-from) תואם את הדומיין המאומת שלך. אחרת, המשלוח עלול להיכשל."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1070,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1069,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1066,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:997,columnNumber:19},void 0),u.email_method==="internal_server"&&e.jsxDEV("div",{className:"space-y-4 border p-4 rounded-md",children:[e.jsxDEV("h3",{className:"text-lg font-medium",children:"הגדרות שרת פנימי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1081,columnNumber:21},void 0),e.jsxDEV(Le,{className:"mb-4",children:[e.jsxDEV(rn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1083,columnNumber:23},void 0),e.jsxDEV(Xe,{children:"שליחה דרך שרת פנימי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1084,columnNumber:23},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("p",{className:"text-sm mt-1",children:"שיטה זו משתמשת במשאבי השרת הפנימי לשליחת דואר אלקטרוני. אין צורך בהגדרות נוספות."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1086,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1085,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1082,columnNumber:21},void 0),e.jsxDEV("div",{className:"p-4 bg-green-50 rounded-md border border-green-200",children:[e.jsxDEV("h4",{className:"font-medium mb-2 text-green-800",children:"יתרונות השימוש בשרת פנימי:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1093,columnNumber:23},void 0),e.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-sm text-green-700",children:[e.jsxDEV("li",{children:"אין צורך בשירותי צד שלישי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1095,columnNumber:25},void 0),e.jsxDEV("li",{children:"שליטה מלאה על תהליך השליחה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1096,columnNumber:25},void 0),e.jsxDEV("li",{children:"אין עלויות נוספות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1097,columnNumber:25},void 0),e.jsxDEV("li",{children:"מתאים לשרתים עם תמיכה ב-SMTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1098,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1094,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1092,columnNumber:21},void 0),e.jsxDEV(Le,{variant:"warning",className:"mt-4",children:[e.jsxDEV(cn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1103,columnNumber:23},void 0),e.jsxDEV(Xe,{children:"דרישות מערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1104,columnNumber:23},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("p",{className:"text-sm",children:"ודא שהשרת שלך מוגדר לשליחת דואר אלקטרוני וכי אין חסימות על פורט 25 או 587."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1106,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1105,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1102,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1080,columnNumber:19},void 0),e.jsxDEV(Le,{children:[e.jsxDEV(Xe,{children:"מידע על שיטות שליחה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1116,columnNumber:19},void 0),e.jsxDEV(Pe,{children:[e.jsxDEV("p",{className:"mb-2",children:[e.jsxDEV("strong",{children:"שרת SMTP:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1118,columnNumber:41},void 0)," שיטה סטנדרטית לשליחת דואר אלקטרוני. מתאימה לרוב השירותים אך עלולה להיתקל בחסימות."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1118,columnNumber:21},void 0),e.jsxDEV("p",{className:"mb-2",children:[e.jsxDEV("strong",{children:"ממשק API של Gmail:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1119,columnNumber:41},void 0)," שיטה מתקדמת לשליחת דואר דרך חשבון Google. מתאימה במיוחד אם נתקלת בבעיות עם SMTP של Gmail או Outlook."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1119,columnNumber:21},void 0),e.jsxDEV("p",{className:"mb-2",children:[e.jsxDEV("strong",{children:"Mailgun API:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1120,columnNumber:41},void 0)," שיטה מומלצת לשליחת דואר אלקטרוני, מסייעת במניעת סיווג כספאם ומספקת ניתוח משלוחים. דורשת יצירת חשבון Mailgun והגדרת Domain."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1120,columnNumber:21},void 0),e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"שרת פנימי:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1121,columnNumber:24},void 0)," שימוש במשאבי השרת הפנימי לשליחת דואר אלקטרוני. מתאים לשרתים עם תמיכה ב-SMTP ואין צורך בשירותי צד שלישי."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1121,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1117,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1115,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:783,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:782,columnNumber:13},void 0),e.jsxDEV(tn,{children:e.jsxDEV(A,{onClick:Se,disabled:s,children:s?"שומר...":"שמור הגדרות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1127,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1126,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:775,columnNumber:11},void 0),r==="template"&&e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"תבנית הודעת דואר אלקטרוני"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1134,columnNumber:15},void 0),e.jsxDEV(xe,{children:"הגדר את הפורמט של הודעות הדואר האלקטרוני"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1135,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1133,columnNumber:13},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"subject_template",children:"נושא ההודעה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1142,columnNumber:19},void 0),e.jsxDEV($,{id:"subject_template",placeholder:"ליינאפ תוכנית {{show_name}} לתאריך {{show_date}}",value:u.subject_template,onChange:D=>R({...u,subject_template:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1143,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["תגיות אפשריות: ",e.jsxDEV("code",{children:"{{show_name}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1150,columnNumber:36},void 0),", ",e.jsxDEV("code",{children:"{{show_date}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1150,columnNumber:68},void 0),", ",e.jsxDEV("code",{children:"{{show_time}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1150,columnNumber:100},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1149,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1141,columnNumber:17},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"body_template",children:"גוף ההודעה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1155,columnNumber:19},void 0),e.jsxDEV(Mn,{id:"body_template",placeholder:"שלום, מצורף ליינאפ התוכנית {{show_name}} לתאריך {{show_date}}",rows:8,value:u.body_template,onChange:D=>R({...u,body_template:D.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1156,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["תגיות אפשריות: ",e.jsxDEV("code",{children:"{{show_name}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1164,columnNumber:36},void 0),", ",e.jsxDEV("code",{children:"{{show_date}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1164,columnNumber:68},void 0),", ",e.jsxDEV("code",{children:"{{show_time}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1164,columnNumber:100},void 0),", ",e.jsxDEV("code",{children:"{{interviewees_list}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1164,columnNumber:132},void 0),", ",e.jsxDEV("code",{children:"{{lineup_link}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1164,columnNumber:172},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1163,columnNumber:19},void 0),e.jsxDEV(Le,{className:"mt-4",children:[e.jsxDEV(rn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1167,columnNumber:21},void 0),e.jsxDEV(Xe,{children:"תגיות מיוחדות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1168,columnNumber:21},void 0),e.jsxDEV(Pe,{children:[e.jsxDEV("p",{className:"mb-2",children:[e.jsxDEV("code",{children:"{{interviewees_list}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1170,columnNumber:43},void 0)," - רשימת מרואיינים מעוצבת כ-HTML"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1170,columnNumber:23},void 0),e.jsxDEV("p",{children:[e.jsxDEV("code",{children:"{{lineup_link}}"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1171,columnNumber:26},void 0)," - כפתור מעוצב עם קישור לליינאפ"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1171,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1169,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1166,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1154,columnNumber:17},void 0),k&&e.jsxDEV(Le,{children:[e.jsxDEV(rn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1178,columnNumber:21},void 0),e.jsxDEV(Xe,{className:"flex items-center gap-2",children:'תצוגה מקדימה של תוכן הדוא"ל'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1179,columnNumber:21},void 0),e.jsxDEV(Pe,{children:e.jsxDEV("div",{className:"mt-2 space-y-2",children:[e.jsxDEV("p",{children:[e.jsxDEV("strong",{children:"נושא:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1184,columnNumber:28},void 0)," ",ce(u.subject_template)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1184,columnNumber:25},void 0),e.jsxDEV("div",{className:"border rounded-md p-4 mt-2 bg-white",children:[e.jsxDEV("p",{children:e.jsxDEV("strong",{children:'תצוגה מקדימה כפי שתופיע בדוא"ל:'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1186,columnNumber:30},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1186,columnNumber:27},void 0),e.jsxDEV("div",{className:"mt-2",dangerouslySetInnerHTML:{__html:Xi(se||"")}},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1187,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1185,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1183,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1182,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1177,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1140,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1139,columnNumber:13},void 0),e.jsxDEV(tn,{children:e.jsxDEV(A,{onClick:Se,disabled:s,children:s?"שומר...":"שמור תבנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1196,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1195,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:1132,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/EmailSettings.tsx",lineNumber:652,columnNumber:5},void 0)},wa=({exportStartDate:n,exportEndDate:i,setExportStartDate:r,setExportEndDate:a,disabled:m})=>{const s=o=>o?re(o,"dd/MM/yyyy"):"לא נבחר";return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"font-medium",children:"טווח תאריכים (אופציונלי)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:33,columnNumber:7},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{children:"מתאריך"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:37,columnNumber:11},void 0),e.jsxDEV($r,{children:[e.jsxDEV(Br,{asChild:!0,children:e.jsxDEV(A,{variant:"outline",className:"w-full justify-start",disabled:m,children:[e.jsxDEV(jn,{className:"ms-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:45,columnNumber:17},void 0),s(n)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:40,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:39,columnNumber:13},void 0),e.jsxDEV(Xr,{className:"w-auto p-0",align:"start",children:e.jsxDEV(Wr,{mode:"single",selected:n,onSelect:r,initialFocus:!0,className:"p-3 pointer-events-auto"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:50,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:49,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:38,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:36,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{children:"עד תאריך"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:62,columnNumber:11},void 0),e.jsxDEV($r,{children:[e.jsxDEV(Br,{asChild:!0,children:e.jsxDEV(A,{variant:"outline",className:"w-full justify-start",disabled:m,children:[e.jsxDEV(jn,{className:"ms-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:70,columnNumber:17},void 0),s(i)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:65,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:64,columnNumber:13},void 0),e.jsxDEV(Xr,{className:"w-auto p-0",align:"start",children:e.jsxDEV(Wr,{mode:"single",selected:i,onSelect:a,initialFocus:!0,className:"p-3 pointer-events-auto"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:75,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:74,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:63,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:61,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:35,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/DateRangeSelector.tsx",lineNumber:32,columnNumber:5},void 0)},ka=({selectedTables:n,setSelectedTables:i,disabled:r})=>e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"font-medium mb-3",children:"טבלאות לייצוא"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/TableSelector.tsx",lineNumber:19,columnNumber:7},void 0),e.jsxDEV("div",{className:"space-y-2",children:Object.entries(n).map(([a,m])=>e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(Ge,{id:`export-${a}`,checked:m,onCheckedChange:s=>i({...n,[a]:!!s}),disabled:r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/TableSelector.tsx",lineNumber:24,columnNumber:13},void 0),e.jsxDEV(U,{htmlFor:`export-${a}`,className:"cursor-pointer",children:a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/TableSelector.tsx",lineNumber:32,columnNumber:13},void 0)]},a,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/TableSelector.tsx",lineNumber:23,columnNumber:11},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/TableSelector.tsx",lineNumber:21,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/TableSelector.tsx",lineNumber:18,columnNumber:5},void 0),Rn=async(n,i={})=>{try{let r=ae.from(n).select("*");if(Object.keys(i).length>0)for(const[s,o]of Object.entries(i))Array.isArray(o)?r=r.in(s,o):r=r.eq(s,o);const{data:a,error:m}=await r;if(m)throw m;return a||[]}catch(r){throw console.error(`Error executing query for ${n}:`,r),r}},Ta=()=>{const{toast:n}=De(),[i,r]=t.useState(!1);return{isExporting:i,handleExport:async({exportStartDate:s,exportEndDate:o,selectedTables:h})=>{try{r(!0);const d={},j=Object.entries(h).filter(([N,x])=>x).map(([N])=>N);let b=[],v=[];if(s||o)try{let N=ae.from("schedule_slots").select("id");if(s){const S=re(s,"yyyy-MM-dd");N=N.gte("created_at",S)}if(o){const S=re(o,"yyyy-MM-dd");N=N.lte("created_at",S)}const{data:x,error:E}=await N;if(E)throw new Error(`Error filtering shows: ${E.message}`);if(b=x?.map(S=>S.id)||[],b.length>0){const{data:S,error:g}=await ae.from("show_items").select("id").in("show_id",b);if(g)throw new Error(`Error filtering show items: ${g.message}`);v=S?.map(u=>u.id)||[]}}catch(N){console.error("Error preparing filtered IDs:",N),n({title:"שגיאה בהכנת מסנני תאריכים",description:N.message,variant:"destructive"})}for(const N of j)try{let x=[];if(s||o)if(N==="shows_backup"){let E=ae.from("shows_backup").select("*");if(s){const u=re(s,"yyyy-MM-dd");E=E.gte("date",u)}if(o){const u=re(o,"yyyy-MM-dd");E=E.lte("date",u)}const{data:S,error:g}=await E;if(g)throw g;x=S||[]}else if(N==="work_arrangements"||N==="digital_work_arrangements"){const{data:E,error:S}=await ae.from(N).select("*");if(S)throw S;E&&(x=E.filter(g=>{const u=new Date(g.week_start);return(!s||u>=s)&&(!o||u<=o)}))}else(N==="show_items"||N==="show_email_logs"||N==="show_whatsapp_logs")&&b.length>0?x=await Rn(N,{show_id:b}):N==="interviewees"&&v.length>0?x=await Rn(N,{item_id:v}):N==="whatsapp_settings"?x=await Rn(N):x=await Rn(N);else x=await Rn(N);d[N]=x}catch(x){console.error(`Error exporting ${N}:`,x),n({title:`שגיאה בטבלה ${N}`,description:x.message,variant:"destructive"}),d[N]=[]}return d}catch(d){throw console.error("Export error:",d),n({title:"שגיאה בייצוא נתונים",description:d.message,variant:"destructive"}),d}finally{r(!1)}},downloadExportData:(s,o,h)=>{const d=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),j=URL.createObjectURL(d),b=document.createElement("a");b.href=j;let N=`radio-data-export-${re(new Date,"yyyy-MM-dd")}.json`;if(o&&h){const x=re(o,"yyyy-MM-dd"),E=re(h,"yyyy-MM-dd");N=`radio-data-export-${x}-to-${E}.json`}b.download=N,b.click(),n({title:"ייצוא הצליח",description:`הנתונים יוצאו בהצלחה לקובץ ${N}`,variant:"default"})}}},_a=()=>{const[n,i]=t.useState(void 0),[r,a]=t.useState(void 0),[m,s]=t.useState({shows_backup:!0,show_items:!0,interviewees:!0,schedule_slots_old:!0,schedule_slots:!0,day_notes:!0,workers:!0,email_settings:!1,email_recipients:!1,whatsapp_settings:!1,show_email_logs:!1,show_whatsapp_logs:!1,work_arrangements:!1,digital_work_arrangements:!1,digital_shifts:!1,digital_shift_custom_rows:!1,digital_employees:!1,system_settings:!1}),{isExporting:o,handleExport:h,downloadExportData:d}=Ta(),j=async()=>{try{const b=await h({exportStartDate:n,exportEndDate:r,selectedTables:m});d(b,n,r)}catch{}};return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV(wa,{exportStartDate:n,exportEndDate:r,setExportStartDate:i,setExportEndDate:a,disabled:o},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:75,columnNumber:9},void 0),e.jsxDEV(ka,{selectedTables:m,setSelectedTables:s,disabled:o},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:83,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:74,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex justify-end mt-4",children:e.jsxDEV(A,{onClick:j,disabled:o||!Object.values(m).some(b=>b),children:o?e.jsxDEV(e.Fragment,{children:"מייצא נתונים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:96,columnNumber:13},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(tr,{className:"ms-2 h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:99,columnNumber:15},void 0),"ייצא נתונים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:98,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:91,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:90,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/export/ExportDataTab.tsx",lineNumber:73,columnNumber:5},void 0)},_n=t.forwardRef(({className:n,value:i,...r},a)=>e.jsxDEV(bi,{ref:a,className:Ee("relative h-4 w-full overflow-hidden rounded-full bg-secondary",n),...r,children:e.jsxDEV(Kt,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(${100-(i||0)}%)`}},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/progress.tsx",lineNumber:19,columnNumber:5},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/ui/progress.tsx",lineNumber:11,columnNumber:3},void 0));_n.displayName=bi.displayName;const Aa=({open:n,onOpenChange:i,conflict:r,currentIndex:a,totalConflicts:m,onResolve:s})=>r?e.jsxDEV(qe,{open:n,onOpenChange:i,children:e.jsxDEV(Ke,{className:"max-w-lg",children:[e.jsxDEV(Ye,{children:[e.jsxDEV(Je,{children:["התנגשות נתונים ",a+1," מתוך ",m]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:45,columnNumber:11},void 0),e.jsxDEV(kr,{children:"קיימת התנגשות בין נתונים קיימים במערכת לבין נתונים בקובץ הייבוא. בחר כיצד לטפל בהתנגשות זו."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:48,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:44,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-4 max-h-96 overflow-auto",children:[e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{className:"font-semibold",children:"טבלה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:56,columnNumber:13},void 0),e.jsxDEV("span",{children:r.table},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:57,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:55,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex justify-between",children:[e.jsxDEV("span",{className:"font-semibold",children:"מזהה רשומה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:60,columnNumber:13},void 0),e.jsxDEV("span",{children:r.id},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:61,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:59,columnNumber:11},void 0),e.jsxDEV("div",{className:"border p-3 rounded-md bg-gray-50",children:[e.jsxDEV("h4",{className:"font-medium mb-2",children:"נתונים קיימים במערכת:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:65,columnNumber:13},void 0),e.jsxDEV("pre",{className:"text-xs overflow-x-auto",children:JSON.stringify(r.existingData,null,2)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:66,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:64,columnNumber:11},void 0),e.jsxDEV("div",{className:"border p-3 rounded-md bg-blue-50",children:[e.jsxDEV("h4",{className:"font-medium mb-2",children:"נתונים חדשים מהקובץ:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:70,columnNumber:13},void 0),e.jsxDEV("pre",{className:"text-xs overflow-x-auto",children:JSON.stringify(r.newData,null,2)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:71,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:69,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:54,columnNumber:9},void 0),e.jsxDEV(an,{className:"space-x-2 space-x-reverse",children:[e.jsxDEV(A,{variant:"outline",onClick:()=>s("keep"),children:[e.jsxDEV(nr,{className:"h-4 w-4 ms-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:77,columnNumber:13},void 0),"שמור על הנתונים הקיימים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:76,columnNumber:11},void 0),e.jsxDEV(A,{onClick:()=>s("overwrite"),children:[e.jsxDEV(Ar,{className:"h-4 w-4 ms-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:81,columnNumber:13},void 0),"דרוס בנתונים החדשים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:80,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:75,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:43,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ConflictDialog.tsx",lineNumber:42,columnNumber:5},void 0):null,Fa=({open:n,onOpenChange:i,conflictCount:r,onResolve:a})=>e.jsxDEV(Hn,{open:n,onOpenChange:i,children:e.jsxDEV(Gn,{children:[e.jsxDEV(zn,{children:[e.jsxDEV(qn,{children:["נמצאו ",r," התנגשויות נתונים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:33,columnNumber:11},void 0),e.jsxDEV(Kn,{children:"נמצאו רשומות בקובץ שכבר קיימות במערכת. כיצד ברצונך לטפל בהתנגשויות אלו?"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:34,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:32,columnNumber:9},void 0),e.jsxDEV(Yn,{children:[e.jsxDEV(Jn,{onClick:()=>i(!1),children:"בטל ייבוא"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:39,columnNumber:11},void 0),e.jsxDEV(En,{onClick:()=>a("keep"),children:"שמור על הנתונים הקיימים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:42,columnNumber:11},void 0),e.jsxDEV(En,{onClick:()=>a("overwrite"),children:"דרוס בנתונים החדשים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:45,columnNumber:11},void 0),e.jsxDEV(En,{onClick:()=>a("ask"),children:"בדוק כל התנגשות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:48,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:38,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:31,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/GlobalResolutionDialog.tsx",lineNumber:30,columnNumber:5},void 0),Ra=()=>{const{toast:n}=De(),[i,r]=t.useState(!1),[a,m]=t.useState(0),[s,o]=t.useState(!1),[h,d]=t.useState("ask"),[j,b]=t.useState([]),[v,N]=t.useState(0),[x,E]=t.useState(!1),S=t.useRef(null),g=c=>{const k=c.target.files?.[0];if(!k)return;r(!0),m(0);const f=new FileReader;f.onprogress=F=>{if(F.lengthComputable){const P=Math.round(F.loaded/F.total*100);m(P)}},f.onload=async F=>{try{const P=F.target?.result,O=JSON.parse(P);if(!O||typeof O!="object")throw new Error("קובץ לא חוקי. יש להשתמש בקובץ שיוצא מהמערכת.");await u(O),S.current&&(S.current.value="")}catch(P){console.error("Import error:",P),n({title:"שגיאה בייבוא נתונים",description:P.message,variant:"destructive"})}finally{r(!1),m(0)}},f.onerror=()=>{r(!1),m(0),n({title:"שגיאה בקריאת הקובץ",description:"אירעה שגיאה בקריאת הקובץ. נסה שוב.",variant:"destructive"})},f.readAsText(k)},u=async c=>{const k=[];for(const[f,F]of Object.entries(c)){const P=f==="shows"?"shows_backup":f;if(!(!Array.isArray(F)||F.length===0))for(const O of F){if(!O.id)continue;const{data:_,error:y}=await ae.from(P).select("*").eq("id",O.id).single();!y&&_&&k.push({id:O.id,table:P,existingData:_,newData:O})}}k.length>0?(b(k),h==="ask"?E(!0):await R(c,h)):await R(c,"overwrite")},R=async(c,k)=>{try{for(const[f,F]of Object.entries(c)){const P=f==="shows"?"shows_backup":f;if(!(!Array.isArray(F)||F.length===0))for(const O of F){if(!O.id)continue;const{data:_,error:y}=await ae.from(P).select("id").eq("id",O.id).single();if(!y&&_){if(k==="overwrite"){const{error:L}=await ae.from(P).update(O).eq("id",O.id);L&&console.error(`Error updating ${P} record:`,L)}}else{const{error:L}=await ae.from(P).insert(O);L&&console.error(`Error inserting ${P} record:`,L)}}}n({title:"ייבוא הצליח",description:"הנתונים יובאו בהצלחה למערכת",variant:"default"})}catch(f){console.error("Data import error:",f),n({title:"שגיאה בייבוא נתונים",description:f.message,variant:"destructive"})}},V=async c=>{if(E(!1),c==="ask")N(0),o(!0);else{const k={};j.forEach(f=>{k[f.table]||(k[f.table]=[]),k[f.table].push(f.newData)}),await R(k,c)}},T=c=>{const k=[...j];k[v].resolution=c,b(k),v<j.length-1?N(f=>f+1):(o(!1),l())},l=async()=>{try{const c={};j.forEach(k=>{c[k.table]||(c[k.table]=[]),k.resolution==="overwrite"&&c[k.table].push(k.newData)});for(const[k,f]of Object.entries(c))for(const F of f){const{error:P}=await ae.from(k).update(F).eq("id",F.id);P&&console.error(`Error updating ${k} record:`,P)}n({title:"ייבוא הצליח",description:"הנתונים יובאו בהצלחה למערכת",variant:"default"})}catch(c){console.error("Error processing individual conflicts:",c),n({title:"שגיאה בייבוא נתונים",description:c.message,variant:"destructive"})}};return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"border-2 border-dashed rounded-lg p-8 text-center space-y-4",children:[e.jsxDEV(Vt,{className:"h-8 w-8 mx-auto text-gray-400"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:283,columnNumber:9},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-gray-500",children:"גרור קובץ לכאן או"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:285,columnNumber:11},void 0),e.jsxDEV(A,{variant:"outline",className:"mt-2",disabled:i,onClick:()=>S.current?.click(),children:[e.jsxDEV(Tn,{className:"h-4 w-4 ms-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:292,columnNumber:13},void 0),"בחר קובץ"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:286,columnNumber:11},void 0),e.jsxDEV("input",{ref:S,type:"file",className:"hidden",accept:".json",onChange:g,disabled:i},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:295,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:284,columnNumber:9},void 0),i&&e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(_n,{value:a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:307,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:["מעלה קובץ... ",a,"%"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:308,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:306,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:282,columnNumber:7},void 0),e.jsxDEV("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxDEV("div",{className:"flex items-start space-x-2 space-x-reverse",children:[e.jsxDEV(rn,{className:"h-5 w-5 text-blue-500 mt-0.5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:317,columnNumber:11},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h4",{className:"font-medium",children:"אפשרויות טיפול בנתונים כפולים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:319,columnNumber:13},void 0),e.jsxDEV("div",{className:"mt-2 space-y-2",children:[e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV("input",{type:"radio",id:"resolution-ask",name:"conflict-resolution",value:"ask",checked:h==="ask",onChange:()=>d("ask")},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:322,columnNumber:17},void 0),e.jsxDEV(U,{htmlFor:"resolution-ask",children:"שאל לגבי כל התנגשות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:330,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:321,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV("input",{type:"radio",id:"resolution-overwrite",name:"conflict-resolution",value:"overwrite",checked:h==="overwrite",onChange:()=>d("overwrite")},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:336,columnNumber:17},void 0),e.jsxDEV(U,{htmlFor:"resolution-overwrite",children:"דרוס את כל הנתונים הקיימים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:344,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:335,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV("input",{type:"radio",id:"resolution-keep",name:"conflict-resolution",value:"keep",checked:h==="keep",onChange:()=>d("keep")},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:350,columnNumber:17},void 0),e.jsxDEV(U,{htmlFor:"resolution-keep",children:"שמור על הנתונים הקיימים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:358,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:349,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:320,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:318,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:316,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:315,columnNumber:7},void 0),e.jsxDEV(Aa,{open:s,onOpenChange:o,conflict:j[v],currentIndex:v,totalConflicts:j.length,onResolve:T},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:367,columnNumber:7},void 0),e.jsxDEV(Fa,{open:x,onOpenChange:E,conflictCount:j.length,onResolve:V},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:376,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/ImportDataTab.tsx",lineNumber:281,columnNumber:5},void 0)},Ma=()=>{const[n,i]=t.useState([]),[r,a]=t.useState(!1),[m,s]=t.useState(!1),[o,h]=t.useState(!1),[d,j]=t.useState(0),[b,v]=t.useState(null),[N,x]=t.useState(!1),[E,S]=t.useState(!1),[g,u]=t.useState(!1),[R,V]=t.useState(null),[T,l]=t.useState(10),[c,k]=t.useState(!1),f=async()=>{try{a(!0);const I=await fetch("/api/backup/list",{credentials:"include"});if(!I.ok)throw new Error("Failed to load backups");const B=await I.json();if(B.success)i(B.backups);else throw new Error(B.error||"Failed to load backups")}catch(I){console.error("Error loading backups:",I),oe.error("שגיאה בטעינת הגיבויים")}finally{a(!1)}};t.useEffect(()=>{f()},[]);const F=async()=>{try{s(!0);const I=await fetch("/api/backup/create",{method:"POST",credentials:"include"});if(!I.ok)throw new Error("Failed to create backup");const B=await I.json();if(B.success)oe.success("הגיבוי נוצר בהצלחה"),f();else throw new Error(B.error||"Failed to create backup")}catch(I){console.error("Error creating backup:",I),oe.error("שגיאה ביצירת הגיבוי")}finally{s(!1)}},P=async I=>{try{const B=await fetch(`/api/backup/download/${encodeURIComponent(I)}`,{credentials:"include"});if(!B.ok)throw new Error("Failed to download backup");const ne=await B.blob(),fe=window.URL.createObjectURL(ne),Se=document.createElement("a");Se.href=fe,Se.download=I,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(fe),document.body.removeChild(Se),oe.success("הגיבוי הורד בהצלחה")}catch(B){console.error("Error downloading backup:",B),oe.error("שגיאה בהורדת הגיבוי")}},O=async I=>{try{const B=await fetch(`/api/backup/delete/${encodeURIComponent(I)}`,{method:"DELETE",credentials:"include"});if(!B.ok)throw new Error("Failed to delete backup");const ne=await B.json();if(ne.success)oe.success("הגיבוי נמחק בהצלחה"),f();else throw new Error(ne.error||"Failed to delete backup")}catch(B){console.error("Error deleting backup:",B),oe.error("שגיאה במחיקת הגיבוי")}},_=async I=>{try{const B=await fetch(`/api/backup/restore/${encodeURIComponent(I)}`,{method:"POST",credentials:"include"});if(!B.ok)throw new Error("Failed to restore backup");const ne=await B.json();if(ne.success)oe.success("הבסיס נתונים שוחזר בהצלחה"),S(!1),V(null),l(10),k(!1);else throw new Error(ne.error||"Failed to restore backup")}catch(B){console.error("Error restoring backup:",B),oe.error("שגיאה בשחזור בסיס הנתונים")}},y=async()=>{if(b)try{h(!0),j(0);const I=new FormData;I.append("sqlFile",b);const B=new XMLHttpRequest;B.upload.addEventListener("progress",ne=>{if(ne.lengthComputable){const fe=ne.loaded/ne.total*100;j(fe)}}),B.addEventListener("load",()=>{if(B.status===200){const ne=JSON.parse(B.responseText);if(ne.success)oe.success("הבסיס נתונים שוחזר בהצלחה מהקובץ שהועלה"),x(!1),v(null),j(0);else throw new Error(ne.error||"Failed to restore from uploaded file")}else throw new Error("Upload failed")}),B.addEventListener("error",()=>{throw new Error("Upload failed")}),B.open("POST","/api/backup/restore-upload"),B.send(I)}catch(I){console.error("Error uploading and restoring:",I),oe.error("שגיאה בהעלאת הקובץ ושחזור")}finally{h(!1),j(0)}},L=I=>{if(I===0)return"0 Bytes";const B=1024,ne=["Bytes","KB","MB","GB"],fe=Math.floor(Math.log(I)/Math.log(B));return parseFloat((I/Math.pow(B,fe)).toFixed(2))+" "+ne[fe]},w=I=>new Date(I).toLocaleString("he-IL"),q=I=>{const B=I.target.files?.[0];if(B){if(B.size>50*1024*1024){oe.error("הקובץ גדול מדי. הגודל המקסימלי הוא 50MB");return}v(B)}},z=I=>{V(I),S(!0),l(10),k(!1);const B=setInterval(()=>{l(ne=>ne<=1?(clearInterval(B),k(!0),0):ne-1)},1e3)};return e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{className:"flex items-center gap-2",children:[e.jsxDEV(Er,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:314,columnNumber:13},void 0),"פעולות גיבוי"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:313,columnNumber:11},void 0),e.jsxDEV(xe,{children:"צור גיבוי חדש או העלה קובץ SQL לשחזור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:317,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:312,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-4",children:e.jsxDEV("div",{className:"flex flex-wrap gap-4",children:[e.jsxDEV(A,{onClick:F,disabled:m,className:"flex items-center gap-2",children:[m?e.jsxDEV(Me,{className:"h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:329,columnNumber:17},void 0):e.jsxDEV(Er,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:331,columnNumber:17},void 0),m?"יוצר גיבוי...":"גבו עכשיו"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:323,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",onClick:()=>x(!0),className:"flex items-center gap-2",children:[e.jsxDEV(Tn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:341,columnNumber:15},void 0),"העלה קובץ SQL"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:336,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:322,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:321,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:311,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{className:"flex items-center gap-2",children:[e.jsxDEV(di,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:352,columnNumber:13},void 0),"רשימת גיבויים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:351,columnNumber:11},void 0),e.jsxDEV(xe,{children:"הגיבויים האחרונים של בסיס הנתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:355,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:350,columnNumber:9},void 0),e.jsxDEV(ie,{children:r?e.jsxDEV("div",{className:"flex items-center justify-center py-8",children:[e.jsxDEV(Me,{className:"h-6 w-6 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:362,columnNumber:15},void 0),e.jsxDEV("span",{className:"mr-2",children:"טוען גיבויים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:363,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:361,columnNumber:13},void 0):n.length===0?e.jsxDEV("div",{className:"text-center py-8 text-gray-500",children:[e.jsxDEV(Vn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:367,columnNumber:15},void 0),e.jsxDEV("p",{children:"אין גיבויים זמינים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:368,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:366,columnNumber:13},void 0):e.jsxDEV("div",{className:"overflow-x-auto",children:e.jsxDEV(Ze,{children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{children:"שם הקובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:375,columnNumber:21},void 0),e.jsxDEV(ee,{children:"גודל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:376,columnNumber:21},void 0),e.jsxDEV(ee,{children:"תאריך יצירה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:377,columnNumber:21},void 0),e.jsxDEV(ee,{children:"פעולות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:378,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:374,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:373,columnNumber:17},void 0),e.jsxDEV(en,{children:n.map(I=>e.jsxDEV(he,{children:[e.jsxDEV(Z,{className:"font-mono text-sm",children:[I.filename,I.filename.includes("auto-backup")&&e.jsxDEV(dn,{variant:"secondary",className:"mr-2",children:"אוטומטי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:387,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:384,columnNumber:23},void 0),e.jsxDEV(Z,{children:L(I.size)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:390,columnNumber:23},void 0),e.jsxDEV(Z,{children:w(I.created)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:391,columnNumber:23},void 0),e.jsxDEV(Z,{children:e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(A,{size:"sm",variant:"outline",onClick:()=>P(I.filename),children:e.jsxDEV(tr,{className:"h-3 w-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:399,columnNumber:29},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:394,columnNumber:27},void 0),e.jsxDEV(A,{size:"sm",variant:"outline",onClick:()=>z(I),children:e.jsxDEV(Me,{className:"h-3 w-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:406,columnNumber:29},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:401,columnNumber:27},void 0),e.jsxDEV(A,{size:"sm",variant:"outline",onClick:()=>{V(I),u(!0)},children:e.jsxDEV(kn,{className:"h-3 w-3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:416,columnNumber:29},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:408,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:393,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:392,columnNumber:23},void 0)]},I.filename,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:383,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:381,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:372,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:371,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:359,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:349,columnNumber:7},void 0),e.jsxDEV(qe,{open:N,onOpenChange:x,children:e.jsxDEV(Ke,{children:[e.jsxDEV(Ye,{children:[e.jsxDEV(Je,{children:"העלה קובץ SQL"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:433,columnNumber:13},void 0),e.jsxDEV(kr,{children:"העלה קובץ SQL לשחזור בסיס הנתונים. פעולה זו תמחק את כל הנתונים הקיימים!"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:434,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:432,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-4",children:e.jsxDEV("div",{className:"border-2 border-dashed border-red-300 rounded-lg p-6 text-center",children:[e.jsxDEV(Xn,{className:"h-8 w-8 text-red-500 mx-auto mb-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:441,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-red-600 font-semibold mb-2",children:"אזהרה!"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:442,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-600 mb-4",children:"שחזור מבסיס נתונים ימחק את כל הנתונים הקיימים ויחליף אותם בנתונים מהקובץ שהועלה."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:443,columnNumber:15},void 0),e.jsxDEV("input",{type:"file",accept:".sql",onChange:q,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:447,columnNumber:15},void 0),b&&e.jsxDEV("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsxDEV("p",{className:"text-sm font-medium",children:["קובץ נבחר: ",b.name]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:456,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-xs text-gray-500",children:["גודל: ",L(b.size)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:457,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:455,columnNumber:17},void 0),o&&e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV(_n,{value:d,className:"mb-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:463,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-sm text-gray-600",children:["מעלה ומשחזר... ",Math.round(d),"%"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:464,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:462,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:440,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:439,columnNumber:11},void 0),e.jsxDEV(an,{children:[e.jsxDEV(A,{variant:"outline",onClick:()=>x(!1),children:"ביטול"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:471,columnNumber:13},void 0),e.jsxDEV(A,{onClick:y,disabled:!b||o,variant:"destructive",children:o?"מעלה...":"שחזר מבסיס נתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:474,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:470,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:431,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:430,columnNumber:7},void 0),e.jsxDEV(Hn,{open:E,onOpenChange:S,children:e.jsxDEV(Gn,{children:[e.jsxDEV(zn,{children:[e.jsxDEV(qn,{className:"flex items-center gap-2",children:[e.jsxDEV(Xn,{className:"h-5 w-5 text-red-500"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:490,columnNumber:15},void 0),"אישור שחזור בסיס נתונים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:489,columnNumber:13},void 0),e.jsxDEV(Kn,{className:"space-y-4",children:[e.jsxDEV("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxDEV("p",{className:"text-red-800 font-semibold mb-2",children:"אזהרה קריטית!"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:495,columnNumber:17},void 0),e.jsxDEV("ul",{className:"text-red-700 text-sm space-y-1",children:[e.jsxDEV("li",{children:"• פעולה זו תמחק את כל הנתונים הקיימים בבסיס הנתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:497,columnNumber:19},void 0),e.jsxDEV("li",{children:["• הנתונים יוחלפו בנתונים מהגיבוי: ",e.jsxDEV("strong",{children:R?.filename},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:498,columnNumber:57},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:498,columnNumber:19},void 0),e.jsxDEV("li",{children:"• פעולה זו אינה הפיכה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:499,columnNumber:19},void 0),e.jsxDEV("li",{children:"• כל המשתמשים המחוברים ייפגעו"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:500,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:496,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:494,columnNumber:15},void 0),!c&&e.jsxDEV("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxDEV(fn,{className:"h-4 w-4 text-yellow-600"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:507,columnNumber:21},void 0),e.jsxDEV("span",{className:"text-yellow-800 font-semibold",children:"המתן לאישור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:508,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:506,columnNumber:19},void 0),e.jsxDEV("p",{className:"text-yellow-700 text-sm",children:["עליך להמתין ",T," שניות לפני שתוכל לאשר את השחזור"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:510,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:505,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:493,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:488,columnNumber:11},void 0),e.jsxDEV(Yn,{children:[e.jsxDEV(Jn,{children:"ביטול"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:518,columnNumber:13},void 0),e.jsxDEV(En,{onClick:()=>R&&_(R.filename),disabled:!c,className:"bg-red-600 hover:bg-red-700",children:c?"אשר שחזור":`המתן (${T})`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:519,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:517,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:487,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:486,columnNumber:7},void 0),e.jsxDEV(Hn,{open:g,onOpenChange:u,children:e.jsxDEV(Gn,{children:[e.jsxDEV(zn,{children:[e.jsxDEV(qn,{children:"מחיקת גיבוי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:534,columnNumber:13},void 0),e.jsxDEV(Kn,{children:['האם אתה בטוח שברצונך למחוק את הגיבוי "',R?.filename,'"? פעולה זו אינה הפיכה.']},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:535,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:533,columnNumber:11},void 0),e.jsxDEV(Yn,{children:[e.jsxDEV(Jn,{children:"ביטול"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:541,columnNumber:13},void 0),e.jsxDEV(En,{onClick:()=>R&&O(R.filename),className:"bg-red-600 hover:bg-red-700",children:"מחק"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:542,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:540,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:532,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:531,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/backup/BackupRestoreTab.tsx",lineNumber:309,columnNumber:5},void 0)},La=()=>{const[n]=Tr(),i=n.get("sub")||"export";return e.jsxDEV("div",{className:"space-y-4 sm:space-y-6",children:e.jsxDEV(Q,{className:"overflow-hidden",children:[e.jsxDEV(me,{className:"p-4 sm:p-6",children:[e.jsxDEV(le,{className:"text-lg sm:text-xl",children:"ניהול נתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:26,columnNumber:11},void 0),e.jsxDEV(xe,{className:"text-sm sm:text-base",children:"ייצוא וייבוא של נתוני המערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:27,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:25,columnNumber:9},void 0),e.jsxDEV(ie,{className:"p-3 sm:p-6 pt-0 sm:pt-0",children:[i==="export"&&e.jsxDEV("div",{className:"space-y-3 sm:space-y-4 pt-2",children:e.jsxDEV(_a,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:34,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:33,columnNumber:13},void 0),i==="import"&&e.jsxDEV("div",{className:"space-y-3 sm:space-y-4 pt-2",children:e.jsxDEV(Ra,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:39,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:38,columnNumber:13},void 0),i==="backup"&&e.jsxDEV("div",{className:"space-y-3 sm:space-y-4 pt-2",children:e.jsxDEV(Ma,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:44,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:43,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:31,columnNumber:9},void 0),e.jsxDEV(tn,{className:"flex justify-between p-4 sm:p-6 pt-0 sm:pt-0",children:e.jsxDEV("div",{className:"text-xs sm:text-sm text-gray-500"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:49,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:48,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:24,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/data-management/DataManagement.tsx",lineNumber:23,columnNumber:5},void 0)},Pa=({form:n,databaseType:i,setDatabaseType:r})=>e.jsxDEV(Ae,{control:n.control,name:"databaseType",render:({field:a})=>e.jsxDEV(Te,{className:"space-y-3",children:[e.jsxDEV(Fe,{children:"סוג בסיס נתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:22,columnNumber:11},void 0),e.jsxDEV(Re,{children:e.jsxDEV(Pr,{onValueChange:m=>{a.onChange(m),r(m)},defaultValue:a.value,value:a.value,className:"flex flex-col space-y-1",children:[e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(un,{value:"supabase",id:"supabase"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:34,columnNumber:17},void 0),e.jsxDEV(U,{htmlFor:"supabase",className:"font-normal mr-2",children:"Supabase (ברירת מחדל)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:35,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:33,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsxDEV(un,{value:"local",id:"local"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:38,columnNumber:17},void 0),e.jsxDEV(U,{htmlFor:"local",className:"font-normal mr-2",children:"בסיס נתונים מקומי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:39,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:37,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:24,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:23,columnNumber:11},void 0),e.jsxDEV(wn,{children:"בחר סוג בסיס הנתונים לשימוש באפליקציה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:43,columnNumber:11},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:46,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:21,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseTypeSelector.tsx",lineNumber:17,columnNumber:5},void 0),Ca=({form:n,isSubmitting:i})=>e.jsxDEV("div",{className:"space-y-4 p-2 sm:p-4 border rounded-md",children:[e.jsxDEV(Ae,{control:n.control,name:"host",render:({field:r})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{className:"text-base font-medium",children:"כתובת שרת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:26,columnNumber:13},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{placeholder:"localhost",className:"h-10 sm:h-9",...r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:28,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:27,columnNumber:13},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:30,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:25,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:21,columnNumber:7},void 0),e.jsxDEV(Ae,{control:n.control,name:"port",render:({field:r})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{className:"text-base font-medium",children:"פורט"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:40,columnNumber:13},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{placeholder:"5432",className:"h-10 sm:h-9",...r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:42,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:41,columnNumber:13},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:44,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:39,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:35,columnNumber:7},void 0),e.jsxDEV(Ae,{control:n.control,name:"database",render:({field:r})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{className:"text-base font-medium",children:"שם בסיס הנתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:54,columnNumber:13},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{placeholder:"postgres",className:"h-10 sm:h-9",...r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:56,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:55,columnNumber:13},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:53,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:49,columnNumber:7},void 0),e.jsxDEV(Ae,{control:n.control,name:"username",render:({field:r})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{className:"text-base font-medium",children:"שם משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:68,columnNumber:13},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{placeholder:"postgres",className:"h-10 sm:h-9",...r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:70,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:69,columnNumber:13},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:72,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:67,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:63,columnNumber:7},void 0),e.jsxDEV(Ae,{control:n.control,name:"password",render:({field:r})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{className:"text-base font-medium",children:"סיסמה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:82,columnNumber:13},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{type:"password",placeholder:"הזן סיסמה",className:"h-10 sm:h-9",...r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:84,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:83,columnNumber:13},void 0),e.jsxDEV(wn,{className:"text-xs sm:text-sm",children:"הסיסמה תישמר באופן מוצפן"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:91,columnNumber:13},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:94,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:81,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:77,columnNumber:7},void 0),e.jsxDEV(Ae,{control:n.control,name:"createSchema",render:({field:r})=>e.jsxDEV(Te,{className:"flex flex-row items-start space-x-3 space-x-reverse space-y-0 rounded-md border p-3 sm:p-4",children:[e.jsxDEV(Re,{children:e.jsxDEV(Ge,{checked:r.value,onCheckedChange:r.onChange,className:"mt-0.5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:105,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:104,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-1 leading-none",children:[e.jsxDEV(Fe,{className:"text-base font-medium",children:"אתחל סכמת בסיס נתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:112,columnNumber:15},void 0),e.jsxDEV(wn,{className:"text-xs sm:text-sm",children:"השתמש באפשרות זו רק אם זהו בסיס נתונים חדש וריק"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:113,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:111,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:103,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:99,columnNumber:7},void 0),e.jsxDEV(Q,{className:"bg-blue-50 mt-4",children:e.jsxDEV(ie,{className:"p-3 sm:p-4 flex items-start",children:[e.jsxDEV(rn,{className:"h-5 w-5 text-blue-500 ml-2 mr-0 sm:mr-2 shrink-0 mt-0.5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:123,columnNumber:11},void 0),e.jsxDEV("p",{className:"text-xs sm:text-sm text-blue-600",children:'אם אתה מגדיר בסיס נתונים חדש, סמן את תיבת הסימון "אתחל סכמת בסיס נתונים". לאחר ההתקנה, תוכל להשתמש בעמוד ייבוא/ייצוא הנתונים כדי לייבא מידע ממערכת קיימת.'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:124,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:122,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:121,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex justify-end pt-4",children:e.jsxDEV(A,{type:"submit",disabled:i,children:[i&&e.jsxDEV(nn,{className:"h-4 w-4 animate-spin ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:133,columnNumber:28},void 0),"שמור הגדרות"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:132,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:131,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/LocalDatabaseForm.tsx",lineNumber:20,columnNumber:5},void 0),Ia=_r({databaseType:li(["supabase","local"]),host:He().optional(),port:He().optional(),database:He().optional(),username:He().optional(),password:He().optional(),createSchema:Dr().optional()}),Wa=`
-- Create required tables
CREATE TABLE IF NOT EXISTS users (
  id UUID PRIMARY KEY,
  email TEXT,
  full_name TEXT,
  username TEXT,
  is_admin BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
);

CREATE TABLE IF NOT EXISTS shows (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  date DATE,
  time TEXT,
  slot_id UUID,
  notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS show_items (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  show_id UUID REFERENCES shows(id),
  position INTEGER NOT NULL,
  name TEXT NOT NULL,
  title TEXT,
  details TEXT,
  phone TEXT,
  duration INTEGER,
  is_break BOOLEAN DEFAULT FALSE,
  is_note BOOLEAN DEFAULT FALSE,
  is_divider BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS interviewees (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  title TEXT,
  phone TEXT,
  duration INTEGER,
  item_id UUID NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS schedule_slots (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  day_of_week SMALLINT NOT NULL,
  start_time TIME WITHOUT TIME ZONE NOT NULL,
  end_time TIME WITHOUT TIME ZONE NOT NULL,
  show_name TEXT NOT NULL,
  host_name TEXT,
  color TEXT DEFAULT 'green',
  is_recurring BOOLEAN DEFAULT TRUE,
  is_collection BOOLEAN DEFAULT FALSE,
  is_prerecorded BOOLEAN DEFAULT FALSE,
  has_lineup BOOLEAN DEFAULT FALSE,
  is_modified BOOLEAN DEFAULT FALSE,
  is_deleted BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now()),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
);

CREATE TABLE IF NOT EXISTS day_notes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  date TEXT NOT NULL,
  note TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE IF NOT EXISTS system_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  key TEXT NOT NULL,
  value TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE IF NOT EXISTS email_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  sender_name TEXT NOT NULL,
  sender_email TEXT NOT NULL,
  subject_template TEXT NOT NULL DEFAULT 'ליינאפ תוכנית {{show_name}}',
  body_template TEXT NOT NULL,
  email_method TEXT DEFAULT 'smtp',
  smtp_host TEXT NOT NULL,
  smtp_port INTEGER NOT NULL,
  smtp_user TEXT NOT NULL,
  smtp_password TEXT NOT NULL,
  gmail_client_id TEXT DEFAULT '',
  gmail_client_secret TEXT DEFAULT '',
  gmail_redirect_uri TEXT DEFAULT '',
  gmail_refresh_token TEXT DEFAULT '',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE IF NOT EXISTS email_recipients (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE IF NOT EXISTS work_arrangements (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  type TEXT NOT NULL,
  week_start DATE NOT NULL,
  filename TEXT NOT NULL,
  url TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

CREATE TABLE IF NOT EXISTS show_email_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  show_id UUID NOT NULL,
  sent_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  success BOOLEAN NOT NULL,
  error_message TEXT
);

-- Create trigger functions for updated_at timestamps
CREATE OR REPLACE FUNCTION handle_updated_at()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = timezone('utc'::text, now());
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create triggers
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_trigger WHERE tgname = 'handle_schedule_slots_updated_at') THEN
    CREATE TRIGGER handle_schedule_slots_updated_at
    BEFORE UPDATE ON schedule_slots
    FOR EACH ROW EXECUTE FUNCTION handle_updated_at();
  END IF;

  IF NOT EXISTS (SELECT 1 FROM pg_trigger WHERE tgname = 'day_notes_updated_at') THEN
    CREATE TRIGGER day_notes_updated_at
    BEFORE UPDATE ON day_notes
    FOR EACH ROW EXECUTE FUNCTION handle_updated_at();
  END IF;

  IF NOT EXISTS (SELECT 1 FROM pg_trigger WHERE tgname = 'set_updated_at') THEN
    CREATE TRIGGER set_updated_at
    BEFORE UPDATE ON email_settings
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
  END IF;

  IF NOT EXISTS (SELECT 1 FROM pg_trigger WHERE tgname = 'set_system_settings_updated_at') THEN
    CREATE TRIGGER set_system_settings_updated_at
    BEFORE UPDATE ON system_settings
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
  END IF;
END $$;
`,Ua=()=>{const[n,i]=t.useState(!1),[r,a]=t.useState("supabase"),[m,s]=t.useState({databaseType:"supabase",host:"",port:"",database:"",username:"",password:"",createSchema:!1}),o=Fr({resolver:Rr(Ia),defaultValues:m});return t.useEffect(()=>{(async()=>{i(!0);try{const{data:d,error:j}=await ae.from("system-settings").select("key, value").match({key:"database_config"}).single();if(d&&!j){const b=JSON.parse(d.value),v={...b,createSchema:!1};s(v),a(b.databaseType||"supabase"),o.reset(v)}}catch(d){console.error("Error fetching database configuration:",d)}finally{i(!1)}})()},[o]),t.useEffect(()=>{const h=o.watch((d,{name:j})=>{j==="databaseType"&&d.databaseType&&a(d.databaseType)});return()=>h.unsubscribe()},[o]),{form:o,databaseType:r,setDatabaseType:a,isLoading:n,setIsLoading:i,currentConfig:m}},Oa=n=>{const{toast:i}=De(),[r,a]=t.useState(!1),m=async o=>{try{const h=await fetch("/api/admin/database/schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sql:Wa})});if(!h.ok){const j=await h.json().catch(()=>({}));throw new Error(j.error||`HTTP error! status: ${h.status}`)}const d=await h.json();if(!d.success)throw new Error(d.error);return!0}catch(h){return console.error("Error initializing database schema:",h),i({title:"שגיאה ביצירת סכמת בסיס הנתונים",description:h instanceof Error?h.message:"אירעה שגיאה בעת יצירת הטבלאות",variant:"destructive"}),!1}};return{handleSubmit:n.handleSubmit(async o=>{a(!0);try{if(o.databaseType==="local"){if(!o.host||!o.port||!o.database||!o.username||!o.password){i({title:"שגיאה",description:"יש למלא את כל השדות הנדרשים",variant:"destructive"});return}const j=await fetch("/api/admin/database/switch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"local",config:{host:o.host,port:o.port,database:o.database,username:o.username,password:o.password}})});if(!j.ok){const b=await j.json().catch(()=>({}));throw new Error(b.error||`Failed to switch database: ${j.statusText}`)}if(o.createSchema&&!await m(o))return}else throw new Error("Supabase URL not configured");const h={...o};delete h.createSchema,delete h.password;const{error:d}=await ae.from("system-settings").upsert({key:"database_config",value:JSON.stringify(h)});if(d)throw d;i({title:"ההגדרות נשמרו בהצלחה",description:o.databaseType==="supabase"?"התצורה עודכנה להשתמש בבסיס הנתונים של Supabase":o.createSchema?"התצורה עודכנה להשתמש בבסיס נתונים מקומי וסכמת הנתונים אותחלה":"התצורה עודכנה להשתמש בבסיס נתונים מקומי"}),setTimeout(()=>window.location.reload(),1e3)}catch(h){console.error("Error saving database configuration:",h),i({title:"שגיאה בשמירת ההגדרות",description:h instanceof Error?h.message:"אירעה שגיאה בעת שמירת הגדרות בסיס הנתונים",variant:"destructive"})}finally{a(!1)}}),isSubmitting:r}},$a=()=>{const{form:n,databaseType:i,setDatabaseType:r,isLoading:a}=Ua(),{handleSubmit:m,isSubmitting:s}=Oa(n);return a?e.jsxDEV("div",{children:"Loading database settings..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:23,columnNumber:12},void 0):e.jsxDEV(Q,{className:"w-full",children:[e.jsxDEV(me,{children:e.jsxDEV(le,{children:"הגדרות בסיס נתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:29,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:28,columnNumber:7},void 0),e.jsxDEV(ie,{children:e.jsxDEV(Mr,{...n,children:e.jsxDEV("form",{onSubmit:m,className:"space-y-8",children:[e.jsxDEV(Pa,{databaseType:i,setDatabaseType:r,form:n},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:34,columnNumber:13},void 0),i==="local"&&e.jsxDEV(Ca,{isSubmitting:s,form:n},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:41,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:33,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:32,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:31,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/database-settings/DatabaseSettings.tsx",lineNumber:27,columnNumber:5},void 0)};function Ba(){const[n,i]=t.useState(0),[r,a]=t.useState(!1),[m,s]=t.useState(""),{toast:o}=De();t.useEffect(()=>{h()},[]);const h=async()=>{const{data:b,error:v}=await ae.from("system-settings").select("value").eq("key","schedule_data_offset").single();!v&&b&&i(parseInt(b.value)||0)},d=async()=>{a(!0);try{const{data:b}=await ae.functions.invoke("generate-schedule-xml",{body:{previewOffset:n}}),x=new DOMParser().parseFromString(b,"text/xml").getElementsByTagName("show");let E=`### Preview of first 3 shows with offset:

`;for(let S=0;S<Math.min(x.length,3);S++){const g=x[S],u=g.getElementsByTagName("date")[0]?.textContent,R=g.getElementsByTagName("start_time")[0]?.textContent,V=g.getElementsByTagName("combined")[0]?.textContent;E+=`${u||"N/A"} - ${R||"N/A"} - ${V||"N/A"}
`}s(E)}catch(b){console.error("Error previewing data:",b),o({variant:"destructive",title:"Error previewing data",description:"Failed to generate preview with the new offset."})}finally{a(!1)}},j=async()=>{a(!0);try{const{error:b}=await ae.from("system-settings").upsert({key:"schedule_data_offset",value:n.toString(),updated_at:new Date().toISOString()});if(b)throw b;await Promise.all([ae.functions.invoke("generate-schedule-xml"),ae.functions.invoke("generate-schedule-json")]),o({title:"Settings saved",description:"Schedule data offset updated and files regenerated."})}catch(b){console.error("Error saving settings:",b),o({variant:"destructive",title:"Error saving settings",description:"Failed to save offset settings."})}finally{a(!1)}};return e.jsxDEV("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsxDEV("h3",{className:"text-lg font-semibold",children:"Schedule Data Offset"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:104,columnNumber:7},this),e.jsxDEV("p",{className:"text-sm text-gray-600",children:["Adjust the data offset (in days) to control which shows appear in the XML/JSON exports. Current server time: ",re(new Date,"yyyy-MM-dd HH:mm:ss")]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:105,columnNumber:7},this),e.jsxDEV("div",{className:"flex items-center gap-4",children:[e.jsxDEV($,{type:"number",value:n,onChange:b=>i(parseInt(b.target.value)||0),className:"w-32",placeholder:"Offset (days)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:111,columnNumber:9},this),e.jsxDEV(A,{onClick:d,variant:"outline",disabled:r,children:[r?e.jsxDEV(nn,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:123,columnNumber:22},this):null,"Preview"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:118,columnNumber:9},this),e.jsxDEV(A,{onClick:j,disabled:r,children:[r?e.jsxDEV(nn,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:130,columnNumber:22},this):null,"Save & Update Files"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:126,columnNumber:9},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:110,columnNumber:7},this),m&&e.jsxDEV("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:e.jsxDEV("pre",{className:"text-sm whitespace-pre-wrap",children:m},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:137,columnNumber:11},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:136,columnNumber:9},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportOffset.tsx",lineNumber:103,columnNumber:5},this)}const Xa=()=>{const[n,i]=t.useState("10"),[r,a]=t.useState(null),[m,s]=t.useState(!1),[o,h]=t.useState(!1),[d,j]=t.useState(null),{toast:b}=De();t.useEffect(()=>{(async()=>{try{const{data:S,error:g}=await ae.from("system-settings").select("value").eq("key","schedule_xml_refresh_interval").maybeSingle();!g&&S&&S.value&&i(S.value);const{data:u,error:R}=await ae.from("system-settings").select("value, updated_at").eq("key","schedule_xml").maybeSingle();if(!R&&u){if(u.updated_at){const V=new Date(u.updated_at);a(V.toLocaleString())}u.value&&j(u.value.substring(0,100)+"...")}}catch(S){console.error("Error fetching XML settings:",S)}})()},[]);const v=async()=>{try{const E=parseInt(n);if(isNaN(E)||E<1){b({title:"ערך לא תקין",description:"יש להזין מספר חיובי של דקות",variant:"destructive"});return}console.log("Saving refresh interval:",n);const{error:S}=await ae.from("system-settings").upsert({key:"schedule_xml_refresh_interval",value:n},{onConflict:"key"});if(S)throw console.error("Error saving refresh interval:",S),S;b({title:"הגדרות נשמרו בהצלחה",description:`מרווח רענון עודכן ל-${n} דקות`})}catch(E){console.error("Error saving refresh interval:",E),b({title:"שגיאה בשמירת ההגדרות",description:"אנא נסה שנית מאוחר יותר",variant:"destructive"})}},N=async()=>{h(!0);try{console.log("Updating scheduler...");const E=parseInt(n);!isNaN(E)&&E>=1&&await ae.from("system-settings").upsert({key:"schedule_xml_refresh_interval",value:n},{onConflict:"key"});const{data:S,error:g}=await ae.functions.invoke("schedule-xml-refresh",{body:{refreshInterval:n}});if(g)throw console.error("Error from edge function:",g),g;console.log("Scheduler update response:",S),b({title:"מתזמן העדכונים הופעל",description:`קובץ ה-XML יתעדכן כל ${n} דקות`}),await x()}catch(E){console.error("Error updating scheduler:",E),b({title:"שגיאה בהפעלת מתזמן העדכונים",description:"אנא נסה שנית מאוחר יותר",variant:"destructive"})}finally{h(!1)}},x=async()=>{s(!0);try{console.log("Refreshing XML...");const{data:E,error:S}=await ae.functions.invoke("generate-schedule-xml");if(S)throw console.error("Error from generate function:",S),S;console.log("XML refresh response length:",E?E.length:0);const{data:g,error:u}=await ae.from("system-settings").select("value, updated_at").eq("key","schedule_xml").maybeSingle();if(u)console.error("Error fetching updated XML:",u);else if(g){if(g.updated_at){const R=new Date(g.updated_at);a(R.toLocaleString())}g.value&&j(g.value.substring(0,100)+"...")}b({title:"XML עודכן בהצלחה",description:`עודכן בתאריך ${new Date().toLocaleString()}`})}catch(E){console.error("Error refreshing XML:",E),b({title:"שגיאה בעדכון ה-XML",description:"אנא נסה שנית מאוחר יותר",variant:"destructive"})}finally{s(!1)}};return e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"הגדרות Schedule XML"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:202,columnNumber:9},void 0),e.jsxDEV(xe,{children:"ניהול קובץ XML של לוח השידורים המתעדכן אוטומטית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:203,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:201,columnNumber:7},void 0),e.jsxDEV(ie,{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-1",children:[e.jsxDEV(U,{htmlFor:"xml-url",children:"כתובת הקובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:209,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:e.jsxDEV($,{id:"xml-url",value:`${window.location.origin}/schedule.xml`,readOnly:!0,onClick:E=>{E.target.select(),navigator.clipboard.writeText(E.target.value),b({title:"הכתובת הועתקה ללוח"})},className:"font-mono text-sm"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:211,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:210,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:208,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-1",children:[e.jsxDEV(U,{htmlFor:"refresh-interval",children:"מרווח רענון (דקות)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:226,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV($,{id:"refresh-interval",type:"number",min:"1",value:n,onChange:E=>i(E.target.value),className:"w-24"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:228,columnNumber:13},void 0),e.jsxDEV(A,{onClick:v,children:[e.jsxDEV(fn,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:237,columnNumber:15},void 0),"שמור"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:236,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:227,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:225,columnNumber:9},void 0),r&&e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:["עודכן לאחרונה: ",r]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:244,columnNumber:11},void 0),d&&e.jsxDEV("div",{className:"p-2 bg-muted rounded text-xs font-mono mt-2 overflow-x-auto",children:e.jsxDEV("p",{className:"whitespace-pre-wrap",children:d},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:251,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:250,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:207,columnNumber:7},void 0),e.jsxDEV(tn,{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center w-full",children:[e.jsxDEV(A,{onClick:x,disabled:m,className:"w-full sm:w-auto",children:[e.jsxDEV(Me,{className:`h-4 w-4 mr-2 ${m?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:261,columnNumber:11},void 0),m?"מרענן...":"רענן עכשיו"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:256,columnNumber:9},void 0),e.jsxDEV(A,{onClick:N,variant:"outline",disabled:o,className:"w-full sm:w-auto",children:[e.jsxDEV(ui,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:271,columnNumber:11},void 0),o?"מפעיל מתזמן...":"הפעל מתזמן"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:265,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:255,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleXMLSettings.tsx",lineNumber:200,columnNumber:5},void 0)},Ha=_r({server:He().min(1,{message:"שרת FTP נדרש"}),port:He().refine(n=>!isNaN(Number(n))&&Number(n)>0&&Number(n)<=65535,{message:"פורט חייב להיות מספר תקין בין 1 ל-65535"}),username:He().min(1,{message:"שם משתמש נדרש"}),password:He().min(1,{message:"סיסמה נדרשת"}),remotePath:He().optional(),passive:Dr().default(!0),autoUpload:Dr().default(!1),interval:He().refine(n=>!isNaN(Number(n))&&Number(n)>0,{message:"מרווח זמן חייב להיות מספר חיובי"}).default("60")}),Ga=()=>{const[n,i]=t.useState(!1),[r,a]=t.useState(!1),[m,s]=t.useState(!1),[o,h]=t.useState(null),[d,j]=t.useState(null),[b,v]=t.useState([]),{toast:N}=De(),x=Fr({resolver:Rr(Ha),defaultValues:{server:"",port:"21",username:"",password:"",remotePath:"/",passive:!0,autoUpload:!1,interval:"60"}});t.useEffect(()=>{(async()=>{try{const{data:c,error:k}=await ae.from("system-settings").select("value").eq("key","ftp_settings").maybeSingle();if(!k&&c?.value)try{const f=JSON.parse(c.value);x.reset({server:f.server||"",port:f.port||"21",username:f.username||"",password:f.password||"",remotePath:f.remotePath||"/",passive:f.passive??!0,autoUpload:f.autoUpload??!1,interval:f.interval||"60"}),f.lastUploaded&&h(f.lastUploaded)}catch(f){console.error("Error parsing FTP settings:",f)}await E()}catch(c){console.error("Error loading settings:",c)}})()},[]);const E=async()=>{try{const{data:l,error:c}=await ae.from("system-settings").select("value, updated_at").eq("key","schedule_xml").maybeSingle();!c&&l?.value?j(l.value):j(null)}catch(l){console.error("Error loading XML preview:",l)}},S=l=>{const c=new Date().toLocaleTimeString();v(k=>[`[${c}] ${l}`,...k.slice(0,199)])},g=async l=>{i(!0),S("שומר הגדרות FTP...");try{const c={...l,lastUploaded:o},{error:k}=await ae.from("system-settings").upsert({key:"ftp_settings",value:JSON.stringify(c)},{onConflict:"key"});if(k)throw k;N({title:"הגדרות FTP נשמרו בהצלחה",description:"כל ההגדרות נשמרו במסד הנתונים"}),S("הגדרות FTP נשמרו בהצלחה")}catch(c){console.error("Error saving FTP settings:",c),N({title:"שגיאה בשמירת הגדרות FTP",description:c instanceof Error?c.message:"שגיאה לא ידועה",variant:"destructive"}),S(`שגיאה בשמירת הגדרות: ${c instanceof Error?c.message:"שגיאה לא ידועה"}`)}finally{i(!1)}},u=async()=>{s(!0);const l=x.getValues();S(`בודק חיבור ל-FTP: ${l.server}:${l.port}`);try{const k=await(await fetch("/api/test-ftp-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server:l.server,port:l.port,username:l.username,password:l.password,passive:l.passive})})).json();if(k.success)N({title:"חיבור FTP הצליח",description:"החיבור לשרת FTP נוצר בהצלחה"}),S("חיבור FTP הצליח"),k.directoryContents?.length>0&&S(`תוכן תיקיה: ${k.directoryContents.join(", ")}`);else throw new Error(k.error||"שגיאה לא ידועה")}catch(c){console.error("Error testing FTP connection:",c),N({title:"שגיאה בחיבור FTP",description:c instanceof Error?c.message:"שגיאה לא ידועה",variant:"destructive"}),S(`שגיאה בחיבור FTP: ${c instanceof Error?c.message:"שגיאה לא ידועה"}`)}finally{s(!1)}},R=async()=>{a(!0);const l=x.getValues();S(`מעלה קובץ XML לשרת FTP: ${l.server}:${l.port}`);try{const k=await(await fetch("/api/upload-xml-ftp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server:l.server,port:l.port,username:l.username,password:l.password,remotePath:l.remotePath,passive:l.passive})})).json();if(k.success){const f=new Date().toLocaleString();h(f);const F={...x.getValues(),lastUploaded:f};await ae.from("system-settings").upsert({key:"ftp_settings",value:JSON.stringify(F)},{onConflict:"key"}),N({title:"קובץ XML הועלה בהצלחה",description:`הקובץ הועלה ב-${f}`}),S("קובץ XML הועלה בהצלחה")}else throw new Error(k.error||"שגיאה לא ידועה")}catch(c){console.error("Error uploading XML to FTP:",c),N({title:"שגיאה בהעלאת קובץ XML",description:c instanceof Error?c.message:"שגיאה לא ידועה",variant:"destructive"}),S(`שגיאה בהעלאת קובץ XML: ${c instanceof Error?c.message:"שגיאה לא ידועה"}`)}finally{a(!1)}},V=async()=>{S("מייצר XML ומעלה לשרת FTP..."),a(!0);try{const{data:l,error:c}=await ae.functions.invoke("generate-schedule-xml");if(c)throw new Error(`שגיאה בייצור XML: ${c.message}`);S("XML יוצר בהצלחה, מעלה לשרת FTP..."),await E(),await R()}catch(l){console.error("Error generating and uploading XML:",l),N({title:"שגיאה בייצור והעלאת XML",description:l instanceof Error?l.message:"שגיאה לא ידועה",variant:"destructive"}),S(`שגיאה בייצור והעלאת XML: ${l instanceof Error?l.message:"שגיאה לא ידועה"}`)}finally{a(!1)}},T=async()=>{const c=!x.getValues("autoUpload");x.setValue("autoUpload",c),await g(x.getValues()),S(c?`הפעלת העלאה אוטומטית כל ${x.getValues("interval")} דקות`:"השבתת העלאה אוטומטית")};return e.jsxDEV(Q,{className:"relative",children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"העלאת XML ל-FTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:332,columnNumber:9},void 0),e.jsxDEV(xe,{children:"הגדרת העלאה אוטומטית של לוח שידורים XML לשרת FTP חיצוני"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:333,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:331,columnNumber:7},void 0),e.jsxDEV(ie,{className:"space-y-6",children:[e.jsxDEV(Mr,{...x,children:e.jsxDEV("form",{onSubmit:x.handleSubmit(g),className:"space-y-4",children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV(Ae,{control:x.control,name:"server",render:({field:l})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"שרת FTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:346,columnNumber:21},void 0),e.jsxDEV(Re,{children:e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(yt,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:349,columnNumber:25},void 0),e.jsxDEV($,{placeholder:"ftp.example.com",...l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:350,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:348,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:347,columnNumber:21},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:353,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:345,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:341,columnNumber:15},void 0),e.jsxDEV(Ae,{control:x.control,name:"port",render:({field:l})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"פורט"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:363,columnNumber:21},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{type:"number",placeholder:"21",...l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:365,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:364,columnNumber:21},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:367,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:362,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:358,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:340,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV(Ae,{control:x.control,name:"username",render:({field:l})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"שם משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:379,columnNumber:21},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{placeholder:"username",...l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:381,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:380,columnNumber:21},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:383,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:378,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:374,columnNumber:15},void 0),e.jsxDEV(Ae,{control:x.control,name:"password",render:({field:l})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"סיסמה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:393,columnNumber:21},void 0),e.jsxDEV(Re,{children:e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(wt,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:396,columnNumber:25},void 0),e.jsxDEV($,{type:"password",placeholder:"••••••••",...l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:397,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:395,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:394,columnNumber:21},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:400,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:392,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:388,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:373,columnNumber:13},void 0),e.jsxDEV(Ae,{control:x.control,name:"remotePath",render:({field:l})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"נתיב בשרת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:411,columnNumber:19},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{placeholder:"/public_html/xml",...l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:413,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:412,columnNumber:19},void 0),e.jsxDEV(wn,{children:"הנתיב לתיקיה בשרת FTP היעד (השאר / לתיקיה הראשית)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:415,columnNumber:19},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:418,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:410,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:406,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxDEV(Ae,{control:x.control,name:"passive",render:({field:l})=>e.jsxDEV(Te,{className:"flex flex-row items-start space-x-3 space-y-0 mb-4",children:[e.jsxDEV(Re,{children:e.jsxDEV(Ge,{checked:l.value,onCheckedChange:l.onChange},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:430,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:429,columnNumber:21},void 0),e.jsxDEV("div",{className:"space-y-1 leading-none mr-3",children:[e.jsxDEV(Fe,{children:e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV(kt,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:438,columnNumber:27},void 0),"חיבור פסיבי"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:437,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:436,columnNumber:23},void 0),e.jsxDEV(wn,{children:"מומלץ להשאיר מסומן עבור רוב שרתי ה-FTP"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:442,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:435,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:428,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:424,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-end space-x-2 pb-1",children:[e.jsxDEV(A,{type:"button",variant:"outline",onClick:u,disabled:m||!x.getValues("server"),children:m?"בודק...":"בדוק חיבור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:451,columnNumber:17},void 0),e.jsxDEV(A,{type:"submit",disabled:n,children:[e.jsxDEV(Ln,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:464,columnNumber:19},void 0),n?"שומר...":"שמור הגדרות"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:460,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:450,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:423,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t mt-6",children:[e.jsxDEV(Ae,{control:x.control,name:"autoUpload",render:({field:l})=>e.jsxDEV(Te,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsxDEV(Re,{children:e.jsxDEV(Ge,{checked:l.value,onCheckedChange:l.onChange,className:"mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:477,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:476,columnNumber:21},void 0),e.jsxDEV("div",{className:"space-y-1 leading-none flex-1",children:e.jsxDEV(Fe,{className:"font-medium",children:"העלאה אוטומטית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:484,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:483,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:475,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:471,columnNumber:15},void 0),e.jsxDEV(Ae,{control:x.control,name:"interval",render:({field:l})=>e.jsxDEV(Te,{children:[e.jsxDEV(Fe,{children:"מרווח זמן (דקות)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:497,columnNumber:21},void 0),e.jsxDEV(Re,{children:e.jsxDEV($,{type:"number",min:"1",...l},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:499,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:498,columnNumber:21},void 0),e.jsxDEV(Ie,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:501,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:496,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:492,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:470,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:339,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:338,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"flex justify-between items-center",children:[e.jsxDEV("h3",{className:"text-md font-semibold",children:"תצוגה מקדימה של ה-XML"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:511,columnNumber:13},void 0),d&&e.jsxDEV("div",{className:"text-sm text-muted-foreground",children:["אורך: ",d.length," תווים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:513,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:510,columnNumber:11},void 0),e.jsxDEV("div",{className:"p-2 bg-muted rounded text-xs font-mono mt-2 overflow-x-auto max-h-40 overflow-y-auto",children:d?e.jsxDEV("pre",{className:"whitespace-pre-wrap",children:d},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:521,columnNumber:15},void 0):e.jsxDEV("p",{className:"text-muted-foreground",children:"אין XML זמין. יש ליצור קודם."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:523,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:519,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:509,columnNumber:9},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"text-md font-semibold mb-2",children:"לוג פעולות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:529,columnNumber:11},void 0),e.jsxDEV("div",{className:"border rounded-md p-2 h-40 overflow-y-auto bg-muted/50 text-xs font-mono",children:b.length===0?e.jsxDEV("div",{className:"text-muted-foreground p-2",children:"אין פעולות לוג עדיין"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:532,columnNumber:15},void 0):b.map((l,c)=>e.jsxDEV("div",{className:"py-1 border-b border-muted last:border-0",children:l},c,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:535,columnNumber:17},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:530,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:528,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:337,columnNumber:7},void 0),e.jsxDEV(tn,{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center w-full",children:[e.jsxDEV(A,{onClick:R,disabled:r||!x.getValues("server"),className:"w-full sm:w-auto",children:[e.jsxDEV(Tn,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:549,columnNumber:11},void 0),r?"מעלה...":"העלה עכשיו"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:544,columnNumber:9},void 0),e.jsxDEV(A,{onClick:V,variant:"outline",disabled:r||!x.getValues("server"),className:"w-full sm:w-auto",children:[e.jsxDEV(Me,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:559,columnNumber:11},void 0),r?"מעבד...":"צור והעלה מחדש"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:553,columnNumber:9},void 0),e.jsxDEV(A,{onClick:T,variant:x.getValues("autoUpload")?"destructive":"default",className:"w-full sm:w-auto",children:[e.jsxDEV(ui,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:568,columnNumber:11},void 0),x.getValues("autoUpload")?"כבה העלאה אוטומטית":"הפעל העלאה אוטומטית"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:563,columnNumber:9},void 0),o&&e.jsxDEV("span",{className:"text-sm text-muted-foreground mr-auto mt-2 sm:mt-0",children:["עודכן לאחרונה: ",o]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:573,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:543,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/FTPXMLSettings.tsx",lineNumber:330,columnNumber:5},void 0)},za=()=>e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV(Ba,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportSettings.tsx",lineNumber:10,columnNumber:7},void 0),e.jsxDEV(Xa,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportSettings.tsx",lineNumber:11,columnNumber:7},void 0),e.jsxDEV(Ga,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportSettings.tsx",lineNumber:12,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/ScheduleExportSettings.tsx",lineNumber:9,columnNumber:5},void 0),qa=({user:n,onEdit:i,onDelete:r,onResetPassword:a})=>{const m=()=>{window.confirm("האם אתה בטוח שברצונך למחוק משתמש זה?")&&r(n.id)},s=()=>{window.confirm("האם אתה בטוח שברצונך לאפס את הסיסמה של משתמש זה?")&&a(n.id)};return e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(In,{children:e.jsxDEV(Wn,{children:[e.jsxDEV(Un,{asChild:!0,children:e.jsxDEV(A,{variant:"ghost",size:"icon",onClick:()=>i(n),children:e.jsxDEV(oi,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:43,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:38,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:37,columnNumber:11},void 0),e.jsxDEV(On,{children:e.jsxDEV("p",{children:"ערוך משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:47,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:46,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:36,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:35,columnNumber:7},void 0),e.jsxDEV(In,{children:e.jsxDEV(Wn,{children:[e.jsxDEV(Un,{asChild:!0,children:e.jsxDEV(A,{variant:"outline",size:"icon",onClick:s,children:e.jsxDEV(xr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:60,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:55,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:54,columnNumber:11},void 0),e.jsxDEV(On,{children:e.jsxDEV("p",{children:"איפוס סיסמה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:64,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:63,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:53,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:52,columnNumber:7},void 0),e.jsxDEV(In,{children:e.jsxDEV(Wn,{children:[e.jsxDEV(Un,{asChild:!0,children:e.jsxDEV(A,{variant:"destructive",size:"icon",onClick:m,children:e.jsxDEV(kn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:77,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:72,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:71,columnNumber:11},void 0),e.jsxDEV(On,{children:e.jsxDEV("p",{children:"מחק משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:81,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:80,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:70,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:69,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserActions.tsx",lineNumber:34,columnNumber:5},void 0)},Ka=({user:n,onEdit:i,onDelete:r,onResetPassword:a})=>{const m=n.id&&(n.title?.toLowerCase().includes("producer")||n.title?.includes("מפיק")||n.title?.includes("הפקה"));return e.jsxDEV(he,{children:[e.jsxDEV(Z,{children:n.username||n.email?.split("@")[0]},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:24,columnNumber:7},void 0),e.jsxDEV(Z,{dir:"ltr",children:n.email},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:25,columnNumber:7},void 0),e.jsxDEV(Z,{children:n.full_name||"-"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:26,columnNumber:7},void 0),e.jsxDEV(Z,{children:[n.title?n.title:"-",n.id&&n.id.startsWith("00000000-0000-0000-0000")&&e.jsxDEV(dn,{variant:"outline",className:"ml-2",children:"מערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:30,columnNumber:11},void 0),m&&e.jsxDEV(dn,{variant:"secondary",className:"ml-2",children:"מפיק"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:33,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:27,columnNumber:7},void 0),e.jsxDEV(Z,{children:n.is_admin?e.jsxDEV(dn,{className:"bg-blue-500",children:"מנהל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:38,columnNumber:11},void 0):e.jsxDEV(dn,{variant:"outline",children:"משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:39,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:36,columnNumber:7},void 0),e.jsxDEV(Z,{children:e.jsxDEV(qa,{user:n,onEdit:i,onDelete:r,onResetPassword:a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:43,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:42,columnNumber:7},void 0)]},n.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserRow.tsx",lineNumber:23,columnNumber:5},void 0)},Ya=()=>e.jsxDEV(en,{children:Array.from({length:5}).map((n,i)=>e.jsxDEV(he,{children:[e.jsxDEV(Z,{children:e.jsxDEV(An,{className:"h-5 w-24"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:11,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:11,columnNumber:11},void 0),e.jsxDEV(Z,{children:e.jsxDEV(An,{className:"h-5 w-32"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:12,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:12,columnNumber:11},void 0),e.jsxDEV(Z,{children:e.jsxDEV(An,{className:"h-5 w-28"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:13,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:13,columnNumber:11},void 0),e.jsxDEV(Z,{children:e.jsxDEV(An,{className:"h-5 w-16"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:14,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:14,columnNumber:11},void 0),e.jsxDEV(Z,{children:e.jsxDEV(An,{className:"h-8 w-16"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:15,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:15,columnNumber:11},void 0)]},i,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:10,columnNumber:9},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserListLoading.tsx",lineNumber:8,columnNumber:5},void 0),Ja=({users:n,onEdit:i,onDelete:r,onResetPassword:a,isLoading:m})=>m?e.jsxDEV(Ze,{className:"direction-rtl",children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{className:"text-right",children:"שם משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:35,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"אימייל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:36,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"שם מלא"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:37,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"תפקיד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:38,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"הרשאה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:39,columnNumber:13},void 0),e.jsxDEV(ee,{className:"text-right",children:"פעולות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:34,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:33,columnNumber:9},void 0),e.jsxDEV(Ya,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:43,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:32,columnNumber:7},void 0):e.jsxDEV(Ze,{dir:"rtl",children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{className:"text-right",children:"שם משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:52,columnNumber:11},void 0),e.jsxDEV(ee,{className:"text-right",children:"אימייל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:53,columnNumber:11},void 0),e.jsxDEV(ee,{className:"text-right",children:"שם מלא"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:54,columnNumber:11},void 0),e.jsxDEV(ee,{className:"text-right",children:"תפקיד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:55,columnNumber:11},void 0),e.jsxDEV(ee,{className:"text-right",children:"הרשאה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:56,columnNumber:11},void 0),e.jsxDEV(ee,{className:"text-right",children:"פעולות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:57,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:51,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:50,columnNumber:7},void 0),e.jsxDEV(en,{children:n?.length===0?e.jsxDEV(he,{children:e.jsxDEV(Z,{colSpan:6,className:"text-center py-8",children:"לא נמצאו משתמשים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:63,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:62,columnNumber:11},void 0):n?.map(s=>e.jsxDEV(Ka,{user:s,onEdit:i,onDelete:r,onResetPassword:a},s.id,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:67,columnNumber:13},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:60,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserList.tsx",lineNumber:49,columnNumber:5},void 0),Ei=({user:n,setUser:i,onSubmit:r,submitLabel:a,isLoading:m})=>e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{children:[e.jsxDEV(U,{htmlFor:"email",children:"אימייל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:27,columnNumber:9},void 0),e.jsxDEV($,{id:"email",value:n.email||"",onChange:s=>i({...n,email:s.target.value}),dir:"ltr"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:28,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:26,columnNumber:7},void 0),e.jsxDEV("div",{children:[e.jsxDEV(U,{htmlFor:"username",children:"שם משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:36,columnNumber:9},void 0),e.jsxDEV($,{id:"username",value:n.username||"",onChange:s=>i({...n,username:s.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:37,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:35,columnNumber:7},void 0),e.jsxDEV("div",{children:[e.jsxDEV(U,{htmlFor:"full_name",children:"שם מלא"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:44,columnNumber:9},void 0),e.jsxDEV($,{id:"full_name",value:n.full_name||"",onChange:s=>i({...n,full_name:s.target.value})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:45,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:43,columnNumber:7},void 0),!n.id&&e.jsxDEV("div",{children:[e.jsxDEV(U,{htmlFor:"password",children:"סיסמה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:54,columnNumber:11},void 0),e.jsxDEV($,{id:"password",type:"password",value:n.password||"",onChange:s=>i({...n,password:s.target.value}),dir:"ltr"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:55,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:53,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(Ge,{id:"is_admin",checked:n.is_admin||!1,onCheckedChange:s=>i({...n,is_admin:s===!0})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:66,columnNumber:9},void 0),e.jsxDEV(U,{htmlFor:"is_admin",className:"cursor-pointer",children:"מנהל מערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:73,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:65,columnNumber:7},void 0),e.jsxDEV(A,{onClick:r,className:"w-full",disabled:m,children:m?"מעבד...":a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:76,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserForm.tsx",lineNumber:25,columnNumber:5},void 0),Za=()=>$n({queryKey:["users"],queryFn:async()=>{const{data:n}=await G.query("/auth/users");return n}}),Qa=()=>{const{toast:n}=De(),i=yr(),r=vn({mutationFn:async s=>{const{data:o,error:h}=await G.mutate("/auth/users",s);if(h)throw h.response?.status===409?new Error("משתמש עם כתובת אימייל זו כבר קיים במערכת"):h.response?.data?.error?new Error(h.response.data.error):new Error("שגיאה ביצירת המשתמש");return o},onSuccess:()=>{i.invalidateQueries({queryKey:["users"]}),n({title:"המשתמש נוצר בהצלחה"})},onError:s=>{n({title:"שגיאה",description:s.message,variant:"destructive"})}}),a=vn({mutationFn:async s=>{const{data:o}=await G.mutate(`/auth/users/${s.id}`,s,"PUT");return o},onSuccess:()=>{i.invalidateQueries({queryKey:["users"]}),n({title:"המשתמש עודכן בהצלחה"})},onError:s=>{n({title:"שגיאה",description:"שגיאה בעדכון המשתמש: "+s.message,variant:"destructive"})}}),m=vn({mutationFn:async s=>{const{data:o}=await G.mutate(`/auth/users/${s}/reset-password`,{},"POST");return o},onSuccess:s=>{i.invalidateQueries({queryKey:["users"]}),n({title:"הסיסמה אופסה בהצלחה",description:`הסיסמה החדשה: ${s.password}`})},onError:s=>{n({title:"שגיאה",description:"שגיאה באיפוס הסיסמה: "+s.message,variant:"destructive"})}});return{createUserMutation:r,updateUserMutation:a,resetPasswordMutation:m}},eo=()=>{const{toast:n}=De(),i=yr(),r=vn({mutationFn:async m=>{await G.mutate(`/auth/users/${m}`,{},"DELETE")},onSuccess:()=>{i.invalidateQueries({queryKey:["users"]}),n({title:"המשתמש נמחק בהצלחה"})},onError:m=>{n({title:"שגיאה",description:"שגיאה במחיקת המשתמש: "+m.message,variant:"destructive"})}}),a=vn({mutationFn:async m=>{await G.mutate(`/auth/users/email/${m}`,{},"DELETE")},onSuccess:()=>{i.invalidateQueries({queryKey:["users"]}),n({title:"המשתמש נמחק בהצלחה"})},onError:m=>{n({title:"שגיאה",description:"שגיאה במחיקת המשתמש: "+m.message,variant:"destructive"})}});return{deleteUserMutation:r,deleteUserByEmailMutation:a}},or=()=>{const{data:n,isLoading:i,error:r}=Za(),{createUserMutation:a,updateUserMutation:m,resetPasswordMutation:s}=Qa(),{deleteUserMutation:o,deleteUserByEmailMutation:h}=eo();return{users:n,isLoading:i,error:r,createUserMutation:a,updateUserMutation:m,resetPasswordMutation:s,deleteUserMutation:o,deleteUserByEmailMutation:h}},no=({isOpen:n,setIsOpen:i,selectedUser:r,setSelectedUser:a})=>{const{updateUserMutation:m}=or();return e.jsxDEV(qe,{open:n,onOpenChange:i,children:e.jsxDEV(Ke,{children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{className:"text-right",children:"עריכת משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/EditUserDialog.tsx",lineNumber:32,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/EditUserDialog.tsx",lineNumber:31,columnNumber:9},void 0),r&&e.jsxDEV(Ei,{user:r,setUser:a,onSubmit:()=>m.mutate(r),submitLabel:"עדכן משתמש",isLoading:m.isPending},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/EditUserDialog.tsx",lineNumber:35,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/EditUserDialog.tsx",lineNumber:30,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/EditUserDialog.tsx",lineNumber:29,columnNumber:5},void 0)},ro=({isOpen:n,setIsOpen:i,newUser:r,setNewUser:a})=>{const{createUserMutation:m}=or();return e.jsxDEV(qe,{open:n,onOpenChange:i,children:[e.jsxDEV(Hi,{asChild:!0,children:e.jsxDEV(A,{className:"flex items-center gap-2",children:[e.jsxDEV(br,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:35,columnNumber:11},void 0),"הוסף משתמש"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:34,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:33,columnNumber:7},void 0),e.jsxDEV(Ke,{children:[e.jsxDEV(Ye,{children:e.jsxDEV(Je,{className:"text-right",children:"הוסף משתמש חדש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:41,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:40,columnNumber:9},void 0),e.jsxDEV(Ei,{user:r,setUser:a,onSubmit:()=>m.mutate(r),submitLabel:"צור משתמש",isLoading:m.isPending},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:43,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:39,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/AddUserDialog.tsx",lineNumber:32,columnNumber:5},void 0)},io=({isAddUserOpen:n,setIsAddUserOpen:i,newUser:r,setNewUser:a})=>e.jsxDEV("div",{className:"mb-6",children:[e.jsxDEV("div",{className:"flex justify-between items-center",children:[e.jsxDEV("h2",{className:"text-2xl font-bold",children:"ניהול משתמשים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagementHeader.tsx",lineNumber:23,columnNumber:9},void 0),e.jsxDEV(ro,{isOpen:n,setIsOpen:i,newUser:r,setNewUser:a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagementHeader.tsx",lineNumber:24,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagementHeader.tsx",lineNumber:22,columnNumber:7},void 0),e.jsxDEV("p",{className:"text-muted-foreground mb-4",children:"צור, ערוך ושנה הרשאות למשתמשי המערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagementHeader.tsx",lineNumber:31,columnNumber:7},void 0),e.jsxDEV(Lr,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagementHeader.tsx",lineNumber:32,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagementHeader.tsx",lineNumber:21,columnNumber:5},void 0),to=()=>{const[n,i]=t.useState(""),[r,a]=t.useState(!1),{deleteUserByEmailMutation:m}=or(),s=async()=>{if(n&&window.confirm(`האם אתה בטוח שברצונך למחוק את המשתמש ${n}?`)){a(!0);try{await m.mutateAsync(n),i("")}catch(o){console.error("Failed to delete user:",o)}finally{a(!1)}}};return e.jsxDEV(Q,{className:"mb-6",children:[e.jsxDEV(me,{children:e.jsxDEV(le,{className:"flex items-center gap-2",children:[e.jsxDEV(cn,{className:"h-5 w-5 text-orange-500"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:34,columnNumber:11},void 0),"מחיקת משתמש לפי אימייל"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:33,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:32,columnNumber:7},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"flex flex-col gap-2",children:[e.jsxDEV("label",{htmlFor:"email-delete",className:"text-sm font-medium",children:"אימייל המשתמש למחיקה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:40,columnNumber:11},void 0),e.jsxDEV($,{id:"email-delete",type:"email",value:n,onChange:o=>i(o.target.value),placeholder:"הזן אימייל של משתמש שאינו מוצג ברשימה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:43,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:39,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:38,columnNumber:7},void 0),e.jsxDEV(tn,{children:e.jsxDEV(A,{variant:"destructive",onClick:s,disabled:!n||r,children:r?"מוחק...":"מחק משתמש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:53,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:52,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/DeleteUserByEmail.tsx",lineNumber:31,columnNumber:5},void 0)},ao=()=>{const[n,i]=t.useState(!1),[r,a]=t.useState(!1),[m,s]=t.useState(null),[o,h]=t.useState({email:"",username:"",full_name:"",password:"",is_admin:!1}),{users:d,isLoading:j,deleteUserMutation:b,resetPasswordMutation:v}=or(),N=E=>{s(E),a(!0)},x=E=>{v.mutate(E)};return e.jsxDEV(Q,{className:"p-6",dir:"rtl",children:[e.jsxDEV(io,{isAddUserOpen:n,setIsAddUserOpen:i,newUser:o,setNewUser:h},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagement.tsx",lineNumber:36,columnNumber:7},void 0),e.jsxDEV(to,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagement.tsx",lineNumber:43,columnNumber:7},void 0),e.jsxDEV(no,{isOpen:r,setIsOpen:a,selectedUser:m,setSelectedUser:s},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagement.tsx",lineNumber:45,columnNumber:7},void 0),e.jsxDEV(Ja,{users:d||[],onEdit:N,onDelete:E=>b.mutate(E),onResetPassword:x,isLoading:j},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagement.tsx",lineNumber:52,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/user-management/UserManagement.tsx",lineNumber:35,columnNumber:5},void 0)},oo=[{key:"general",label:"כללי",icon:e.jsxDEV(Tt,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:48,columnNumber:11},void 0),children:[{key:"timezone",label:"אזור זמן"},{key:"domain",label:"שם מתחם"}]},{key:"schedule",label:"לוח שידורים",icon:e.jsxDEV(jn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:54,columnNumber:50},void 0)},{key:"studio-schedule",label:"לוח אולפנים",icon:e.jsxDEV(fn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:58,columnNumber:11},void 0),children:[{key:"pending-requests",label:"בקשות ממתינות"},{key:"sync-status",label:"סטטוס סנכרון"},{key:"approvers",label:"ניהול מאשרים"}]},{key:"arrangements",label:"סידורי עבודה",icon:e.jsxDEV(_t,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:68,columnNumber:11},void 0),children:[{key:"producers",label:"עורך סידור הפקה"},{key:"engineers",label:"עורך סידור טכנאים"},{key:"digital",label:"עורך סידור דיגיטל"}]},{key:"workers",label:"ניהול עובדים",icon:e.jsxDEV(ci,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:78,columnNumber:11},void 0),children:[{key:"management",label:"ניהול עובדים"},{key:"users",label:"ניהול משתמשים"}]},{key:"email",label:"דואר אלקטרוני",icon:e.jsxDEV(At,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:87,columnNumber:11},void 0),children:[{key:"recipients",label:"נמענים"},{key:"settings",label:"הגדרות שליחה"},{key:"template",label:"תבנית הודעה"}]},{key:"data",label:"ניהול נתונים",icon:e.jsxDEV(Er,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:97,columnNumber:11},void 0),children:[{key:"export",label:"ייצוא נתונים"},{key:"import",label:"ייבוא נתונים"},{key:"backup",label:"גיבוי ושחזור"},{key:"schedule-export",label:"ייצוא לוח שידורים"}]},{key:"database",label:"בסיס נתונים",icon:e.jsxDEV(di,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:105,columnNumber:50},void 0)},{key:"storage",label:"ניהול אחסון",icon:e.jsxDEV(Ft,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:106,columnNumber:49},void 0)},{key:"rds",label:"RDS",icon:e.jsxDEV(pi,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:110,columnNumber:11},void 0),children:[{key:"rds-settings",label:"הגדרות RDS כלליות"},{key:"translations",label:"תרגומים"}]},{key:"lineup-import",label:"ייבוא ליינאפים",icon:e.jsxDEV(Vn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:116,columnNumber:58},void 0)}],Qr=({currentSection:n,currentSub:i,onNavigate:r,collapsed:a=!1,onToggleCollapse:m})=>e.jsxDEV("aside",{className:Ee("w-full shrink-0 transition-all",a?"md:w-16 md:min-w-16":"md:w-64 md:min-w-64"),children:e.jsxDEV("nav",{className:"bg-white rounded-md shadow-sm border border-slate-200 overflow-hidden",dir:"rtl",children:[e.jsxDEV("div",{className:"flex items-center justify-between px-3 py-2 border-b border-slate-100",children:[!a&&e.jsxDEV("span",{className:"text-sm font-medium text-slate-700",children:"תפריט"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:132,columnNumber:26},void 0),e.jsxDEV("button",{type:"button",onClick:m,className:"p-1 rounded hover:bg-slate-100 text-slate-600","aria-label":"כווץ תפריט",title:"כווץ תפריט",children:a?e.jsxDEV(rr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:140,columnNumber:26},void 0):e.jsxDEV(ir,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:140,columnNumber:65},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:133,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:131,columnNumber:9},void 0),e.jsxDEV("ul",{className:"divide-y divide-slate-100",children:oo.map(s=>{const o=n===s.key;return e.jsxDEV("li",{children:[e.jsxDEV("button",{type:"button",className:Ee("w-full flex items-center justify-between gap-2 px-4 py-3 text-right transition-colors",o?"bg-[#3fc9c5] text-white":"hover:bg-slate-50"),onClick:()=>r(s.key,s.children?.[0]?.key),children:e.jsxDEV("span",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:Ee("inline-flex items-center justify-center rounded-sm",o?"text-white":"text-slate-600"),children:s.icon},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:157,columnNumber:21},void 0),!a&&e.jsxDEV("span",{className:"font-medium",children:s.label},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:160,columnNumber:36},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:156,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:148,columnNumber:17},void 0),s.children&&o&&!a&&e.jsxDEV("ul",{className:"bg-slate-50/60 py-1",children:s.children.map(h=>{const d=i===h.key;return e.jsxDEV("li",{children:e.jsxDEV("button",{type:"button",className:Ee("w-full text-right px-6 py-2 text-sm transition-colors",d?"text-[#3fc9c5] font-semibold":"text-slate-700 hover:text-slate-900"),onClick:()=>r(s.key,h.key),children:h.label},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:170,columnNumber:27},void 0)},h.key,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:169,columnNumber:25},void 0)})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:165,columnNumber:19},void 0)]},s.key,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:147,columnNumber:15},void 0)})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:143,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:130,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminSidebar.tsx",lineNumber:129,columnNumber:5},void 0),so=({section:n,sub:i,onNavigate:r,children:a})=>{const[m,s]=pn.useState(!1),[o,h]=pn.useState(!1);return e.jsxDEV("div",{className:"flex flex-col md:flex-row gap-4",dir:"rtl",children:[e.jsxDEV("div",{className:"md:hidden flex items-center justify-between bg-white rounded-lg shadow-sm p-4 mb-4",children:[e.jsxDEV("h2",{className:"text-lg font-semibold text-slate-800",children:"ניהול מערכת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:20,columnNumber:9},void 0),e.jsxDEV("button",{type:"button","aria-label":"פתח תפריט",className:"p-2 rounded border text-slate-700 hover:bg-slate-50",onClick:()=>h(!0),children:e.jsxDEV(Rt,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:27,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:21,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:19,columnNumber:7},void 0),e.jsxDEV("div",{className:"hidden md:block",children:e.jsxDEV(Qr,{currentSection:n,currentSub:i,onNavigate:r,collapsed:m,onToggleCollapse:()=>s(d=>!d)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:33,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:32,columnNumber:7},void 0),o&&e.jsxDEV("div",{className:"fixed inset-0 z-50 md:hidden",children:[e.jsxDEV("div",{className:"absolute inset-0 bg-black/30",onClick:()=>h(!1)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:45,columnNumber:11},void 0),e.jsxDEV("div",{className:"absolute right-0 top-0 h-full w-80 bg-white shadow-lg",children:[e.jsxDEV("div",{className:"p-4 border-b border-slate-200",children:e.jsxDEV("h3",{className:"text-lg font-semibold text-slate-800",children:"תפריט ניהול"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:48,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:47,columnNumber:13},void 0),e.jsxDEV("div",{className:"p-3",children:e.jsxDEV(Qr,{currentSection:n,currentSub:i,onNavigate:(d,j)=>{r(d,j),h(!1)},collapsed:!1,onToggleCollapse:()=>{}},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:51,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:50,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:46,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:44,columnNumber:9},void 0),e.jsxDEV("section",{className:"flex-1 min-w-0",children:e.jsxDEV("div",{className:"bg-white border border-slate-200 rounded-md shadow-sm p-4 md:p-6",children:a},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:64,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:63,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/layout/AdminLayout.tsx",lineNumber:17,columnNumber:5},void 0)},ei=()=>{const[n,i]=t.useState(null),[r,a]=t.useState(null),[m,s]=t.useState(!0),[o,h]=t.useState(!1),[d,j]=t.useState(!1),[b,v]=t.useState(!1),[N,x]=t.useState(!1),[E,S]=t.useState([]),[g,u]=t.useState(!1),[R,V]=t.useState(!1),[T,l]=t.useState(null),[c,k]=t.useState(!1),[f,F]=t.useState(!1),{toast:P}=De(),O={0:"NONE",1:"NEWS",4:"SPORTS",17:"FINANCE",21:"PHONE-IN",26:"NATIONAL MUSIC"},_={0:"SPEECH ONLY",1:"MUSIC PROGRAMMING"};t.useEffect(()=>{y(),L(),Se()},[]);const y=async()=>{try{s(!0);const M=await Gi();i(M)}catch(M){console.error("Error loading RDS settings:",M),P({title:"שגיאה",description:"שגיאה בטעינת הגדרות RDS",variant:"destructive"})}finally{s(!1)}},L=async()=>{try{j(!0);const M=await zi();a(M)}catch(M){console.error("Error loading current RDS data:",M),P({title:"שגיאה",description:"שגיאה בטעינת נתוני RDS נוכחיים",variant:"destructive"})}finally{j(!1)}},w=async()=>{if(n)try{h(!0),await Ki(n),P({title:"הצלחה",description:"הגדרות RDS נשמרו בהצלחה"}),await L()}catch(M){console.error("Error saving RDS settings:",M),P({title:"שגיאה",description:"שגיאה בשמירת הגדרות RDS",variant:"destructive"})}finally{h(!1)}},q=async()=>{try{v(!0),await Yi();const M=await Ji();await L(),P({title:"הצלחה",description:"נתוני RDS עודכנו ונשלחו בהצלחה"})}catch(M){console.error("Error updating and sending RDS data:",M),P({title:"שגיאה",description:"שגיאה בעדכון ושליחת נתוני RDS",variant:"destructive"})}finally{v(!1)}},z=M=>{n&&i({...n,send_rds_on_program_change:M})},I=M=>{n&&i({...n,rds_rt2:M.substring(0,64)})},B=M=>{n&&i({...n,rds_rt3:M.substring(0,64)})},ne=async()=>{try{x(!0);const M=await Zi();M.success?P({title:"הצלחה",description:"נתוני RDS נשלחו בהצלחה דרך Telnet"}):M.skipped?P({title:"דילוג",description:"שליחת Telnet דולגה: "+M.message,variant:"default"}):P({title:"שגיאה",description:"שגיאה בשליחת נתוני RDS דרך Telnet",variant:"destructive"})}catch(M){console.error("Error sending RDS data via telnet:",M),P({title:"שגיאה",description:"שגיאה בשליחת נתוני RDS דרך Telnet",variant:"destructive"})}finally{x(!1)}},fe=async()=>{try{u(!0);const M=await nt(50);M.success&&S(M.logs)}catch(M){console.error("Error loading transmission logs:",M),P({title:"שגיאה",description:"שגיאה בטעינת יומני שידור",variant:"destructive"})}finally{u(!1)}},Se=async()=>{try{k(!0);const M=await qi();M.success&&l(M.status)}catch(M){console.error("Error loading cron status:",M),P({title:"שגיאה",description:"שגיאה בטעינת סטטוס Cron",variant:"destructive"})}finally{k(!1)}},ze=async()=>{try{F(!0),(await Qi()).success&&(P({title:"הצלחה",description:"Cron Job אופס מחדש בהצלחה"}),setTimeout(()=>{Se()},2e3))}catch(M){console.error("Error restarting cron:",M),P({title:"שגיאה",description:"שגיאה באופס מחדש של Cron Job",variant:"destructive"})}finally{F(!1)}},Ue=async()=>{try{x(!0),(await et()).success&&(P({title:"הצלחה",description:"שידור ידני הופעל בהצלחה"}),fe())}catch(M){console.error("Error triggering manual transmission:",M),P({title:"שגיאה",description:"שגיאה בהפעלת שידור ידני",variant:"destructive"})}finally{x(!1)}},X=()=>{R||fe(),V(!R)};return m?e.jsxDEV("div",{className:"flex items-center justify-center p-8",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:288,columnNumber:11},void 0),e.jsxDEV("p",{children:"טוען הגדרות RDS..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:289,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:287,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:286,columnNumber:7},void 0):n?e.jsxDEV("div",{className:"space-y-6",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(pi,{className:"h-6 w-6 text-blue-600"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:306,columnNumber:9},void 0),e.jsxDEV("h1",{className:"text-2xl font-bold",children:"הגדרות RDS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:307,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:305,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"הגדרות כלליות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:312,columnNumber:11},void 0),e.jsxDEV(xe,{children:"הגדרות RDS גלובליות למערכת הרדיו"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:313,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:311,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-6",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"space-y-0.5",children:[e.jsxDEV(U,{htmlFor:"send-rds",children:"שלח נתוני RDS בעת החלפת תוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:320,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:["שלח אוטומטית נתוני RDS כאשר תוכנית מתחלפת",n.send_rds_on_program_change&&e.jsxDEV("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mr-2",children:"פעיל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:324,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:321,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:319,columnNumber:13},void 0),e.jsxDEV(jr,{id:"send-rds",checked:n.send_rds_on_program_change,onCheckedChange:z},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:330,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:318,columnNumber:11},void 0),e.jsxDEV("div",{className:"grid gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"default-rt1",children:"RT1 ברירת מחדל - טקסט רדיו"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:339,columnNumber:15},void 0),e.jsxDEV($,{id:"default-rt1",value:n.default_rt1||"",onChange:M=>{n&&i({...n,default_rt1:M.target.value.substring(0,64)})},placeholder:"טקסט ברירת מחדל כאשר אין תוכנית מתוזמנת (עד 64 תווים)",maxLength:64},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:340,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:[(n.default_rt1||"").length,"/64 תווים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:351,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"טקסט זה יוצג כאשר אין תוכנית מתוזמנת (למשל בלילה)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:354,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:338,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"rt2",children:"RT2 - טקסט רדיו נוסף"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:360,columnNumber:15},void 0),e.jsxDEV($,{id:"rt2",value:n.rds_rt2,onChange:M=>I(M.target.value),placeholder:"טקסט נוסף ל-RDS (עד 64 תווים)",maxLength:64},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:361,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:[n.rds_rt2.length,"/64 תווים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:368,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:359,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"rt3",children:"RT3 - טקסט רדיו נוסף"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:374,columnNumber:15},void 0),e.jsxDEV($,{id:"rt3",value:n.rds_rt3,onChange:M=>B(M.target.value),placeholder:"טקסט נוסף ל-RDS (עד 64 תווים)",maxLength:64},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:375,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:[n.rds_rt3.length,"/64 תווים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:382,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:373,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:337,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex justify-end",children:e.jsxDEV(A,{onClick:w,disabled:o,children:[e.jsxDEV(Ln,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:390,columnNumber:15},void 0),o?"שומר...":"שמור הגדרות"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:389,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:388,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:317,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:310,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"הגדרות דריסה (Override)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:399,columnNumber:11},void 0),e.jsxDEV(xe,{children:'דרוס את נתוני RDS הנוכחיים עם ערכים ידניים. השינויים יחולו בלחיצה על "עדכן עכשיו" וימשיכו עד תחילת תוכנית חדשה.'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:400,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:398,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-6",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"space-y-0.5",children:[e.jsxDEV(U,{htmlFor:"override-enabled",children:"הפעל דריסת RDS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:407,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"דרוס את נתוני RDS הנוכחיים עם הערכים למטה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:408,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:406,columnNumber:13},void 0),e.jsxDEV(jr,{id:"override-enabled",checked:n.override_enabled||!1,onCheckedChange:M=>{n&&i({...n,override_enabled:M})}},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:412,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:405,columnNumber:11},void 0),n.override_enabled&&e.jsxDEV("div",{className:"grid gap-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"override-pty",children:"PTY - סוג תוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:427,columnNumber:19},void 0),e.jsxDEV("select",{id:"override-pty",value:n.override_pty||"",onChange:M=>{n&&i({...n,override_pty:M.target.value?parseInt(M.target.value):void 0})},className:"w-full p-2 border rounded-md",children:[e.jsxDEV("option",{value:"",children:"בחר סוג תוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:441,columnNumber:21},void 0),e.jsxDEV("option",{value:"0",children:"NONE"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:442,columnNumber:21},void 0),e.jsxDEV("option",{value:"1",children:"NEWS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:443,columnNumber:21},void 0),e.jsxDEV("option",{value:"4",children:"SPORTS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:444,columnNumber:21},void 0),e.jsxDEV("option",{value:"17",children:"FINANCE"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:445,columnNumber:21},void 0),e.jsxDEV("option",{value:"21",children:"PHONE-IN"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:446,columnNumber:21},void 0),e.jsxDEV("option",{value:"26",children:"NATIONAL MUSIC"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:447,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:428,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:426,columnNumber:17},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"override-ms",children:"MS - מוזיקה/דיבור"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:452,columnNumber:19},void 0),e.jsxDEV("select",{id:"override-ms",value:n.override_ms||"",onChange:M=>{n&&i({...n,override_ms:M.target.value?parseInt(M.target.value):void 0})},className:"w-full p-2 border rounded-md",children:[e.jsxDEV("option",{value:"",children:"בחר סוג תוכן"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:466,columnNumber:21},void 0),e.jsxDEV("option",{value:"0",children:"SPEECH ONLY"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:467,columnNumber:21},void 0),e.jsxDEV("option",{value:"1",children:"MUSIC PROGRAMMING"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:468,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:453,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:451,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:425,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"override-rt1",children:"RT1 - טקסט רדיו"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:474,columnNumber:17},void 0),e.jsxDEV($,{id:"override-rt1",value:n.override_rt1||"",onChange:M=>{n&&i({...n,override_rt1:M.target.value.substring(0,64)})},placeholder:"טקסט רדיו ידני (עד 64 תווים)",maxLength:64},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:475,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:[(n.override_rt1||"").length,"/64 תווים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:489,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:473,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex justify-end",children:e.jsxDEV(A,{onClick:w,disabled:o,variant:"outline",children:[e.jsxDEV(Ln,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:500,columnNumber:19},void 0),o?"שומר...":"שמור הגדרות דריסה"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:495,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:494,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:424,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:404,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:397,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{className:"flex items-center gap-2",children:[e.jsxDEV(si,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:512,columnNumber:13},void 0),"תצוגה מקדימה RDS נוכחי",r?.override_enabled&&e.jsxDEV("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"דריסה פעילה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:515,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:511,columnNumber:11},void 0),e.jsxDEV(xe,{children:["נתוני RDS הנוכחיים שיישלחו למשדר",r?.override_enabled&&" (עם דריסה)"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:520,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:510,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-4",children:d?e.jsxDEV("div",{className:"flex items-center justify-center p-4",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:528,columnNumber:15},void 0),e.jsxDEV("span",{className:"mr-2",children:"טוען נתוני RDS..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:529,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:527,columnNumber:13},void 0):r?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold",children:"PTY:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:535,columnNumber:19},void 0)," ",O[r.pty]||r.pty]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:534,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold",children:"MS:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:538,columnNumber:19},void 0)," ",_[r.ms]||r.ms]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:537,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:533,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold text-sm",children:"Radio Text:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:544,columnNumber:19},void 0),e.jsxDEV("div",{className:"mt-1 p-2 bg-gray-50 rounded text-sm font-mono",dir:"ltr",children:r.radio_text||"(ריק)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:545,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:543,columnNumber:17},void 0),r.rt2&&e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold text-sm",children:"RT2:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:552,columnNumber:21},void 0),e.jsxDEV("div",{className:"mt-1 p-2 bg-gray-50 rounded text-sm font-mono",dir:"ltr",children:r.rt2},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:553,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:551,columnNumber:19},void 0),r.rt3&&e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold text-sm",children:"RT3:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:561,columnNumber:21},void 0),e.jsxDEV("div",{className:"mt-1 p-2 bg-gray-50 rounded text-sm font-mono",dir:"ltr",children:r.rt3},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:562,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:560,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:542,columnNumber:15},void 0),r.show_name&&e.jsxDEV("div",{className:"text-sm text-muted-foreground",children:[e.jsxDEV("span",{className:"font-semibold",children:"תוכנית נוכחית:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:571,columnNumber:19},void 0)," ",r.show_name,r.host_name&&` עם ${r.host_name}`]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:570,columnNumber:17},void 0),e.jsxDEV("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxDEV(A,{onClick:q,disabled:b,className:"flex items-center gap-2",children:[e.jsxDEV(vr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:582,columnNumber:19},void 0),b?"שולח...":"עדכן עכשיו"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:577,columnNumber:17},void 0),e.jsxDEV(A,{onClick:ne,disabled:N,variant:"secondary",className:"flex items-center gap-2",children:[e.jsxDEV(Mt,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:591,columnNumber:19},void 0),N?"שולח Telnet...":"שלח Telnet"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:585,columnNumber:17},void 0),e.jsxDEV(A,{variant:"outline",onClick:L,disabled:d,className:"flex items-center gap-2",children:[e.jsxDEV(Me,{className:`h-4 w-4 ${d?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:600,columnNumber:19},void 0),"רענן"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:594,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:576,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:532,columnNumber:13},void 0):e.jsxDEV("div",{className:"text-center p-4 text-gray-500",children:"לא ניתן לטעון נתוני RDS נוכחיים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:606,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:525,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:509,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"מידע על RDS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:615,columnNumber:11},void 0),e.jsxDEV(xe,{children:"Radio Data System - מערכת להעברת מידע דיגיטלי דרך שידורי הרדיו"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:616,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:614,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-4 text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("h4",{className:"font-semibold mb-2",children:"שדות RDS:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:623,columnNumber:15},void 0),e.jsxDEV("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsxDEV("li",{children:["• ",e.jsxDEV("strong",{children:"PTY"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:625,columnNumber:23},void 0)," - סוג התוכנית (NEWS, SPORTS, PHONE-IN, וכו')"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:625,columnNumber:17},void 0),e.jsxDEV("li",{children:["• ",e.jsxDEV("strong",{children:"MS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:626,columnNumber:23},void 0)," - מוזיקה/דיבור (SPEECH ONLY או MUSIC PROGRAMMING)"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:626,columnNumber:17},void 0),e.jsxDEV("li",{children:["• ",e.jsxDEV("strong",{children:"Radio Text"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:627,columnNumber:23},void 0)," - טקסט התוכנית (עד 64 תווים)"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:627,columnNumber:17},void 0),e.jsxDEV("li",{children:["• ",e.jsxDEV("strong",{children:"RT2/RT3"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:628,columnNumber:23},void 0)," - טקסטים נוספים (עד 64 תווים כל אחד)"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:628,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:624,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:622,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h4",{className:"font-semibold mb-2",children:"הערות:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:632,columnNumber:15},void 0),e.jsxDEV("ul",{className:"space-y-1 text-muted-foreground",children:[e.jsxDEV("li",{children:"• כל הטקסטים חייבים להיות באנגלית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:634,columnNumber:17},void 0),e.jsxDEV("li",{children:"• מערכת התרגום האוטומטי תתרגם את שמות התוכניות והמגישים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:635,columnNumber:17},void 0),e.jsxDEV("li",{children:"• חיבור למשדר מתבצע דרך Telnet לשרת 82.81.38.216:10002"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:636,columnNumber:17},void 0),e.jsxDEV("li",{children:"• שליחת נתונים מתבצעת אוטומטית כל 30 דקות (XX:00 ו-XX:30)"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:637,columnNumber:17},void 0),e.jsxDEV("li",{children:'• ניתן לשלוח נתונים ידנית באמצעות כפתור "שלח Telnet"'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:638,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:633,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:631,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:621,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:620,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:613,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{className:"flex items-center gap-2",children:[e.jsxDEV(Me,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:648,columnNumber:13},void 0),"סטטוס Cron Job"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:647,columnNumber:11},void 0),e.jsxDEV(xe,{children:"מצב הפעלה של Cron Job לשליחת נתוני RDS אוטומטית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:651,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:646,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-4",children:c?e.jsxDEV("div",{className:"flex items-center justify-center p-4",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:659,columnNumber:17},void 0),e.jsxDEV("span",{className:"mr-2",children:"טוען סטטוס Cron..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:660,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:658,columnNumber:15},void 0):T?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold",children:"סטטוס:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:666,columnNumber:21},void 0),e.jsxDEV("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mr-2 ${T.isRunning?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:T.isRunning?"פועל":"לא פועל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:667,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:665,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold",children:"זמן הפעלה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:676,columnNumber:21},void 0),e.jsxDEV("span",{className:"text-muted-foreground",children:T.uptime?`${Math.floor(T.uptime/3600)}h ${Math.floor(T.uptime%3600/60)}m`:"N/A"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:677,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:675,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold",children:'ריצות סה"כ:'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:682,columnNumber:21},void 0),e.jsxDEV("span",{className:"text-muted-foreground",children:T.totalRuns},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:683,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:681,columnNumber:19},void 0),e.jsxDEV("div",{children:[e.jsxDEV("span",{className:"font-semibold",children:"ריצה אחרונה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:686,columnNumber:21},void 0),e.jsxDEV("span",{className:"text-muted-foreground",children:T.lastRun?new Date(T.lastRun).toLocaleString("he-IL"):"N/A"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:687,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:685,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:664,columnNumber:17},void 0),T.lastError&&e.jsxDEV("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxDEV("div",{className:"text-sm font-semibold text-red-800 mb-1",children:"שגיאה אחרונה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:695,columnNumber:21},void 0),e.jsxDEV("div",{className:"text-sm text-red-700",children:T.lastError},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:696,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:694,columnNumber:19},void 0),T.nextRuns&&T.nextRuns.length>0&&e.jsxDEV("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxDEV("div",{className:"text-sm font-semibold text-blue-800 mb-2",children:"ריצות הבאות:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:702,columnNumber:21},void 0),e.jsxDEV("div",{className:"space-y-1",children:T.nextRuns.slice(0,3).map((M,ye)=>e.jsxDEV("div",{className:"text-sm text-blue-700",children:M},ye,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:705,columnNumber:25},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:703,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:701,columnNumber:19},void 0),e.jsxDEV("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxDEV(A,{onClick:ze,disabled:f,variant:"outline",className:"flex items-center gap-2",children:[e.jsxDEV(Me,{className:`h-4 w-4 ${f?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:720,columnNumber:21},void 0),f?"מאפס מחדש...":"אפס Cron מחדש"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:714,columnNumber:19},void 0),e.jsxDEV(A,{onClick:Ue,disabled:N,variant:"secondary",className:"flex items-center gap-2",children:[e.jsxDEV(vr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:729,columnNumber:21},void 0),N?"שולח...":"שידור ידני"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:723,columnNumber:19},void 0),e.jsxDEV(A,{onClick:Se,disabled:c,variant:"outline",className:"flex items-center gap-2",children:[e.jsxDEV(Me,{className:`h-4 w-4 ${c?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:738,columnNumber:21},void 0),"רענן סטטוס"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:732,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:713,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:663,columnNumber:15},void 0):e.jsxDEV("div",{className:"text-center p-4 text-gray-500",children:"לא ניתן לטעון סטטוס Cron"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:744,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:656,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:655,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:645,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{className:"flex items-center gap-2",children:[e.jsxDEV(fn,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:755,columnNumber:13},void 0),"יומני שידור Telnet"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:754,columnNumber:11},void 0),e.jsxDEV(xe,{children:"יומני שליחת נתוני RDS דרך חיבור Telnet"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:758,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:753,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(A,{variant:"outline",onClick:X,disabled:g,className:"flex items-center gap-2",children:[e.jsxDEV(fn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:770,columnNumber:15},void 0),R?"הסתר יומנים":"הצג יומנים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:764,columnNumber:13},void 0),R&&e.jsxDEV("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:g?e.jsxDEV("div",{className:"text-center p-4",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 mx-auto mb-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:778,columnNumber:21},void 0),"טוען יומנים..."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:777,columnNumber:19},void 0):E.length>0?E.map(M=>e.jsxDEV("div",{className:`p-3 rounded-lg border ${M.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[e.jsxDEV("span",{className:"text-sm font-medium",children:new Date(M.transmission_time).toLocaleString("he-IL")},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:790,columnNumber:25},void 0),e.jsxDEV("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${M.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:M.success?"הצלחה":"שגיאה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:793,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:789,columnNumber:23},void 0),e.jsxDEV("div",{className:"text-sm text-gray-600 mb-1",children:[e.jsxDEV("strong",{children:"שרת:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:804,columnNumber:25},void 0)," ",M.telnet_server,":",M.telnet_port]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:803,columnNumber:23},void 0),e.jsxDEV("div",{className:"text-sm text-gray-600 mb-1",children:[e.jsxDEV("strong",{children:"הודעה:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:807,columnNumber:25},void 0)," ",M.message]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:806,columnNumber:23},void 0),M.rds_data&&e.jsxDEV("div",{className:"text-xs text-gray-500 mt-2 p-2 bg-gray-50 rounded",children:[e.jsxDEV("strong",{children:"נתונים:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:811,columnNumber:27},void 0)," PTY=",M.rds_data.pty,", MS=",M.rds_data.ms,', RT1="',M.rds_data.rt1,'", RT2="',M.rds_data.rt2,'", RT3="',M.rds_data.rt3,'"']},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:810,columnNumber:25},void 0)]},M.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:783,columnNumber:21},void 0)):e.jsxDEV("div",{className:"text-center p-4 text-gray-500",children:"אין יומני שידור זמינים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:818,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:775,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:763,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:762,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:752,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:304,columnNumber:5},void 0):e.jsxDEV("div",{className:"text-center p-8",children:e.jsxDEV("p",{children:"לא ניתן לטעון הגדרות RDS"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:298,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/RDSSettings.tsx",lineNumber:297,columnNumber:7},void 0)};function mo(){const[n,i]=t.useState([]),[r,a]=t.useState(!0),[m,s]=t.useState(null),[o,h]=t.useState({hebrew:"",english:""}),[d,j]=t.useState({hebrew:"",english:""});t.useEffect(()=>{b()},[]);const b=async()=>{try{const g=await rt();i(g)}catch{oe.error("Failed to load translation mappings")}finally{a(!1)}},v=async()=>{if(!o.hebrew.trim()||!o.english.trim()){oe.error("Both Hebrew and English text are required");return}try{await it(o.hebrew.trim(),o.english.trim()),h({hebrew:"",english:""}),await b(),oe.success("Translation mapping added successfully")}catch{oe.error("Failed to add translation mapping")}},N=async g=>{if(!d.hebrew.trim()||!d.english.trim()){oe.error("Both Hebrew and English text are required");return}try{await tt(g,d.hebrew.trim(),d.english.trim()),s(null),j({hebrew:"",english:""}),await b(),oe.success("Translation mapping updated successfully")}catch{oe.error("Failed to update translation mapping")}},x=async g=>{if(confirm("Are you sure you want to delete this translation mapping?"))try{await at(g),await b(),oe.success("Translation mapping deleted successfully")}catch{oe.error("Failed to delete translation mapping")}},E=g=>{s(g.id),j({hebrew:g.hebrew_text,english:g.english_text})},S=()=>{s(null),j({hebrew:"",english:""})};return r?e.jsxDEV("div",{className:"flex items-center justify-center p-8",children:"Loading..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:91,columnNumber:12},this):e.jsxDEV("div",{className:"space-y-6",children:e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"Translation Mappings"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:98,columnNumber:11},this),e.jsxDEV(xe,{children:"Manage Hebrew to English translation mappings for RDS radio text generation. These mappings are used to automatically translate show names and hosts."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:99,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:97,columnNumber:9},this),e.jsxDEV(ie,{children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxDEV("div",{children:[e.jsxDEV(U,{htmlFor:"new-hebrew",children:"Hebrew Text"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:108,columnNumber:15},this),e.jsxDEV($,{id:"new-hebrew",value:o.hebrew,onChange:g=>h(u=>({...u,hebrew:g.target.value})),placeholder:"עם",dir:"rtl"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:109,columnNumber:15},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:107,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV(U,{htmlFor:"new-english",children:"English Text"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:118,columnNumber:15},this),e.jsxDEV($,{id:"new-english",value:o.english,onChange:g=>h(u=>({...u,english:g.target.value})),placeholder:"with"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:119,columnNumber:15},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:117,columnNumber:13},this),e.jsxDEV("div",{className:"flex items-end",children:e.jsxDEV(A,{onClick:v,className:"w-full",children:[e.jsxDEV(Sn,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:128,columnNumber:17},this),"Add Mapping"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:127,columnNumber:15},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:126,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:106,columnNumber:11},this),e.jsxDEV("div",{className:"border rounded-lg",children:e.jsxDEV(Ze,{children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{children:"Hebrew Text"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:139,columnNumber:19},this),e.jsxDEV(ee,{children:"English Text"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:140,columnNumber:19},this),e.jsxDEV(ee,{children:"Actions"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:141,columnNumber:19},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:138,columnNumber:17},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:137,columnNumber:15},this),e.jsxDEV(en,{children:n.length===0?e.jsxDEV(he,{children:e.jsxDEV(Z,{colSpan:3,className:"text-center text-muted-foreground",children:"No translation mappings found"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:147,columnNumber:21},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:146,columnNumber:19},this):n.map(g=>e.jsxDEV(he,{children:[e.jsxDEV(Z,{dir:"rtl",className:"font-medium",children:m===g.id?e.jsxDEV($,{value:d.hebrew,onChange:u=>j(R=>({...R,hebrew:u.target.value})),dir:"rtl"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:156,columnNumber:27},this):g.hebrew_text},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:154,columnNumber:23},this),e.jsxDEV(Z,{children:m===g.id?e.jsxDEV($,{value:d.english,onChange:u=>j(R=>({...R,english:u.target.value}))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:167,columnNumber:27},this):g.english_text},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:165,columnNumber:23},this),e.jsxDEV(Z,{children:m===g.id?e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(A,{size:"sm",onClick:()=>N(g.id),className:"h-8 w-8 p-0",children:e.jsxDEV(nr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:183,columnNumber:31},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:178,columnNumber:29},this),e.jsxDEV(A,{size:"sm",variant:"outline",onClick:S,className:"h-8 w-8 p-0",children:e.jsxDEV(Ar,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:191,columnNumber:31},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:185,columnNumber:29},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:177,columnNumber:27},this):e.jsxDEV("div",{className:"flex space-x-2",children:[e.jsxDEV(A,{size:"sm",variant:"outline",onClick:()=>E(g),className:"h-8 w-8 p-0",children:e.jsxDEV(mi,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:202,columnNumber:31},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:196,columnNumber:29},this),e.jsxDEV(A,{size:"sm",variant:"outline",onClick:()=>x(g.id),className:"h-8 w-8 p-0 text-destructive",children:e.jsxDEV(kn,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:210,columnNumber:31},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:204,columnNumber:29},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:195,columnNumber:27},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:175,columnNumber:23},this)]},g.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:153,columnNumber:21},this))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:144,columnNumber:15},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:136,columnNumber:13},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:135,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:104,columnNumber:9},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:96,columnNumber:7},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/TranslationMappings.tsx",lineNumber:95,columnNumber:5},this)}const lo=()=>{const[n,i]=t.useState([]),[r,a]=t.useState([]),[m,s]=t.useState(""),[o,h]=t.useState(!1),[d,j]=t.useState([]),[b,v]=t.useState([]),[N,x]=t.useState(!1),[E,S]=t.useState("approve"),[g,u]=t.useState(!1),[R,V]=t.useState(0);t.useEffect(()=>{T(),l(),c()},[]);const T=async()=>{try{const w=await Ut();i(w)}catch(w){console.error("Error fetching pending requests:",w),oe.error("שגיאה בטעינת בקשות ממתינות")}},l=async()=>{try{const w=await Or();j(w.slice(0,10))}catch(w){console.error("Error fetching sync logs:",w)}},c=async()=>{try{const w=await Ot();v(w)}catch(w){console.error("Error fetching approvers:",w)}},k=w=>{a(q=>q.includes(w)?q.filter(z=>z!==w):[...q,w])},f=()=>{r.length===n.length?a([]):a(n.map(w=>w.id))},F=async w=>{if(r.length===0){oe.error("נא לבחור לפחות בקשה אחת");return}S(w),x(!0)},P=async()=>{try{h(!0),await Gt(r,E==="approve"?"approved":"denied",m),oe.success(E==="approve"?`${r.length} בקשות אושרו בהצלחה`:`${r.length} בקשות נדחו`),a([]),s(""),x(!1),T()}catch(w){console.error("Error updating bookings:",w),oe.error("שגיאה בעדכון הבקשות")}finally{h(!1)}},O=async()=>{try{u(!0),V(0);const w=setInterval(()=>{V(z=>z>=90?z:z+5)},500),q=await $t();if(clearInterval(w),V(100),console.log("Sync result:",q),q.status==="processing"){oe.info("הסנכרון החל בעיבוד ברקע. בדוק את לוגי הסנכרון להתקדמות.");let z=0;const I=setInterval(async()=>{z++;const B=await Or();if(j(B.slice(0,10)),B&&B.length>0){const ne=B[0];(ne.status==="success"||ne.status==="failed")&&(clearInterval(I),V(100),setTimeout(()=>{V(0),u(!1)},1e3))}z>=60&&(clearInterval(I),V(0),u(!1))},2e3)}else if(q.status==="completed"||q.eventsCreated!==void 0&&q.eventsUpdated!==void 0){const z=q.eventsCreated??0,I=q.eventsUpdated??0;oe.success(`סנכרון הושלם: ${z} נוצרו, ${I} עודכנו`),await l(),setTimeout(()=>{V(0)},1e3)}else oe.info("הסנכרון החל. בדוק את לוגי הסנכרון להתקדמות."),await l(),setTimeout(()=>{V(0)},1e3)}catch(w){console.error("Error syncing calendar:",w),oe.error("שגיאה בסנכרון יומן גוגל"),V(0)}finally{u(!1)}},_=async()=>{if(confirm("האם אתה בטוח שברצונך למחוק את כל ההזמנות מיומן גוגל? פעולה זו לא תשנה את יומן גוגל עצמו."))try{u(!0);const w=await Xt();oe.success(`נמחקו ${w.deleted_count} הזמנות מיומן גוגל`),l()}catch(w){console.error("Error clearing bookings:",w),oe.error("שגיאה במחיקת הזמנות")}finally{u(!1)}},y=async()=>{if(confirm("האם אתה בטוח שברצונך להסיר כפילויות מההזמנות הקיימות?"))try{u(!0);const w=await Bt();oe.success(`הוסרו ${w.deleted_count} כפילויות מ-${w.duplicate_groups} קבוצות`),l()}catch(w){console.error("Error deduplicating bookings:",w),oe.error("שגיאה בהסרת כפילויות")}finally{u(!1)}},L=async w=>{if(confirm("האם אתה בטוח שברצונך להסיר מאשר זה?"))try{await Ht(w),oe.success("מאשר הוסר בהצלחה"),c()}catch(q){console.error("Error removing approver:",q),oe.error("שגיאה בהסרת מאשר")}};return e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:[e.jsxDEV(Qn,{defaultValue:"pending",className:"w-full",children:[e.jsxDEV(er,{className:"grid w-full grid-cols-3",children:[e.jsxDEV(on,{value:"pending",children:[e.jsxDEV(fn,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:305,columnNumber:13},void 0),"בקשות ממתינות (",n.length,")"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:304,columnNumber:11},void 0),e.jsxDEV(on,{value:"sync",children:[e.jsxDEV(Me,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:309,columnNumber:13},void 0),"סנכרון יומן גוגל"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:308,columnNumber:11},void 0),e.jsxDEV(on,{value:"approvers",children:[e.jsxDEV(ci,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:313,columnNumber:13},void 0),"מאשרים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:312,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:303,columnNumber:9},void 0),e.jsxDEV(sn,{value:"pending",className:"space-y-4",children:e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"בקשות הזמנת אולפן ממתינות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:322,columnNumber:15},void 0),e.jsxDEV(xe,{children:"נדרשת אישור מנהל לבקשות הבאות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:323,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:321,columnNumber:13},void 0),e.jsxDEV(ie,{children:n.length===0?e.jsxDEV("div",{className:"text-center py-8 text-gray-500",children:"אין בקשות ממתינות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:329,columnNumber:17},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxDEV("div",{className:"flex items-center gap-4",children:[e.jsxDEV(Ge,{checked:r.length===n.length,onCheckedChange:f},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:337,columnNumber:23},void 0),e.jsxDEV("span",{className:"text-sm font-medium",children:r.length>0?`${r.length} נבחרו`:"בחר הכל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:341,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:336,columnNumber:21},void 0),r.length>0&&e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(A,{size:"sm",onClick:()=>F("approve"),className:"bg-green-600 hover:bg-green-700",children:[e.jsxDEV(nr,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:355,columnNumber:27},void 0),"אשר הכל"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:350,columnNumber:25},void 0),e.jsxDEV(A,{size:"sm",variant:"destructive",onClick:()=>F("deny"),children:[e.jsxDEV(Ar,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:363,columnNumber:27},void 0),"דחה הכל"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:358,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:349,columnNumber:23},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:335,columnNumber:19},void 0),e.jsxDEV("div",{className:"space-y-3",children:n.map(w=>e.jsxDEV("div",{className:"flex items-start gap-3 p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxDEV(Ge,{checked:r.includes(w.id),onCheckedChange:()=>k(w.id)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:377,columnNumber:25},void 0),e.jsxDEV("div",{className:"flex-1",children:e.jsxDEV("div",{className:"flex items-start justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("h4",{className:"font-semibold",children:w.title},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:384,columnNumber:31},void 0),e.jsxDEV("p",{className:"text-sm text-gray-600 mt-1",children:[w.studio_name," • "," ",re(new Date(w.booking_date),"dd/MM/yyyy",{locale:Ce})," • "," ",w.start_time.slice(0,5)," - ",w.end_time.slice(0,5)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:385,columnNumber:31},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500 mt-1",children:["מבקש: ",w.user_name," (",w.user_email,")"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:390,columnNumber:31},void 0),w.notes&&e.jsxDEV("p",{className:"text-sm text-gray-600 mt-2",children:["הערות: ",w.notes]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:394,columnNumber:33},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:383,columnNumber:29},void 0),e.jsxDEV(dn,{variant:"secondary",children:re(new Date(w.created_at),"dd/MM HH:mm",{locale:Ce})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:399,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:382,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:381,columnNumber:25},void 0)]},w.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:373,columnNumber:23},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:371,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:333,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:327,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:320,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:319,columnNumber:9},void 0),e.jsxDEV(sn,{value:"sync",className:"space-y-4",children:e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV(le,{children:"סנכרון יומן גוגל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:419,columnNumber:19},void 0),e.jsxDEV(xe,{children:"סנכרון אוטומטי כל 10 דקות. ניתן גם לבצע סנכרון ידני."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:420,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:418,columnNumber:17},void 0),e.jsxDEV("div",{className:"flex gap-2",children:e.jsxDEV(A,{onClick:O,disabled:g,className:"flex items-center gap-2",children:[e.jsxDEV(Me,{className:`h-4 w-4 ${g?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:430,columnNumber:21},void 0),"סנכרון ידני"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:425,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:424,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:417,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:416,columnNumber:13},void 0),e.jsxDEV(ie,{children:[g&&e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[e.jsxDEV("span",{className:"text-sm font-medium text-gray-700",children:"מתבצע סנכרון..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:441,columnNumber:21},void 0),e.jsxDEV("span",{className:"text-sm text-gray-500",children:[R,"%"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:442,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:440,columnNumber:19},void 0),e.jsxDEV(_n,{value:R,className:"h-2.5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:444,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:439,columnNumber:17},void 0),e.jsxDEV("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxDEV("h4",{className:"font-semibold mb-2 text-yellow-800",children:"ניהול כפילויות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:449,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-sm text-yellow-700 mb-3",children:"אם יש כפילויות בלוח, ניתן לנקות אותן לפני סנכרון מחדש."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:450,columnNumber:17},void 0),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(A,{onClick:y,disabled:g,variant:"outline",size:"sm",className:"border-yellow-600 text-yellow-700 hover:bg-yellow-100",children:"הסר כפילויות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:454,columnNumber:19},void 0),e.jsxDEV(A,{onClick:_,disabled:g,variant:"outline",size:"sm",className:"border-red-600 text-red-700 hover:bg-red-100",children:"נקה כל ההזמנות מיומן גוגל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:463,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:453,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:448,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-3",children:d.length===0?e.jsxDEV("div",{className:"text-center py-8 text-gray-500",children:"אין היסטוריית סנכרון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:476,columnNumber:19},void 0):d.map(w=>e.jsxDEV("div",{className:"p-4 border rounded-lg",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV(dn,{variant:w.status==="success"?"default":w.status==="failed"?"destructive":"secondary",children:w.status==="success"?"הצלחה":w.status==="failed"?"נכשל":w.status},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:484,columnNumber:27},void 0),e.jsxDEV("span",{className:"text-sm text-gray-600",children:re(new Date(w.sync_started_at),"dd/MM/yyyy HH:mm",{locale:Ce})},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:493,columnNumber:27},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:483,columnNumber:25},void 0),e.jsxDEV("div",{className:"text-sm text-gray-600",children:[w.events_processed," אירועים • "," ",w.events_created," נוצרו • "," ",w.events_updated," עודכנו",w.conflicts_detected>0&&e.jsxDEV("span",{className:"text-orange-600",children:[" ","• ",w.conflicts_detected," התנגשויות"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:502,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:497,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:482,columnNumber:23},void 0),w.error_message&&e.jsxDEV("p",{className:"text-sm text-red-600 mt-2",children:["שגיאה: ",w.error_message]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:509,columnNumber:25},void 0)]},w.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:481,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:474,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:436,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:415,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:414,columnNumber:9},void 0),e.jsxDEV(sn,{value:"approvers",className:"space-y-4",children:e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:e.jsxDEV("div",{className:"flex items-center justify-between",children:e.jsxDEV("div",{children:[e.jsxDEV(le,{children:"ניהול מאשרים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:527,columnNumber:19},void 0),e.jsxDEV(xe,{children:"משתמשים שיקבלו התראות על בקשות הזמנה חדשות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:528,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:526,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:525,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:524,columnNumber:13},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"space-y-3",children:b.length===0?e.jsxDEV("div",{className:"text-center py-8 text-gray-500",children:"אין מאשרים מוגדרים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:538,columnNumber:19},void 0):b.map(w=>e.jsxDEV("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxDEV("div",{children:[e.jsxDEV("h4",{className:"font-semibold",children:w.name},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:548,columnNumber:25},void 0),e.jsxDEV("p",{className:"text-sm text-gray-600",children:w.email},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:549,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:547,columnNumber:23},void 0),e.jsxDEV(A,{size:"sm",variant:"ghost",onClick:()=>L(w.id),children:e.jsxDEV(kn,{className:"h-4 w-4 text-red-600"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:556,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:551,columnNumber:23},void 0)]},w.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:543,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:536,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:535,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:523,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:522,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:302,columnNumber:7},void 0),e.jsxDEV(qe,{open:N,onOpenChange:x,children:e.jsxDEV(Ke,{children:[e.jsxDEV(Ye,{children:[e.jsxDEV(Je,{children:E==="approve"?"אישור בקשות":"דחיית בקשות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:571,columnNumber:13},void 0),e.jsxDEV(kr,{children:E==="approve"?"הוסף הערות לבקשות המאושרות (אופציונלי)":"הוסף סיבה לדחיית הבקשות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:574,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:570,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-4",children:e.jsxDEV(Mn,{placeholder:"הערות מנהל...",value:m,onChange:w=>s(w.target.value),rows:4},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:581,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:580,columnNumber:11},void 0),e.jsxDEV(an,{children:[e.jsxDEV(A,{variant:"outline",onClick:()=>x(!1),children:"ביטול"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:589,columnNumber:13},void 0),e.jsxDEV(A,{onClick:P,disabled:o,className:E==="approve"?"bg-green-600 hover:bg-green-700":"",children:o?"מעדכן...":E==="approve"?"אשר":"דחה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:595,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:588,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:569,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:568,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/StudioScheduleAdmin.tsx",lineNumber:301,columnNumber:5},void 0)};function uo({usage:n,className:i}){const r=m=>m<70?"text-green-600":m<85?"text-yellow-600":"text-red-600",a=m=>m<70?"bg-green-500":m<85?"bg-yellow-500":"bg-red-500";return e.jsxDEV("div",{className:Ee("space-y-6",i),dir:"rtl",children:[e.jsxDEV("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:[e.jsxDEV("h3",{className:"text-lg font-semibold mb-4",children:"שימוש בדיסק"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:28,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center justify-center mb-6",children:e.jsxDEV("div",{className:"relative w-48 h-48",children:[e.jsxDEV("svg",{className:"transform -rotate-90 w-48 h-48",children:[e.jsxDEV("circle",{cx:"96",cy:"96",r:"88",stroke:"currentColor",strokeWidth:"16",fill:"none",className:"text-slate-200"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:34,columnNumber:15},this),e.jsxDEV("circle",{cx:"96",cy:"96",r:"88",stroke:"currentColor",strokeWidth:"16",fill:"none",strokeDasharray:`${2*Math.PI*88}`,strokeDashoffset:`${2*Math.PI*88*(1-n.usePercent/100)}`,className:r(n.usePercent),strokeLinecap:"round"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:43,columnNumber:15},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:33,columnNumber:13},this),e.jsxDEV("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxDEV("div",{className:"text-center",children:[e.jsxDEV("div",{className:Ee("text-4xl font-bold",r(n.usePercent)),children:[n.usePercent,"%"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:58,columnNumber:17},this),e.jsxDEV("div",{className:"text-sm text-slate-600 mt-1",children:"מנוצל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:61,columnNumber:17},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:57,columnNumber:15},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:56,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:32,columnNumber:11},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:31,columnNumber:9},this),e.jsxDEV("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-2xl font-semibold text-slate-900",children:n.total},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:70,columnNumber:13},this),e.jsxDEV("div",{className:"text-sm text-slate-600",children:'סה"כ'},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:71,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:69,columnNumber:11},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:Ee("text-2xl font-semibold",r(n.usePercent)),children:n.used},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:74,columnNumber:13},this),e.jsxDEV("div",{className:"text-sm text-slate-600",children:"משומש"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:77,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:73,columnNumber:11},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-2xl font-semibold text-green-600",children:n.available},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:80,columnNumber:13},this),e.jsxDEV("div",{className:"text-sm text-slate-600",children:"זמין"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:81,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:79,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:68,columnNumber:9},this),e.jsxDEV("div",{className:"mt-6",children:e.jsxDEV(_n,{value:n.usePercent,className:Ee("h-3",a(n.usePercent))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:87,columnNumber:11},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:86,columnNumber:9},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:27,columnNumber:7},this),n.usePercent>=85&&e.jsxDEV("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("svg",{className:"w-5 h-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:99,columnNumber:15},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:98,columnNumber:13},this),e.jsxDEV("div",{className:"text-red-800 font-medium",children:"אזהרה: השימוש בדיסק עולה על 85%. מומלץ לנקות קבצים מיותרים."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:101,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:97,columnNumber:11},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:96,columnNumber:9},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageUsageDisplay.tsx",lineNumber:25,columnNumber:5},this)}const co=[{id:"delete-old-backups",label:"מחק כל הגיבויים מלבד האחרון",description:"מוחק את כל הגיבויים הישנים ושומר רק את הגיבוי האחרון"},{id:"trim-logs",label:"קצץ את כל הלוגים",description:"דוחס לוגים ישנים (מעל 30 יום) ומוחק לוגים מעל 90 יום"},{id:"clear-temp-files",label:"נקה קבצים זמניים",description:"מוחק קבצים זמניים מ-/tmp, /var/tmp ותיקיית temp של הפרויקט"},{id:"clear-cache",label:"נקה מטמון",description:"מוחק מטמון Node.js, קבצי build, וקבצי .vite"},{id:"clear-sql-files",label:"נקה קבצי SQL ישנים",description:"מוחק קבצי SQL ישנים מתיקיית public/sql וקבצי SQL ישנים מהשורש"},{id:"clear-old-storage",label:"נקה אחסון ישן",description:"מוחק את תיקיית storage הישנה והעלאות ישנות מ-storage-new"},{id:"clear-system-journal",label:"נקה יומן מערכת",description:"מנקה את יומן systemd ושומר רק 30 יום אחרונים"},{id:"clear-editor-files",label:"נקה קבצי עורך",description:"מוחק קבצי .DS_Store, Thumbs.db, .swp, .swo, *~"},{id:"clear-old-backup-files",label:"נקה קבצי גיבוי ישנים",description:"מוחק קבצי .bak, .old, .backup מהפרויקט"},{id:"clear-nginx-cache",label:"נקה מטמון Nginx",description:"מנקה את מטמון Nginx"}];function po(){const[n,i]=t.useState([]),[r,a]=t.useState(null),[m,s]=t.useState(null),{data:o,isLoading:h,error:d,refetch:j}=$n({queryKey:["storage-usage"],queryFn:mt,refetchInterval:3e4,retry:2}),{data:b}=$n({queryKey:["backup-list"],queryFn:lt}),{data:v}=$n({queryKey:["log-analysis"],queryFn:dt}),N=vn({mutationFn:ot,onSuccess:S=>{a(S.jobId),Fn({title:"ניקוי החל",description:"תהליך הניקוי החל. אנא המתן..."})},onError:S=>{Fn({title:"שגיאה",description:S.message||"נכשל בהפעלת תהליך הניקוי",variant:"destructive"})}});t.useEffect(()=>{if(!r)return;const S=setInterval(async()=>{try{const g=await st(r);g.status==="completed"?(s(g.results),a(null),j(),Fn({title:"ניקוי הושלם",description:`שוחררו ${g.results.totalFreedFormatted||"0 B"}`})):g.status==="failed"&&(a(null),Fn({title:"ניקוי נכשל",description:g.error||"אירעה שגיאה בתהליך הניקוי",variant:"destructive"}))}catch(g){console.error("Error checking cleanup status:",g)}},2e3);return()=>clearInterval(S)},[r,j]);const x=S=>{i(g=>g.includes(S)?g.filter(u=>u!==S):[...g,S])},E=()=>{if(n.length===0){Fn({title:"אזהרה",description:"אנא בחר לפחות פעולה אחת",variant:"destructive"});return}window.confirm("האם אתה בטוח שברצונך לבצע את הפעולות שנבחרו?")&&(N.mutate(n),i([]))};return h?e.jsxDEV("div",{className:"flex items-center justify-center p-8",children:e.jsxDEV(nn,{className:"h-8 w-8 animate-spin text-slate-600"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:134,columnNumber:9},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:133,columnNumber:7},this):d||!o?e.jsxDEV("div",{className:"text-center p-8",children:e.jsxDEV("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[e.jsxDEV("div",{className:"text-red-800 font-semibold mb-2",children:"לא ניתן לטעון נתוני אחסון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:143,columnNumber:11},this),d&&e.jsxDEV("div",{className:"text-sm text-red-600 mt-2",children:d instanceof Error?d.message:"שגיאה לא ידועה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:145,columnNumber:13},this),e.jsxDEV(A,{onClick:()=>j(),variant:"outline",className:"mt-4",size:"sm",children:"נסה שוב"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:149,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:142,columnNumber:9},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:141,columnNumber:7},this):e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:e.jsxDEV("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:[e.jsxDEV("h2",{className:"text-2xl font-bold mb-6",children:"ניהול אחסון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:165,columnNumber:9},this),e.jsxDEV(uo,{usage:o,className:"mb-8"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:168,columnNumber:9},this),e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxDEV("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsxDEV("div",{className:"text-sm text-slate-600 mb-1",children:"גיבויים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:173,columnNumber:13},this),e.jsxDEV("div",{className:"text-2xl font-semibold",children:b?.totalCount||0},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:174,columnNumber:13},this),e.jsxDEV("div",{className:"text-sm text-slate-500",children:b?.totalSizeFormatted||"0 B"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:175,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:172,columnNumber:11},this),e.jsxDEV("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsxDEV("div",{className:"text-sm text-slate-600 mb-1",children:"לוגים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:178,columnNumber:13},this),e.jsxDEV("div",{className:"text-2xl font-semibold",children:v?.totalSizeFormatted||"0 B"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:179,columnNumber:13},this),e.jsxDEV("div",{className:"text-sm text-slate-500",children:[v?.pm2AppLogs.length||0," קבצי לוג"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:180,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:177,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:171,columnNumber:9},this),e.jsxDEV("div",{className:"border-t pt-6",children:[e.jsxDEV("h3",{className:"text-lg font-semibold mb-4",children:"פעולות ניקוי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:188,columnNumber:11},this),e.jsxDEV("div",{className:"space-y-3 mb-6",children:co.map(S=>e.jsxDEV("div",{className:"flex items-start gap-3 p-3 border rounded-lg hover:bg-slate-50",children:[e.jsxDEV(Ge,{id:S.id,checked:n.includes(S.id),onCheckedChange:()=>x(S.id),className:"mt-1"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:192,columnNumber:17},this),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV(U,{htmlFor:S.id,className:"text-sm font-medium cursor-pointer",children:S.label},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:199,columnNumber:19},this),e.jsxDEV("p",{className:"text-xs text-slate-500 mt-1",children:S.description},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:205,columnNumber:19},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:198,columnNumber:17},this)]},S.id,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:191,columnNumber:15},this))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:189,columnNumber:11},this),e.jsxDEV(A,{onClick:E,disabled:n.length===0||N.isPending||r!==null,className:"w-full",children:N.isPending||r?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(nn,{className:"h-4 w-4 animate-spin ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:218,columnNumber:17},this),"מבצע ניקוי..."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:217,columnNumber:15},this):"בצע ניקוי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:211,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:187,columnNumber:9},this),m&&e.jsxDEV("div",{className:"mt-6 border-t pt-6",children:[e.jsxDEV("h3",{className:"text-lg font-semibold mb-4",children:"תוצאות הניקוי"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:230,columnNumber:13},this),e.jsxDEV("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxDEV(ai,{className:"h-5 w-5 text-green-600"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:233,columnNumber:17},this),e.jsxDEV("span",{className:"font-medium text-green-800",children:"ניקוי הושלם בהצלחה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:234,columnNumber:17},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:232,columnNumber:15},this),e.jsxDEV("div",{className:"text-sm text-green-700",children:["שוחררו: ",m.totalFreedFormatted||"0 B"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:236,columnNumber:15},this),m.errors&&m.errors.length>0&&e.jsxDEV("div",{className:"mt-3",children:[e.jsxDEV("div",{className:"text-sm font-medium text-red-800 mb-1",children:"שגיאות:"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:241,columnNumber:19},this),e.jsxDEV("ul",{className:"list-disc list-inside text-xs text-red-700 space-y-1",children:m.errors.map((S,g)=>e.jsxDEV("li",{children:S},g,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:244,columnNumber:23},this))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:242,columnNumber:19},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:240,columnNumber:17},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:231,columnNumber:13},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:229,columnNumber:11},this)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:164,columnNumber:7},this)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/storage-management/StorageManagement.tsx",lineNumber:163,columnNumber:5},this)}const fo=({data:n,onDataChange:i})=>{const r=d=>{i({...n,showName:d})},a=d=>{i({...n,showDate:d||null})},m=d=>{i({...n,showTime:d||null})},s=(d,j,b)=>{const v=[...n.items];v[d]={...v[d],[j]:b},i({...n,items:v})},o=()=>{const d=[...n.items,{name:"",title:"",phone:""}];i({...n,items:d})},h=d=>{const j=n.items.filter((b,v)=>v!==d);i({...n,items:j})};return e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:[e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:e.jsxDEV(le,{children:"פרטי התוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:53,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:52,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"show-name",children:"שם התוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:57,columnNumber:13},void 0),e.jsxDEV($,{id:"show-name",value:n.showName,onChange:d=>r(d.target.value),placeholder:"שם התוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:58,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:56,columnNumber:11},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"show-date",children:"תאריך"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:67,columnNumber:15},void 0),e.jsxDEV($,{id:"show-date",type:"date",value:n.showDate||"",onChange:d=>a(d.target.value)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:68,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:66,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"show-time",children:"שעה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:76,columnNumber:15},void 0),e.jsxDEV($,{id:"show-time",type:"time",value:n.showTime||"",onChange:d=>m(d.target.value)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:77,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:75,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:65,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:55,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:51,columnNumber:7},void 0),e.jsxDEV(Q,{children:[e.jsxDEV(me,{className:"flex flex-row items-center justify-between",children:[e.jsxDEV(le,{children:["פריטי הליינאפ (",n.items.length,")"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:90,columnNumber:11},void 0),e.jsxDEV("button",{onClick:o,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ הוסף פריט"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:91,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:89,columnNumber:9},void 0),e.jsxDEV(ie,{children:n.items.length===0?e.jsxDEV("p",{className:"text-center text-gray-500 py-8",children:"לא נמצאו פריטים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:100,columnNumber:13},void 0):e.jsxDEV("div",{className:"overflow-x-auto",children:e.jsxDEV(Ze,{dir:"rtl",children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{className:"text-right",children:"שם"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:106,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"תפקיד/תואר"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:107,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"טלפון"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:108,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right w-20",children:"פעולות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:109,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:105,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:104,columnNumber:17},void 0),e.jsxDEV(en,{children:n.items.map((d,j)=>e.jsxDEV(he,{children:[e.jsxDEV(Z,{children:e.jsxDEV($,{value:d.name,onChange:b=>s(j,"name",b.target.value),placeholder:"שם המרואיין",className:"min-w-[200px]"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:116,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:115,columnNumber:23},void 0),e.jsxDEV(Z,{children:e.jsxDEV($,{value:d.title,onChange:b=>s(j,"title",b.target.value),placeholder:"תפקיד/תואר",className:"min-w-[200px]"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:124,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:123,columnNumber:23},void 0),e.jsxDEV(Z,{children:e.jsxDEV($,{value:d.phone,onChange:b=>s(j,"phone",b.target.value),placeholder:"טלפון",className:"min-w-[150px]"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:132,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:131,columnNumber:23},void 0),e.jsxDEV(Z,{children:e.jsxDEV("button",{onClick:()=>h(j),className:"text-red-600 hover:text-red-800 text-sm",children:"מחק"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:140,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:139,columnNumber:23},void 0)]},j,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:114,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:112,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:103,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:102,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:98,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:88,columnNumber:7},void 0),n.warnings&&n.warnings.length>0&&e.jsxDEV(Q,{className:"border-yellow-200 bg-yellow-50",children:[e.jsxDEV(me,{children:e.jsxDEV(le,{className:"text-yellow-800",children:"אזהרות"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:159,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:158,columnNumber:11},void 0),e.jsxDEV(ie,{children:e.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-sm text-yellow-700",children:n.warnings.map((d,j)=>e.jsxDEV("li",{children:d},j,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:164,columnNumber:17},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:162,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:161,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:157,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/ParsedLineupPreview.tsx",lineNumber:50,columnNumber:5},void 0)},No=()=>{const{toast:n}=De(),i=t.useRef(null),[r,a]=t.useState(!1),[m,s]=t.useState(!1),[o,h]=t.useState(null),[d,j]=t.useState(null),b=async g=>{const u=g.name.toLowerCase().split(".").pop();if(u!=="doc"&&u!=="docx"){n({title:"שגיאה",description:"רק קבצי Word (.doc, .docx) נתמכים",variant:"destructive"});return}if(g.size>10*1024*1024){n({title:"שגיאה",description:"גודל הקובץ חורג מהמותר (10MB)",variant:"destructive"});return}j(g),await v(g)},v=async g=>{a(!0),h(null);try{const u=new FormData;u.append("file",g);const R=await Bn.post("/lineup-import/parse",u);if(R.data.success)h(R.data.data),n({title:"הצלחה",description:"הקובץ נפרס בהצלחה"});else throw new Error(R.data.message||"שגיאה בניתוח הקובץ")}catch(u){console.error("Error parsing file:",u),n({title:"שגיאה",description:u.response?.data?.message||u.message||"שגיאה בניתוח הקובץ",variant:"destructive"}),h(null)}finally{a(!1)}},N=async()=>{if(o){if(!o.showName||!o.showDate){n({title:"שגיאה",description:"יש למלא שם התוכנית ותאריך",variant:"destructive"});return}if(o.items.length===0){n({title:"שגיאה",description:"יש להוסיף לפחות פריט אחד לליינאפ",variant:"destructive"});return}s(!0);try{const g=await Bn.post("/lineup-import/save",o);if(g.data.success)n({title:"הצלחה",description:`הליינאפ נשמר בהצלחה. ${g.data.itemsCreated} פריטים נוצרו.`}),h(null),j(null),i.current&&(i.current.value="");else throw new Error(g.data.message||"שגיאה בשמירת הליינאפ")}catch(g){console.error("Error saving lineup:",g),n({title:"שגיאה",description:g.response?.data?.message||g.message||"שגיאה בשמירת הליינאפ",variant:"destructive"})}finally{s(!1)}}},x=g=>{g.preventDefault(),g.stopPropagation()},E=g=>{g.preventDefault(),g.stopPropagation();const u=g.dataTransfer.files;u.length>0&&b(u[0])},S=g=>{const u=g.target.files?.[0];u&&b(u)};return e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:[e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"ייבוא קובץ בודד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:157,columnNumber:11},void 0),e.jsxDEV(xe,{children:"העלה קובץ Word (.doc או .docx) לניתוח וצפייה בתוצאות לפני שמירה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:158,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:156,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-4",children:[e.jsxDEV("div",{className:"border-2 border-dashed rounded-lg p-8 text-center space-y-4 cursor-pointer hover:border-blue-400 transition-colors",onDragOver:x,onDrop:E,onClick:()=>i.current?.click(),children:[e.jsxDEV(Vn,{className:"h-12 w-12 mx-auto text-gray-400"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:169,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-gray-600 mb-2",children:"גרור קובץ לכאן או לחץ לבחירת קובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:171,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"קבצי Word בלבד (.doc, .docx) עד 10MB"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:174,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:170,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",disabled:r,onClick:g=>{g.stopPropagation(),i.current?.click()},children:[e.jsxDEV(Tn,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:186,columnNumber:15},void 0),"בחר קובץ"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:178,columnNumber:13},void 0),e.jsxDEV("input",{ref:i,type:"file",className:"hidden",accept:".doc,.docx",onChange:S,disabled:r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:189,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:163,columnNumber:11},void 0),d&&e.jsxDEV("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(Vn,{className:"h-5 w-5 text-gray-600"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:202,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-sm font-medium",children:d.name},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:203,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-xs text-gray-500",children:["(",(d.size/1024).toFixed(2)," KB)"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:204,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:201,columnNumber:15},void 0),e.jsxDEV(A,{variant:"ghost",size:"sm",onClick:()=>v(d),disabled:r,children:[e.jsxDEV(Me,{className:`h-4 w-4 ml-2 ${r?"animate-spin":""}`},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:214,columnNumber:17},void 0),"פרס מחדש"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:208,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:200,columnNumber:13},void 0),r&&e.jsxDEV("div",{className:"flex items-center justify-center p-4",children:[e.jsxDEV(Me,{className:"h-6 w-6 animate-spin text-blue-600 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:222,columnNumber:15},void 0),e.jsxDEV("span",{className:"text-gray-600",children:"מנתח קובץ..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:223,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:221,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:162,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:155,columnNumber:7},void 0),o&&e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(fo,{data:o,onDataChange:h},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:231,columnNumber:11},void 0),e.jsxDEV(Q,{children:e.jsxDEV(ie,{className:"pt-6",children:e.jsxDEV("div",{className:"flex gap-4 justify-start",children:[e.jsxDEV(A,{onClick:N,disabled:m||!o.showName||!o.showDate,className:"min-w-[150px]",children:m?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Me,{className:"h-4 w-4 ml-2 animate-spin"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:243,columnNumber:23},void 0),"שומר..."]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:242,columnNumber:21},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Ln,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:248,columnNumber:23},void 0),"שמור למסד הנתונים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:247,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:236,columnNumber:17},void 0),e.jsxDEV(A,{variant:"outline",onClick:()=>{h(null),j(null),i.current&&(i.current.value="")},children:"נקה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:253,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:235,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:234,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:233,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:230,columnNumber:9},void 0),!o&&!r&&e.jsxDEV(Q,{className:"border-blue-200 bg-blue-50",children:e.jsxDEV(ie,{className:"pt-6",children:e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(cn,{className:"h-5 w-5 text-blue-600 mt-0.5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:275,columnNumber:15},void 0),e.jsxDEV("div",{className:"text-sm text-blue-800",children:[e.jsxDEV("p",{className:"font-medium mb-1",children:"איך זה עובד?"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:277,columnNumber:17},void 0),e.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[e.jsxDEV("li",{children:"העלה קובץ Word המכיל ליינאפ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:279,columnNumber:19},void 0),e.jsxDEV("li",{children:"המערכת תזהה אוטומטית את שם התוכנית, התאריך והטבלה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:280,columnNumber:19},void 0),e.jsxDEV("li",{children:"תוכל לערוך את הנתונים לפני השמירה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:281,columnNumber:19},void 0),e.jsxDEV("li",{children:"לאחר אישור, הליינאפ יישמר למסד הנתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:282,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:278,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:276,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:274,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:273,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:272,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/SingleFileParser.tsx",lineNumber:154,columnNumber:5},void 0)},go=()=>{const{toast:n}=De(),i=t.useRef(null),[r,a]=t.useState(!1),[m,s]=t.useState(!1),[o,h]=t.useState([]),[d,j]=t.useState([]),[b,v]=t.useState(0),N=async l=>{if(!l||l.length===0)return;if(l.length>1e3){n({title:"שגיאה",description:"מקסימום 1000 קבצים בכל פעם",variant:"destructive"});return}const c=[];for(let k=0;k<l.length;k++){const f=l[k],F=f.name.toLowerCase().split(".").pop();if(F!=="doc"&&F!=="docx"){n({title:"שגיאה",description:`הקובץ ${f.name} אינו קובץ Word תקין`,variant:"destructive"});continue}if(f.size>10*1024*1024){n({title:"שגיאה",description:`הקובץ ${f.name} חורג מהגודל המותר (10MB)`,variant:"destructive"});continue}c.push(f)}c.length!==0&&(j(Array.from(c)),await x(c))},x=async l=>{a(!0),h([]),v(0);try{const c=new FormData;l.forEach(f=>{c.append("files",f)});const k=await Bn.post("/lineup-import/parse-multiple",c,{onUploadProgress:f=>{if(f.total){const F=Math.round(f.loaded*100/f.total);v(F)}}});if(k.data.success)h(k.data.results),n({title:"הצלחה",description:`נפרסו ${k.data.successful} מתוך ${k.data.total} קבצים`});else throw new Error(k.data.message||"שגיאה בניתוח הקבצים")}catch(c){console.error("Error parsing files:",c),n({title:"שגיאה",description:c.response?.data?.message||c.message||"שגיאה בניתוח הקבצים",variant:"destructive"})}finally{a(!1),v(0)}},E=async()=>{const l=o.filter(c=>c.success&&c.data&&c.data.showName&&c.data.showDate&&c.data.items.length>0).map(c=>({filename:c.filename,showName:c.data.showName,showDate:c.data.showDate,showTime:c.data.showTime,items:c.data.items}));if(l.length===0){n({title:"שגיאה",description:"אין ליינאפים תקינים לשמירה",variant:"destructive"});return}s(!0);try{const c=await Bn.post("/lineup-import/save-multiple",{lineups:l});if(c.data.success)n({title:"הצלחה",description:`נשמרו ${c.data.successful} מתוך ${c.data.total} ליינאפים`}),h([]),j([]),i.current&&(i.current.value="");else throw new Error(c.data.message||"שגיאה בשמירת הליינאפים")}catch(c){console.error("Error saving lineups:",c),n({title:"שגיאה",description:c.response?.data?.message||c.message||"שגיאה בשמירת הליינאפים",variant:"destructive"})}finally{s(!1)}},S=l=>{l.preventDefault(),l.stopPropagation()},g=l=>{l.preventDefault(),l.stopPropagation();const c=l.dataTransfer.files;c.length>0&&N(c)},u=l=>{const c=l.target.files;c&&N(c)},R=o.filter(l=>l.success).length,V=o.filter(l=>!l.success).length,T=o.filter(l=>l.success&&l.data&&l.data.showName&&l.data.showDate&&l.data.items.length>0).length;return e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:[e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"ייבוא מרובה קבצים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:207,columnNumber:11},void 0),e.jsxDEV(xe,{children:"העלה עד 1000 קבצי Word (.doc או .docx) לייבוא אוטומטי למסד הנתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:208,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:206,columnNumber:9},void 0),e.jsxDEV(ie,{className:"space-y-4",children:[e.jsxDEV("div",{className:"border-2 border-dashed rounded-lg p-8 text-center space-y-4 cursor-pointer hover:border-blue-400 transition-colors",onDragOver:S,onDrop:g,onClick:()=>i.current?.click(),children:[e.jsxDEV(Vn,{className:"h-12 w-12 mx-auto text-gray-400"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:219,columnNumber:13},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-gray-600 mb-2",children:"גרור קבצים לכאן או לחץ לבחירת קבצים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:221,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-sm text-gray-500",children:"עד 1000 קבצי Word (.doc, .docx), עד 10MB כל קובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:224,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:220,columnNumber:13},void 0),e.jsxDEV(A,{variant:"outline",disabled:r,onClick:l=>{l.stopPropagation(),i.current?.click()},children:[e.jsxDEV(Tn,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:236,columnNumber:15},void 0),"בחר קבצים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:228,columnNumber:13},void 0),e.jsxDEV("input",{ref:i,type:"file",className:"hidden",accept:".doc,.docx",multiple:!0,onChange:u,disabled:r},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:239,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:213,columnNumber:11},void 0),d.length>0&&e.jsxDEV("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxDEV("p",{className:"text-sm font-medium mb-2",children:["נבחרו ",d.length," קבצים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:252,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex flex-wrap gap-2",children:[d.slice(0,5).map((l,c)=>e.jsxDEV("span",{className:"text-xs bg-white px-2 py-1 rounded border",children:l.name},c,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:257,columnNumber:19},void 0)),d.length>5&&e.jsxDEV("span",{className:"text-xs text-gray-500",children:["+",d.length-5," נוספים"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:265,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:255,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:251,columnNumber:13},void 0),r&&e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV("div",{className:"flex items-center justify-between text-sm",children:[e.jsxDEV("span",{className:"text-gray-600",children:"מנתח קבצים..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:276,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-gray-600",children:[b,"%"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:277,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:275,columnNumber:15},void 0),e.jsxDEV(_n,{value:b},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:279,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:274,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:212,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:205,columnNumber:7},void 0),o.length>0&&e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV(le,{children:"תוצאות ניתוח"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:290,columnNumber:17},void 0),e.jsxDEV(xe,{className:"mt-2",children:[R," הצליחו, ",V," נכשלו",T>0&&`, ${T} מוכנים לשמירה`]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:291,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:289,columnNumber:15},void 0),T>0&&e.jsxDEV(A,{onClick:E,disabled:m,children:m?e.jsxDEV(e.Fragment,{children:e.jsxDEV("span",{className:"ml-2",children:"שומר..."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:300,columnNumber:23},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:299,columnNumber:21},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Ln,{className:"h-4 w-4 ml-2"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:304,columnNumber:23},void 0),"שמור הכל (",T,")"]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:303,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:297,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:288,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:287,columnNumber:11},void 0),e.jsxDEV(ie,{children:e.jsxDEV("div",{className:"overflow-x-auto",children:e.jsxDEV(Ze,{dir:"rtl",children:[e.jsxDEV(Qe,{children:e.jsxDEV(he,{children:[e.jsxDEV(ee,{className:"text-right",children:"שם קובץ"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:317,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"סטטוס"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:318,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"שם תוכנית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:319,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"תאריך"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:320,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"מספר פריטים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:321,columnNumber:21},void 0),e.jsxDEV(ee,{className:"text-right",children:"שגיאה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:322,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:316,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:315,columnNumber:17},void 0),e.jsxDEV(en,{children:o.map((l,c)=>e.jsxDEV(he,{children:[e.jsxDEV(Z,{className:"font-medium",children:l.filename},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:328,columnNumber:23},void 0),e.jsxDEV(Z,{children:l.success?e.jsxDEV("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsxDEV(Lt,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:334,columnNumber:29},void 0),e.jsxDEV("span",{children:"הצליח"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:335,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:333,columnNumber:27},void 0):e.jsxDEV("div",{className:"flex items-center gap-2 text-red-600",children:[e.jsxDEV(Pt,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:339,columnNumber:29},void 0),e.jsxDEV("span",{children:"נכשל"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:340,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:338,columnNumber:27},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:331,columnNumber:23},void 0),e.jsxDEV(Z,{children:l.data?.showName||"-"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:344,columnNumber:23},void 0),e.jsxDEV(Z,{children:l.data?.showDate||"-"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:347,columnNumber:23},void 0),e.jsxDEV(Z,{children:l.data?.items.length||0},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:350,columnNumber:23},void 0),e.jsxDEV(Z,{className:"text-red-600 text-sm",children:l.error||"-"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:353,columnNumber:23},void 0)]},c,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:327,columnNumber:21},void 0))},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:325,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:314,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:313,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:312,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:286,columnNumber:9},void 0),o.length===0&&!r&&e.jsxDEV(Q,{className:"border-blue-200 bg-blue-50",children:e.jsxDEV(ie,{className:"pt-6",children:e.jsxDEV("div",{className:"flex items-start gap-3",children:[e.jsxDEV(cn,{className:"h-5 w-5 text-blue-600 mt-0.5"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:369,columnNumber:15},void 0),e.jsxDEV("div",{className:"text-sm text-blue-800",children:[e.jsxDEV("p",{className:"font-medium mb-1",children:"ייבוא מרובה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:371,columnNumber:17},void 0),e.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[e.jsxDEV("li",{children:"העלה עד 1000 קבצי Word בבת אחת"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:373,columnNumber:19},void 0),e.jsxDEV("li",{children:"המערכת תנתח את כל הקבצים אוטומטית"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:374,columnNumber:19},void 0),e.jsxDEV("li",{children:"תוכל לראות את התוצאות לפני השמירה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:375,columnNumber:19},void 0),e.jsxDEV("li",{children:"לאחר אישור, כל הליינאפים יישמרו למסד הנתונים"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:376,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:372,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:370,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:368,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:367,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:366,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/MultiFileParser.tsx",lineNumber:204,columnNumber:5},void 0)},ho=()=>{const[n,i]=t.useState("single");return e.jsxDEV("div",{className:"space-y-6",dir:"rtl",children:e.jsxDEV(Q,{children:[e.jsxDEV(me,{children:[e.jsxDEV(le,{children:"ייבוא ליינאפים מקבצי Word"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:14,columnNumber:11},void 0),e.jsxDEV(xe,{children:"ייבא ליינאפים מקבצי Word ישנים (.doc או .docx). ניתן לייבא קובץ בודד לבדיקה או מספר קבצים לייבוא אוטומטי."},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:15,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:13,columnNumber:9},void 0),e.jsxDEV(ie,{children:e.jsxDEV(Qn,{value:n,onValueChange:r=>i(r),children:[e.jsxDEV(er,{className:"grid w-full grid-cols-2",children:[e.jsxDEV(on,{value:"single",children:"קובץ בודד"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:22,columnNumber:15},void 0),e.jsxDEV(on,{value:"multi",children:"ייבוא מרובה"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:23,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:21,columnNumber:13},void 0),e.jsxDEV(sn,{value:"single",className:"mt-6",children:e.jsxDEV(No,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:26,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:25,columnNumber:13},void 0),e.jsxDEV(sn,{value:"multi",className:"mt-6",children:e.jsxDEV(go,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:29,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:28,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:20,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:19,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:12,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/components/admin/lineup-import/LineupImport.tsx",lineNumber:11,columnNumber:5},void 0)},wo=()=>{const{isAdmin:n,isAuthenticated:i}=ut(),[r]=Tr(),[a,m]=t.useState(0),[s,o]=t.useState(null),[h,d]=t.useState(!1),[j,b]=t.useState("schedule"),[v,N]=t.useState(!1),[x,E]=t.useState(""),S=ti(),g=r.get("section")||"general",u=r.get("sub")||(g==="arrangements"?"producers":g==="workers"?"management":void 0);if(t.useEffect(()=>{r.get("code")&&!h&&(console.log("Found OAuth code in URL, setting default tab to email"),b("email"),d(!0));const l=r.get("tab");if(l==="database"?b("database"):l==="exports"?(b("exports"),console.log("Setting default tab to exports based on URL parameter")):l==="staff"&&(b("workers"),N(!0)),r.get("tab")==="staff"){const k=new URLSearchParams(r);k.set("section","workers"),k.delete("tab"),S({pathname:"/admin",search:k.toString()},{replace:!0})}},[r,h,S]),t.useEffect(()=>{(async()=>{try{const{data:c,error:k}=await ae.from("system-settings").select("*").eq("key","timezone_offset").single();!k&&c?m(parseInt(c.value)||0):console.warn("Could not fetch timezone offset, defaulting to 0:",k);const{data:f,error:F}=await ae.from("system-settings").select("*").eq("key","app_domain").single();!F&&f?E(f.value):console.warn("Could not fetch app domain, none set:",F),o(new Date)}catch(c){console.error("Error fetching system settings:",c)}})();const l=setInterval(()=>{o(new Date)},6e4);return()=>clearInterval(l)},[]),!i)return e.jsxDEV(Ur,{to:"/login",replace:!0},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:113,columnNumber:12},void 0);if(!n)return e.jsxDEV(Ur,{to:"/",replace:!0},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:117,columnNumber:12},void 0);const R=(T,l)=>{const c=new URLSearchParams(r);c.set("section",T),l?c.set("sub",l):c.delete("sub"),S({pathname:"/admin",search:c.toString()},{replace:!1})},V=()=>{switch(g){case"general":return e.jsxDEV("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxDEV(ia,{timezoneOffset:a,setTimezoneOffset:m,serverTime:s},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:132,columnNumber:13},void 0),e.jsxDEV(ta,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:137,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:131,columnNumber:11},void 0);case"schedule":return e.jsxDEV(ca,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:141,columnNumber:16},void 0);case"studio-schedule":return e.jsxDEV(lo,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:143,columnNumber:16},void 0);case"arrangements":return u==="engineers"?e.jsxDEV(gr,{mode:"engineers"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:146,columnNumber:18},void 0):u==="digital"?e.jsxDEV(gr,{mode:"digital"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:149,columnNumber:18},void 0):e.jsxDEV(gr,{mode:"producers"},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:151,columnNumber:16},void 0);case"workers":return u==="users"?e.jsxDEV(ao,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:154,columnNumber:18},void 0):e.jsxDEV(ua,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:156,columnNumber:16},void 0);case"email":return e.jsxDEV(ya,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:159,columnNumber:16},void 0);case"data":return u==="schedule-export"?e.jsxDEV(za,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:164,columnNumber:18},void 0):e.jsxDEV(La,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:166,columnNumber:16},void 0);case"database":return e.jsxDEV($a,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:168,columnNumber:16},void 0);case"storage":return e.jsxDEV(po,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:170,columnNumber:16},void 0);case"rds":return u==="translations"?e.jsxDEV(mo,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:173,columnNumber:18},void 0):u==="rds-settings"?e.jsxDEV(ei,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:176,columnNumber:18},void 0):e.jsxDEV(ei,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:179,columnNumber:16},void 0);case"lineup-import":return e.jsxDEV(ho,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:181,columnNumber:16},void 0);default:return null}};return e.jsxDEV("div",{className:"container mx-auto py-8",dir:"rtl",children:[e.jsxDEV(ra,{},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:189,columnNumber:7},void 0),e.jsxDEV("div",{className:"mt-6",children:e.jsxDEV(so,{section:g,sub:u,onNavigate:R,children:V()},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:191,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:190,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/iteam/radio-lineup-generator-rtl-78/src/pages/Admin.tsx",lineNumber:188,columnNumber:5},void 0)};export{wo as default};
